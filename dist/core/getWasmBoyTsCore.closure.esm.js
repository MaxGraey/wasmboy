const b=new Uint8ClampedArray(9109504),aa={size:()=>9109504,grow:()=>{},wasmByteMemory:b};var f=function(){function a(){}a.enableBootRom=!1;a.useGbcWhenAvailable=!0;a.audioBatchProcessing=!1;a.graphicsBatchProcessing=!1;a.timersBatchProcessing=!1;a.graphicsDisableScanlineRendering=!1;a.audioAccumulateSamples=!1;a.tileRendering=!1;a.tileCaching=!1;return a}();function h(a,c){return(a&255)<<8|c&255}function k(a){return(a&65280)>>8}function l(a,c){return c&~(1<<a)}
function m(a,c){return 0!=(c&1<<a)}function ba(a){var c=a;m(7,c)&&(c=-1*(256-a));return c}function ca(a,c){a=1<<a&255;n.registerF=0<c?n.registerF|a:n.registerF&(255^a);return n.registerF}function q(a){ca(7,a)}function r(a){ca(6,a)}function t(a){ca(5,a)}function u(a){ca(4,a)}function da(){return n.registerF>>7&1}function ea(){return n.registerF>>4&1}function z(a,c){0<=c?0!==((a&15)+(c&15)&16)?t(1):t(0):(Math.abs(c)&15)>(a&15)?t(1):t(0)}
function fa(a,c){0<=c?a>(a+c&255)?u(1):u(0):Math.abs(c)>a?u(1):u(0)}function ha(a,c,d){d?(a=a^c^a+c,0!==(a&16)?t(1):t(0),0!==(a&256)?u(1):u(0)):(d=a+c&65535,d<a?u(1):u(0),0!==((a^c^d)&4096)?t(1):t(0))}var ia=function(){function a(){}a.memoryLocationBackgroundPaletteIndex=65384;a.memoryLocationBackgroundPaletteData=65385;a.memoryLocationSpritePaletteIndex=65386;a.memoryLocationSpritePaletteData=65387;return a}();
function ja(a,c,d){void 0===d&&(d=!1);var e=a;d||(e=A(c)>>2*a&3);a=242;switch(e){case 1:a=160;break;case 2:a=88;break;case 3:a=8}return a}function ka(a,c,d){c=8*a+2*c;a=la(c+1,d);d=la(c,d);return h(a,d)}function ma(a,c){return 8*((c&31<<5*a)>>5*a)}function la(a,c){a&=63;c&&(a+=64);return b[67584+a]}function na(a,c,d,e){void 0===d&&(d=0);void 0===e&&(e=!1);d&=3;e&&(d|=4);b[69632+(160*c+a)]=d}var oa=function(){function a(){}a.tileId=-1;a.horizontalFlip=!1;a.nextXIndexToPerformCacheCheck=-1;return a}();
function pa(a,c,d,e,g,p,D,v,I,w,J,x,y){void 0===J&&(J=!1);void 0===x&&(x=0);void 0===y&&(y=-1);var T=0;c=qa(c,a);a=ra(c+2*p,d);d=ra(c+2*p+1,d);for(p=e;p<=g;p++)if(c=D+(p-e),c<I){var N=p;if(0>y||!m(5,y))N=7-N;var U=0;m(N,d)&&(U+=1,U<<=1);m(N,a)&&(U+=1);if(0<=y){var K=ka(y&7,U,!1);N=ma(0,K);var xa=ma(1,K);K=ma(2,K)}else 0>=x&&(x=B.memoryLocationBackgroundPalette),xa=N=K=ja(U,x,J);var ya=3*(v*I+c);b[w+ya]=N;b[w+ya+1]=xa;b[w+ya+2]=K;N=!1;0<=y&&(N=m(7,y));na(c,v,U,N);T++}return T}
function qa(a,c){if(a===B.memoryLocationTileDataSelectZeroStart){var d=c+128;m(7,c)&&(d=c-128);return a+16*d}return a+16*c}function sa(a,c){switch(a){case 1:return m(c,129);case 2:return m(c,135);case 3:return m(c,126);default:return m(c,1)}}
var G=function(){function a(){}a.updateNRx0=function(c){a.NRx0SweepPeriod=(c&112)>>4;a.NRx0Negate=m(3,c);a.NRx0SweepShift=c&7};a.updateNRx1=function(c){a.NRx1Duty=c>>6&3;a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=m(3,c);a.NRx2EnvelopePeriod=c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=function(c){a.NRx4LengthEnabled=
m(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=function(){C(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.dutyCycle;b[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty;C(1049+50*a.saveStateSlot,a.isSweepEnabled);b[1050+50*a.saveStateSlot]=a.sweepCounter;b[1055+50*
a.saveStateSlot]=a.sweepShadowFrequency};a.loadState=function(){a.isEnabled=E(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];a.volume=b[1038+50*a.saveStateSlot];a.dutyCycle=b[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=b[1044+50*a.saveStateSlot];a.isSweepEnabled=E(1049+50*a.saveStateSlot);a.sweepCounter=b[1050+50*a.saveStateSlot];a.sweepShadowFrequency=b[1055+50*a.saveStateSlot]};a.initialize=
function(){F(a.memoryLocationNRx0,128);F(a.memoryLocationNRx1,191);F(a.memoryLocationNRx2,243);F(a.memoryLocationNRx3,193);F(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=4*(2048-a.frequency);n.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=c,a.waveFormPositionOnDuty+=
1,8<=a.waveFormPositionOnDuty&&(a.waveFormPositionOnDuty=0));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=1;sa(a.NRx1Duty,a.waveFormPositionOnDuty)||(d*=-1);return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.sweepShadowFrequency=a.frequency;a.sweepCounter=a.NRx0SweepPeriod;a.isSweepEnabled=0<a.NRx0SweepPeriod&&0<a.NRx0SweepShift?!0:!1;0<a.NRx0SweepShift&&
ta();a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.updateSweep=function(){--a.sweepCounter;0>=a.sweepCounter&&(a.sweepCounter=a.NRx0SweepPeriod,a.isSweepEnabled&&0<a.NRx0SweepPeriod&&ta())};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,
0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&0<a.volume&&--a.volume))};a.setFrequency=function(c){var d=c>>8;c&=255;var e=A(a.memoryLocationNRx4)&248|d;F(a.memoryLocationNRx3,c);F(a.memoryLocationNRx4,e);a.NRx3FrequencyLSB=c;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.memoryLocationNRx0=65296;a.NRx0SweepPeriod=0;a.NRx0Negate=!1;a.NRx0SweepShift=0;a.memoryLocationNRx1=65297;a.NRx1Duty=0;a.NRx1LengthLoad=
0;a.memoryLocationNRx2=65298;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65299;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65300;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=1;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.isSweepEnabled=!1;a.sweepCounter=0;a.sweepShadowFrequency=0;a.saveStateSlot=7;return a}();
function ta(){var a=ua();2047>=a&&0<G.NRx0SweepShift&&(G.sweepShadowFrequency=a,G.setFrequency(a),a=ua());2047<a&&(G.isEnabled=!1)}function ua(){var a=G.sweepShadowFrequency;a>>=G.NRx0SweepShift;return a=G.NRx0Negate?G.sweepShadowFrequency-a:G.sweepShadowFrequency+a}
var H=function(){function a(){}a.updateNRx1=function(c){a.NRx1Duty=c>>6&3;a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=m(3,c);a.NRx2EnvelopePeriod=c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=function(c){a.NRx4LengthEnabled=m(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=
function(){C(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.dutyCycle;b[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty};a.loadState=function(){a.isEnabled=E(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];
a.volume=b[1038+50*a.saveStateSlot];a.dutyCycle=b[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=b[1044+50*a.saveStateSlot]};a.initialize=function(){F(a.memoryLocationNRx1-1,255);F(a.memoryLocationNRx1,63);F(a.memoryLocationNRx2,0);F(a.memoryLocationNRx3,0);F(a.memoryLocationNRx4,184)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=4*(2048-a.frequency);n.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=
function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=c,a.waveFormPositionOnDuty+=1,8<=a.waveFormPositionOnDuty&&(a.waveFormPositionOnDuty=0));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=1;sa(a.NRx1Duty,a.waveFormPositionOnDuty)||(d*=-1);return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.isDacEnabled||
(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&0<a.volume&&--a.volume))};a.setFrequency=function(c){var d=
c>>8;c&=255;var e=A(a.memoryLocationNRx4)&248|d;F(a.memoryLocationNRx3,c);F(a.memoryLocationNRx4,e);a.NRx3FrequencyLSB=c;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.memoryLocationNRx1=65302;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65303;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65304;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65305;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=
2;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.saveStateSlot=8;return a}(),L=function(){function a(){}a.updateNRx0=function(c){a.isDacEnabled=m(7,c)};a.updateNRx1=function(c){a.NRx1LengthLoad=c;a.lengthCounter=256-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2VolumeCode=c>>5&15};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=
function(c){a.NRx4LengthEnabled=m(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=function(){C(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.lengthCounter;b[1033+50*a.saveStateSlot]=a.waveTablePosition};a.loadState=function(){a.isEnabled=E(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.lengthCounter=b[1029+50*a.saveStateSlot];a.waveTablePosition=b[1033+50*a.saveStateSlot]};
a.initialize=function(){F(a.memoryLocationNRx0,127);F(a.memoryLocationNRx1,255);F(a.memoryLocationNRx2,159);F(a.memoryLocationNRx3,0);F(a.memoryLocationNRx4,184);a.volumeCodeChanged=!0};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=2*(2048-a.frequency);n.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=
c,a.waveTablePosition+=1,32<=a.waveTablePosition&&(a.waveTablePosition=0));c=0;var d=a.volumeCode;if(a.isEnabled&&a.isDacEnabled)a.volumeCodeChanged&&(d=A(a.memoryLocationNRx2),d=d>>5&15,a.volumeCode=d,a.volumeCodeChanged=!1);else return 15;var e=A(a.memoryLocationWaveTable+a.waveTablePosition/2);e=0===a.waveTablePosition%2?e>>4&15:e&15;switch(d){case 0:e>>=4;break;case 1:c=1;break;case 2:e>>=1;c=2;break;default:e>>=2,c=4}return(0<c?e/c:0)+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&
(a.lengthCounter=256);a.resetTimer();a.waveTablePosition=0;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter&&!a.volumeCodeChanged?!1:!0};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.cycleCounter=0;a.memoryLocationNRx0=65306;a.memoryLocationNRx1=65307;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65308;a.NRx2VolumeCode=0;a.memoryLocationNRx3=65309;a.NRx3FrequencyLSB=
0;a.memoryLocationNRx4=65310;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.memoryLocationWaveTable=65328;a.channelNumber=3;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.lengthCounter=0;a.waveTablePosition=0;a.volumeCode=0;a.volumeCodeChanged=!1;a.saveStateSlot=9;return a}(),M=function(){function a(){}a.updateNRx1=function(c){a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=m(3,c);a.NRx2EnvelopePeriod=
c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3ClockShift=c>>4;a.NRx3WidthMode=m(3,c);a.NRx3DivisorCode=c&7;switch(a.NRx3DivisorCode){case 0:a.divisor=8;break;case 1:a.divisor=16;break;case 2:a.divisor=32;break;case 3:a.divisor=48;break;case 4:a.divisor=64;break;case 5:a.divisor=80;break;case 6:a.divisor=96;break;case 7:a.divisor=112}};a.updateNRx4=function(c){a.NRx4LengthEnabled=m(6,c)};a.saveState=function(){C(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;
b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.linearFeedbackShiftRegister};a.loadState=function(){a.isEnabled=E(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];a.volume=b[1038+50*a.saveStateSlot];a.linearFeedbackShiftRegister=b[1043+50*a.saveStateSlot]};a.initialize=function(){F(a.memoryLocationNRx1-
1,255);F(a.memoryLocationNRx1,255);F(a.memoryLocationNRx2,0);F(a.memoryLocationNRx3,0);F(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.frequencyTimer=a.getNoiseChannelFrequencyPeriod(),a.frequencyTimer-=c,c=a.linearFeedbackShiftRegister&1^a.linearFeedbackShiftRegister>>1&1,a.linearFeedbackShiftRegister>>=1,a.linearFeedbackShiftRegister|=
c<<14,a.NRx3WidthMode&&(a.linearFeedbackShiftRegister&=-65,a.linearFeedbackShiftRegister|=c<<6));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=m(0,a.linearFeedbackShiftRegister)?-1:1;return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.frequencyTimer=a.getNoiseChannelFrequencyPeriod();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.linearFeedbackShiftRegister=32767;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=
function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.getNoiseChannelFrequencyPeriod=function(){var c=a.divisor<<a.NRx3ClockShift;n.GBCDoubleSpeed&&(c*=2);return c};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&
0<a.volume&&--a.volume))};a.cycleCounter=0;a.memoryLocationNRx1=65312;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65313;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65314;a.NRx3ClockShift=0;a.NRx3WidthMode=!1;a.NRx3DivisorCode=0;a.memoryLocationNRx4=65315;a.NRx4LengthEnabled=!1;a.channelNumber=4;a.isEnabled=!1;a.isDacEnabled=!1;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.divisor=0;a.linearFeedbackShiftRegister=0;a.saveStateSlot=
10;return a}(),O=function(){function a(){}a.channel1Sample=15;a.channel2Sample=15;a.channel3Sample=15;a.channel4Sample=15;a.channel1DacEnabled=!1;a.channel2DacEnabled=!1;a.channel3DacEnabled=!1;a.channel4DacEnabled=!1;a.leftChannelSampleUnsignedByte=127;a.rightChannelSampleUnsignedByte=127;a.mixerVolumeChanged=!1;a.mixerEnabledChanged=!1;a.needToRemixSamples=!1;return a}();
function va(a){switch(a){case G.channelNumber:if(O.channel1DacEnabled!==G.isDacEnabled)return O.channel1DacEnabled=G.isDacEnabled,!0;break;case H.channelNumber:if(O.channel2DacEnabled!==H.isDacEnabled)return O.channel2DacEnabled=H.isDacEnabled,!0;break;case L.channelNumber:if(O.channel3DacEnabled!==L.isDacEnabled)return O.channel3DacEnabled=L.isDacEnabled,!0;break;case M.channelNumber:if(O.channel4DacEnabled!==M.isDacEnabled)return O.channel4DacEnabled=M.isDacEnabled,!0}return!1}
var P=function(){function a(){}a.batchProcessCycles=function(){return n.GBCDoubleSpeed?174:87};a.updateNR50=function(c){a.NR50LeftMixerVolume=c>>4&7;a.NR50RightMixerVolume=c&7};a.updateNR51=function(c){a.NR51IsChannel4EnabledOnLeftOutput=m(7,c);a.NR51IsChannel3EnabledOnLeftOutput=m(6,c);a.NR51IsChannel2EnabledOnLeftOutput=m(5,c);a.NR51IsChannel1EnabledOnLeftOutput=m(4,c);a.NR51IsChannel4EnabledOnRightOutput=m(3,c);a.NR51IsChannel3EnabledOnRightOutput=m(2,c);a.NR51IsChannel2EnabledOnRightOutput=m(1,
c);a.NR51IsChannel1EnabledOnRightOutput=m(0,c)};a.updateNR52=function(c){a.NR52IsSoundEnabled=m(7,c)};a.maxFrameSequenceCycles=function(){return n.GBCDoubleSpeed?16384:8192};a.maxDownSampleCycles=function(){return n.CLOCK_SPEED()};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.frameSequenceCycleCounter;b[1028+50*a.saveStateSlot]=a.downSampleCycleCounter;b[1029+50*a.saveStateSlot]=a.frameSequencer};a.loadState=function(){a.frameSequenceCycleCounter=b[1024+50*a.saveStateSlot];a.downSampleCycleCounter=
b[1028+50*a.saveStateSlot];a.frameSequencer=b[1029+50*a.saveStateSlot];wa()};a.currentCycles=0;a.memoryLocationNR50=65316;a.NR50LeftMixerVolume=0;a.NR50RightMixerVolume=0;a.memoryLocationNR51=65317;a.NR51IsChannel1EnabledOnLeftOutput=!0;a.NR51IsChannel2EnabledOnLeftOutput=!0;a.NR51IsChannel3EnabledOnLeftOutput=!0;a.NR51IsChannel4EnabledOnLeftOutput=!0;a.NR51IsChannel1EnabledOnRightOutput=!0;a.NR51IsChannel2EnabledOnRightOutput=!0;a.NR51IsChannel3EnabledOnRightOutput=!0;a.NR51IsChannel4EnabledOnRightOutput=
!0;a.memoryLocationNR52=65318;a.NR52IsSoundEnabled=!0;a.memoryLocationChannel3LoadRegisterStart=65328;a.frameSequenceCycleCounter=0;a.downSampleCycleCounter=0;a.downSampleCycleMultiplier=48E3;a.frameSequencer=0;a.audioQueueIndex=0;a.wasmBoyMemoryMaxBufferSize=131072;a.saveStateSlot=6;return a}();function za(){if(!(P.currentCycles<P.batchProcessCycles()))for(;P.currentCycles>=P.batchProcessCycles();)Aa(P.batchProcessCycles()),P.currentCycles-=P.batchProcessCycles()}
function Aa(a){P.frameSequenceCycleCounter+=a;if(P.frameSequenceCycleCounter>=P.maxFrameSequenceCycles()){P.frameSequenceCycleCounter-=P.maxFrameSequenceCycles();switch(P.frameSequencer){case 0:G.updateLength();H.updateLength();L.updateLength();M.updateLength();break;case 2:G.updateLength();H.updateLength();L.updateLength();M.updateLength();G.updateSweep();break;case 4:G.updateLength();H.updateLength();L.updateLength();M.updateLength();break;case 6:G.updateLength();H.updateLength();L.updateLength();
M.updateLength();G.updateSweep();break;case 7:G.updateEnvelope(),H.updateEnvelope(),M.updateEnvelope()}P.frameSequencer+=1;8<=P.frameSequencer&&(P.frameSequencer=0);var c=!0}else c=!1;if(f.audioAccumulateSamples&&!c){c=G.willChannelUpdate(a)||va(G.channelNumber);var d=H.willChannelUpdate(a)||va(H.channelNumber),e=L.willChannelUpdate(a)||va(L.channelNumber),g=M.willChannelUpdate(a)||va(M.channelNumber);c&&(O.channel1Sample=G.getSampleFromCycleCounter());d&&(O.channel2Sample=H.getSampleFromCycleCounter());
e&&(O.channel3Sample=L.getSampleFromCycleCounter());g&&(O.channel4Sample=M.getSampleFromCycleCounter());if(c||d||e||g)O.needToRemixSamples=!0;P.downSampleCycleCounter+=a*P.downSampleCycleMultiplier;P.downSampleCycleCounter>=P.maxDownSampleCycles()&&(P.downSampleCycleCounter-=P.maxDownSampleCycles(),(O.needToRemixSamples||O.mixerVolumeChanged||O.mixerEnabledChanged)&&Ba(O.channel1Sample,O.channel2Sample,O.channel3Sample,O.channel4Sample),a=O.rightChannelSampleUnsignedByte+1,c=588800+2*P.audioQueueIndex,
b[c]=O.leftChannelSampleUnsignedByte+1+1,b[c+1]=a+1,P.audioQueueIndex+=1,P.audioQueueIndex>=P.wasmBoyMemoryMaxBufferSize/2-1&&--P.audioQueueIndex)}else c=G.getSample(a),d=H.getSample(a),e=L.getSample(a),g=M.getSample(a),O.channel1Sample=c,O.channel2Sample=d,O.channel3Sample=e,O.channel4Sample=g,P.downSampleCycleCounter+=a*P.downSampleCycleMultiplier,P.downSampleCycleCounter>=P.maxDownSampleCycles()&&(P.downSampleCycleCounter-=P.maxDownSampleCycles(),a=Ba(c,d,e,g),c=k(a),d=588800+2*P.audioQueueIndex,
b[d]=c+1+1,b[d+1]=(a&255)+2,P.audioQueueIndex+=1,P.audioQueueIndex>=P.wasmBoyMemoryMaxBufferSize/2-1&&--P.audioQueueIndex)}function Ca(){return P.audioQueueIndex}function wa(){P.audioQueueIndex=0}
function Ba(a,c,d,e){void 0===a&&(a=15);void 0===c&&(c=15);void 0===d&&(d=15);void 0===e&&(e=15);O.mixerVolumeChanged=!1;var g=0,p=0;g=P.NR51IsChannel1EnabledOnLeftOutput?g+a:g+15;g=P.NR51IsChannel2EnabledOnLeftOutput?g+c:g+15;g=P.NR51IsChannel3EnabledOnLeftOutput?g+d:g+15;g=P.NR51IsChannel4EnabledOnLeftOutput?g+e:g+15;p=P.NR51IsChannel1EnabledOnRightOutput?p+a:p+15;p=P.NR51IsChannel2EnabledOnRightOutput?p+c:p+15;p=P.NR51IsChannel3EnabledOnRightOutput?p+d:p+15;p=P.NR51IsChannel4EnabledOnRightOutput?
p+e:p+15;O.mixerEnabledChanged=!1;O.needToRemixSamples=!1;a=Da(g,P.NR50LeftMixerVolume+1);p=Da(p,P.NR50RightMixerVolume+1);O.leftChannelSampleUnsignedByte=a;O.rightChannelSampleUnsignedByte=p;return h(a,p)}function Da(a,c){if(60===a)return 127;a=1E5*(a-60)*c/8;a/=1E5;a+=60;a=1E5*a/(12E6/254);return a|=0}
var Q=function(){function a(){}a.updateInterruptEnabled=function(c){a.isVBlankInterruptEnabled=m(a.bitPositionVBlankInterrupt,c);a.isLcdInterruptEnabled=m(a.bitPositionLcdInterrupt,c);a.isTimerInterruptEnabled=m(a.bitPositionTimerInterrupt,c);a.isJoypadInterruptEnabled=m(a.bitPositionJoypadInterrupt,c);a.interruptsEnabledValue=c};a.updateInterruptRequested=function(c){a.isVBlankInterruptRequested=m(a.bitPositionVBlankInterrupt,c);a.isLcdInterruptRequested=m(a.bitPositionLcdInterrupt,c);a.isTimerInterruptRequested=
m(a.bitPositionTimerInterrupt,c);a.isJoypadInterruptRequested=m(a.bitPositionJoypadInterrupt,c);a.interruptsRequestedValue=c};a.areInterruptsPending=function(){return 0<(a.interruptsRequestedValue&a.interruptsEnabledValue&31)};a.saveState=function(){C(1024+50*a.saveStateSlot,a.masterInterruptSwitch);C(1025+50*a.saveStateSlot,a.masterInterruptSwitchDelay)};a.loadState=function(){a.masterInterruptSwitch=E(1024+50*a.saveStateSlot);a.masterInterruptSwitchDelay=E(1025+50*a.saveStateSlot);a.updateInterruptEnabled(A(a.memoryLocationInterruptEnabled));
a.updateInterruptRequested(A(a.memoryLocationInterruptRequest))};a.masterInterruptSwitch=!1;a.masterInterruptSwitchDelay=!1;a.bitPositionVBlankInterrupt=0;a.bitPositionLcdInterrupt=1;a.bitPositionTimerInterrupt=2;a.bitPositionJoypadInterrupt=4;a.memoryLocationInterruptEnabled=65535;a.interruptsEnabledValue=0;a.isVBlankInterruptEnabled=!1;a.isLcdInterruptEnabled=!1;a.isTimerInterruptEnabled=!1;a.isJoypadInterruptEnabled=!1;a.memoryLocationInterruptRequest=65295;a.interruptsRequestedValue=0;a.isVBlankInterruptRequested=
!1;a.isLcdInterruptRequested=!1;a.isTimerInterruptRequested=!1;a.isJoypadInterruptRequested=!1;a.saveStateSlot=2;return a}();
function Ea(a){Fa(!1);var c=A(Q.memoryLocationInterruptRequest);c=l(a,c);Q.interruptsRequestedValue=c;F(Q.memoryLocationInterruptRequest,c);n.stackPointer-=2;n.isHalted();c=n.stackPointer;var d=n.programCounter,e=k(d),g=c+1;F(c,d&255);F(g,e);switch(a){case Q.bitPositionVBlankInterrupt:Q.isVBlankInterruptRequested=!1;n.programCounter=64;break;case Q.bitPositionLcdInterrupt:Q.isLcdInterruptRequested=!1;n.programCounter=72;break;case Q.bitPositionTimerInterrupt:Q.isTimerInterruptRequested=!1;n.programCounter=
80;break;case Q.bitPositionJoypadInterrupt:Q.isJoypadInterruptRequested=!1,n.programCounter=96}}function Ga(a){var c=A(Q.memoryLocationInterruptRequest);c|=1<<a;Q.interruptsRequestedValue=c;F(Q.memoryLocationInterruptRequest,c)}function Fa(a){a?Q.masterInterruptSwitchDelay=!0:Q.masterInterruptSwitch=!1}
var R=function(){function a(){}a.batchProcessCycles=function(){return 256};a.updateDividerRegister=function(){var c=a.dividerRegister;a.dividerRegister=0;F(a.memoryLocationDividerRegister,0);a.timerEnabled&&Ha(c,a.dividerRegister)&&Ia()};a.updateTimerCounter=function(c){if(a.timerEnabled){if(a.timerCounterWasReset)return;a.timerCounterOverflowDelay&&(a.timerCounterOverflowDelay=!1)}a.timerCounter=c};a.updateTimerModulo=function(c){a.timerModulo=c;a.timerEnabled&&a.timerCounterWasReset&&(a.timerCounter=
a.timerModulo,a.timerCounterWasReset=!1)};a.updateTimerControl=function(c){var d=a.timerEnabled;a.timerEnabled=m(2,c);c&=3;if(!d){d=Ja(a.timerInputClock);var e=Ja(c);(a.timerEnabled?m(d,a.dividerRegister):m(d,a.dividerRegister)&&m(e,a.dividerRegister))&&Ia()}a.timerInputClock=c};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.currentCycles;b[1028+50*a.saveStateSlot]=a.dividerRegister;C(1032+50*a.saveStateSlot,a.timerCounterOverflowDelay);C(1035+50*a.saveStateSlot,a.timerCounterWasReset);F(a.memoryLocationTimerCounter,
a.timerCounter)};a.loadState=function(){a.currentCycles=b[1024+50*a.saveStateSlot];a.dividerRegister=b[1028+50*a.saveStateSlot];a.timerCounterOverflowDelay=E(1032+50*a.saveStateSlot);a.timerCounterWasReset=E(1035+50*a.saveStateSlot);a.timerCounter=A(a.memoryLocationTimerCounter);a.timerModulo=A(a.memoryLocationTimerModulo);a.timerInputClock=A(a.memoryLocationTimerControl)};a.currentCycles=0;a.memoryLocationDividerRegister=65284;a.dividerRegister=0;a.memoryLocationTimerCounter=65285;a.timerCounter=
0;a.timerCounterOverflowDelay=!1;a.timerCounterWasReset=!1;a.timerCounterMask=0;a.memoryLocationTimerModulo=65286;a.timerModulo=0;a.memoryLocationTimerControl=65287;a.timerEnabled=!1;a.timerInputClock=0;a.saveStateSlot=5;return a}();
function Ka(a){for(var c=0;c<a;){var d=R.dividerRegister;c+=4;R.dividerRegister+=4;65535<R.dividerRegister&&(R.dividerRegister-=65536);R.timerEnabled&&(R.timerCounterOverflowDelay?(R.timerCounter=R.timerModulo,Q.isTimerInterruptRequested=!0,Ga(Q.bitPositionTimerInterrupt),R.timerCounterOverflowDelay=!1,R.timerCounterWasReset=!0):R.timerCounterWasReset&&(R.timerCounterWasReset=!1),Ha(d,R.dividerRegister)&&Ia())}}
function Ia(){R.timerCounter+=1;255<R.timerCounter&&(R.timerCounterOverflowDelay=!0,R.timerCounter=0)}function Ha(a,c){var d=Ja(R.timerInputClock);return m(d,a)&&!m(d,c)?!0:!1}function Ja(a){switch(a){case 0:return 9;case 1:return 3;case 2:return 5;case 3:return 7}return 0}
var S=function(){function a(){}a.updateJoypad=function(c){a.joypadRegisterFlipped=c^255;a.isDpadType=m(4,a.joypadRegisterFlipped);a.isButtonType=m(5,a.joypadRegisterFlipped)};a.saveState=function(){};a.loadState=function(){a.updateJoypad(A(a.memoryLocationJoypadRegister))};a.up=!1;a.down=!1;a.left=!1;a.right=!1;a.a=!1;a.b=!1;a.select=!1;a.start=!1;a.memoryLocationJoypadRegister=65280;a.joypadRegisterFlipped=0;a.isDpadType=!1;a.isButtonType=!1;a.saveStateSlot=3;return a}();
function La(a){var c=n.isStopped=!1;Ma(a)||(c=!0);Na(a,!0);c&&(c=!1,3>=a&&(c=!0),a=!1,S.isDpadType&&c&&(a=!0),S.isButtonType&&!c&&(a=!0),a&&(Q.isJoypadInterruptRequested=!0,Ga(Q.bitPositionJoypadInterrupt)))}function Ma(a){switch(a){case 0:return S.up;case 1:return S.right;case 2:return S.down;case 3:return S.left;case 4:return S.a;case 5:return S.b;case 6:return S.select;case 7:return S.start;default:return!1}}
function Na(a,c){switch(a){case 0:S.up=c;break;case 1:S.right=c;break;case 2:S.down=c;break;case 3:S.left=c;break;case 4:S.a=c;break;case 5:S.b=c;break;case 6:S.select=c;break;case 7:S.start=c}}function Oa(a,c,d){for(var e=0;e<d;e++){for(var g=Pa(a+e),p=c+e;40959<p;)p-=8192;Qa(p,g)&&F(p,g)}a=32;n.GBCDoubleSpeed&&(a=64);V.DMACycles+=d/16*a}
function Qa(a,c){if(a===n.memoryLocationSpeedSwitch)return F(n.memoryLocationSpeedSwitch,c&1),!1;var d=V.videoRamLocation,e=V.spriteInformationTableLocation;if(a<d){if(!V.isRomOnly)if(8191>=a){if(!V.isMBC2||m(4,c))c&=15,0===c?V.isRamBankingEnabled=!1:10===c&&(V.isRamBankingEnabled=!0)}else 16383>=a?!V.isMBC5||12287>=a?(V.isMBC2&&(V.currentRomBank=c&15),V.isMBC1?(c&=31,V.currentRomBank&=224):V.isMBC3?(c&=127,V.currentRomBank&=128):V.isMBC5&&(V.currentRomBank&=0),V.currentRomBank|=c):(a=0,d=V.currentRomBank&
255,0<c&&(a=1),V.currentRomBank=h(a,d)):!V.isMBC2&&24575>=a?V.isMBC1&&V.isMBC1RomModeEnabled?(V.currentRomBank&=31,V.currentRomBank|=c&224):(c=V.isMBC5?c&15:c&3,V.currentRamBank=c):!V.isMBC2&&32767>=a&&V.isMBC1&&(m(0,c)?V.isMBC1RomModeEnabled=!0:V.isMBC1RomModeEnabled=!1);return!1}if(a>=d&&a<V.cartridgeRamLocation)return!0;if(a>=V.echoRamLocation&&a<e)return F(a-8192,c),!0;if(a>=e&&a<=V.spriteInformationTableLocationEnd)return 2>W.currentLcdMode?!1:!0;if(a>=V.unusableMemoryLocation&&a<=V.unusableMemoryEndLocation)return!1;
if(65296<=a&&65318>=a){za();if(a===P.memoryLocationNR52||P.NR52IsSoundEnabled){switch(a){case G.memoryLocationNRx0:G.updateNRx0(c);break;case L.memoryLocationNRx0:L.updateNRx0(c);break;case G.memoryLocationNRx1:G.updateNRx1(c);break;case H.memoryLocationNRx1:H.updateNRx1(c);break;case L.memoryLocationNRx1:L.updateNRx1(c);break;case M.memoryLocationNRx1:M.updateNRx1(c);break;case G.memoryLocationNRx2:G.updateNRx2(c);break;case H.memoryLocationNRx2:H.updateNRx2(c);break;case L.memoryLocationNRx2:L.volumeCodeChanged=
!0;L.updateNRx2(c);break;case M.memoryLocationNRx2:M.updateNRx2(c);break;case G.memoryLocationNRx3:G.updateNRx3(c);break;case H.memoryLocationNRx3:H.updateNRx3(c);break;case L.memoryLocationNRx3:L.updateNRx3(c);break;case M.memoryLocationNRx3:M.updateNRx3(c);break;case G.memoryLocationNRx4:m(7,c)&&(G.updateNRx4(c),G.trigger());break;case H.memoryLocationNRx4:m(7,c)&&(H.updateNRx4(c),H.trigger());break;case L.memoryLocationNRx4:m(7,c)&&(L.updateNRx4(c),L.trigger());break;case M.memoryLocationNRx4:m(7,
c)&&(M.updateNRx4(c),M.trigger());break;case P.memoryLocationNR50:P.updateNR50(c);O.mixerVolumeChanged=!0;break;case P.memoryLocationNR51:P.updateNR51(c);O.mixerEnabledChanged=!0;break;case P.memoryLocationNR52:if(P.updateNR52(c),!m(7,c))for(c=65296;65318>c;c++)F(c,0)}c=!0}else c=!1;return c}65328<=a&&65343>=a&&za();if(a>=W.memoryLocationLcdControl&&a<=B.memoryLocationWindowX){if(a===W.memoryLocationLcdControl)return W.updateLcdControl(c),!0;if(a===W.memoryLocationLcdStatus)return W.updateLcdStatus(c),
!1;if(a===B.memoryLocationScanlineRegister)return B.scanlineRegister=0,F(a,0),!1;if(a===W.memoryLocationCoincidenceCompare)return W.coincidenceCompare=c,!0;if(a===B.memoryLocationDmaTransfer){c<<=8;for(a=0;159>=a;a++)d=A(c+a),F(V.spriteInformationTableLocation+a,d);V.DMACycles=644;return!0}switch(a){case B.memoryLocationScrollX:B.scrollX=c;break;case B.memoryLocationScrollY:B.scrollY=c;break;case B.memoryLocationWindowX:B.windowX=c;break;case B.memoryLocationWindowY:B.windowY=c}return!0}if(a===V.memoryLocationHdmaTrigger)return n.GBCEnabled&&
(V.isHblankHdmaActive&&!m(7,c)?(V.isHblankHdmaActive=!1,c=A(V.memoryLocationHdmaTrigger),F(V.memoryLocationHdmaTrigger,c|128)):(a=A(V.memoryLocationHdmaSourceHigh),d=A(V.memoryLocationHdmaSourceLow),a=h(a,d)&65520,d=A(V.memoryLocationHdmaDestinationHigh),e=A(V.memoryLocationHdmaDestinationLow),d=h(d,e),d=(d&8176)+V.videoRamLocation,e=l(7,c),e=16*(e+1),m(7,c)?(V.isHblankHdmaActive=!0,V.hblankHdmaTransferLengthRemaining=e,V.hblankHdmaSource=a,V.hblankHdmaDestination=d,F(V.memoryLocationHdmaTrigger,
l(7,c))):(Oa(a,d,e),F(V.memoryLocationHdmaTrigger,255)))),!1;if((a===V.memoryLocationGBCWRAMBank||a===V.memoryLocationGBCVRAMBank)&&V.isHblankHdmaActive&&(16384<=V.hblankHdmaSource&&32767>=V.hblankHdmaSource||53248<=V.hblankHdmaSource&&57343>=V.hblankHdmaSource))return!1;if(a>=ia.memoryLocationBackgroundPaletteIndex&&a<=ia.memoryLocationSpritePaletteData){if(a===ia.memoryLocationBackgroundPaletteData||a===ia.memoryLocationSpritePaletteData){d=A(a-1);d=l(6,d);e=!1;a===ia.memoryLocationSpritePaletteData&&
(e=!0);var g=d&63;e&&(g+=64);b[67584+g]=c;c=d;--a;m(7,c)&&F(a,c+1|128)}return!0}if(a>=R.memoryLocationDividerRegister&&a<=R.memoryLocationTimerControl){Ka(R.currentCycles);R.currentCycles=0;switch(a){case R.memoryLocationDividerRegister:return R.updateDividerRegister(c),!1;case R.memoryLocationTimerCounter:R.updateTimerCounter(c);break;case R.memoryLocationTimerModulo:R.updateTimerModulo(c);break;case R.memoryLocationTimerControl:R.updateTimerControl(c)}return!0}a===S.memoryLocationJoypadRegister&&
S.updateJoypad(c);if(a===Q.memoryLocationInterruptRequest)return Q.updateInterruptRequested(c),!0;a===Q.memoryLocationInterruptEnabled&&Q.updateInterruptEnabled(c);return!0}
function Sa(a){switch(a>>12){case 0:case 1:case 2:case 3:return a+850944;case 4:case 5:case 6:case 7:var c=V.currentRomBank;V.isMBC5||0!==c||(c=1);return 16384*c+(a-V.switchableCartridgeRomLocation)+850944;case 8:case 9:return c=0,n.GBCEnabled&&(c=A(V.memoryLocationGBCVRAMBank)&1),a-V.videoRamLocation+2048+8192*c;case 10:case 11:return 8192*V.currentRamBank+(a-V.cartridgeRamLocation)+719872;case 12:return a-V.internalRamBankZeroLocation+18432;case 13:return c=0,n.GBCEnabled&&(c=A(V.memoryLocationGBCWRAMBank)&
7),1>c&&(c=1),a-V.internalRamBankZeroLocation+18432+4096*(c-1);default:return a-V.echoRamLocation+51200}}function F(a,c){a=Sa(a);b[a]=c}function C(a,c){b[a]=c?1:0}
var W=function(){function a(){}a.updateLcdStatus=function(c){var d=A(a.memoryLocationLcdStatus);c=c&248|d&7|128;F(a.memoryLocationLcdStatus,c)};a.updateLcdControl=function(c){a.enabled=m(7,c);a.windowTileMapDisplaySelect=m(6,c);a.windowDisplayEnabled=m(5,c);a.bgWindowTileDataSelect=m(4,c);a.bgTileMapDisplaySelect=m(3,c);a.tallSpriteSize=m(2,c);a.spriteDisplayEnable=m(1,c);a.bgDisplayEnabled=m(0,c)};a.memoryLocationLcdStatus=65345;a.currentLcdMode=0;a.memoryLocationCoincidenceCompare=65349;a.coincidenceCompare=
0;a.memoryLocationLcdControl=65344;a.enabled=!0;a.windowTileMapDisplaySelect=!1;a.windowDisplayEnabled=!1;a.bgWindowTileDataSelect=!1;a.bgTileMapDisplaySelect=!1;a.tallSpriteSize=!1;a.spriteDisplayEnable=!1;a.bgDisplayEnabled=!1;return a}();
function Ta(a,c,d,e,g,p){for(var D=e>>3;160>g;g++){var v=g+p;256<=v&&(v-=256);var I=d+32*D+(v>>3),w=ra(I,0),J=!1;if(f.tileCaching){var x=g;var y=a,T=v,N=I,U=w,K=0;if(0<y&&8<x&&U===oa.tileId&&x===oa.nextXIndexToPerformCacheCheck){var xa=U=!1;m(5,A(N-1))&&(U=!0);m(5,A(N))&&(xa=!0);for(N=0;8>N;N++)if(U!==xa&&(N=7-N),160>=x+N){for(var ya=x-(8-N),tb=93184+3*(160*y+(x+N)),Ra=0;3>Ra;Ra++)Ua(x+N,y,Ra,b[tb+Ra]);ya=b[69632+(160*y+ya)];na(x+N,y,l(2,ya),m(2,ya));K++}}else oa.tileId=U;x>=oa.nextXIndexToPerformCacheCheck&&
(oa.nextXIndexToPerformCacheCheck=x+8,y=T%8,x<y&&(oa.nextXIndexToPerformCacheCheck+=y));x=K;0<x&&(g+=x-1,J=!0)}f.tileRendering&&!J?(J=g,x=a,K=c,y=e%8,T=0,0==J&&(T=v-v/8*8),v=7,160<J+8&&(v=160-J),U=-1,xa=0,n.GBCEnabled&&(U=ra(I,1),m(3,U)&&(xa=1),m(6,U)&&(y=7-y)),x=pa(w,K,xa,T,v,y,J,x,160,93184,!1,0,U),0<x&&(g+=x-1)):J||(n.GBCEnabled?(J=g,x=a,y=e,K=qa(c,w),I=ra(I,1),y%=8,m(6,I)&&(y=7-y),T=0,m(3,I)&&(T=1),w=ra(K+2*y,T),K=ra(K+2*y+1,T),y=v%8,m(5,I)||(y=7-y),v=0,m(y,K)&&(v=v+1<<1),m(y,w)&&(v+=1),y=ka(I&
7,v,!1),w=ma(0,y),K=ma(1,y),y=ma(2,y),Ua(J,x,0,w),Ua(J,x,1,K),Ua(J,x,2,y),na(J,x,v,m(7,I))):(I=g,J=a,K=e,x=qa(c,w),K%=8,w=ra(x+2*K,0),x=ra(x+2*K+1,0),K=7-v%8,v=0,m(K,x)&&(v=v+1<<1),m(K,w)&&(v+=1),w=ja(v,B.memoryLocationBackgroundPalette),Ua(I,J,0,w),Ua(I,J,1,w),Ua(I,J,2,w),na(I,J,v)))}}
var B=function(){function a(){}a.batchProcessCycles=function(){return a.MAX_CYCLES_PER_SCANLINE()};a.MAX_CYCLES_PER_SCANLINE=function(){return n.GBCDoubleSpeed?153===a.scanlineRegister?8:912:153===a.scanlineRegister?4:456};a.MIN_CYCLES_SPRITES_LCD_MODE=function(){return n.GBCDoubleSpeed?752:376};a.MIN_CYCLES_TRANSFER_DATA_LCD_MODE=function(){return n.GBCDoubleSpeed?498:249};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.scanlineCycleCounter;b[1028+50*a.saveStateSlot]=W.currentLcdMode;F(a.memoryLocationScanlineRegister,
a.scanlineRegister)};a.loadState=function(){a.scanlineCycleCounter=b[1024+50*a.saveStateSlot];W.currentLcdMode=b[1028+50*a.saveStateSlot];a.scanlineRegister=A(a.memoryLocationScanlineRegister);W.updateLcdControl(A(W.memoryLocationLcdControl))};a.currentCycles=0;a.scanlineCycleCounter=0;a.memoryLocationScanlineRegister=65348;a.scanlineRegister=0;a.memoryLocationDmaTransfer=65350;a.memoryLocationScrollX=65347;a.scrollX=0;a.memoryLocationScrollY=65346;a.scrollY=0;a.memoryLocationWindowX=65355;a.windowX=
0;a.memoryLocationWindowY=65354;a.windowY=0;a.memoryLocationTileMapSelectZeroStart=38912;a.memoryLocationTileMapSelectOneStart=39936;a.memoryLocationTileDataSelectZeroStart=34816;a.memoryLocationTileDataSelectOneStart=32768;a.memoryLocationSpriteAttributesTable=65024;a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;a.saveStateSlot=1;return a}();
function Va(a){if(W.enabled)for(B.scanlineCycleCounter+=a;B.scanlineCycleCounter>=B.MAX_CYCLES_PER_SCANLINE();){B.scanlineCycleCounter-=B.MAX_CYCLES_PER_SCANLINE();a=B.scanlineRegister;if(144===a){if(f.graphicsDisableScanlineRendering)for(var c=0;144>=c;c++)Wa(c);else Wa(a);for(c=0;144>c;c++)for(var d=0;160>d;d++)b[69632+(160*c+d)]=0;oa.tileId=-1;oa.nextXIndexToPerformCacheCheck=-1}else 144>a&&(f.graphicsDisableScanlineRendering||Wa(a));a=153<a?0:a+1;B.scanlineRegister=a}if(W.enabled){if(a=B.scanlineRegister,
d=W.currentLcdMode,c=0,144<=a?c=1:B.scanlineCycleCounter>=B.MIN_CYCLES_SPRITES_LCD_MODE()?c=2:B.scanlineCycleCounter>=B.MIN_CYCLES_TRANSFER_DATA_LCD_MODE()&&(c=3),d!==c){d=A(W.memoryLocationLcdStatus);W.currentLcdMode=c;var e=!1;switch(c){case 0:d=l(0,d);d=l(1,d);e=m(3,d);break;case 1:d=l(1,d);d|=1;e=m(4,d);break;case 2:d=l(0,d);d|=2;e=m(5,d);break;case 3:d|=3}e&&(Q.isLcdInterruptRequested=!0,Ga(Q.bitPositionLcdInterrupt));0===c&&V.isHblankHdmaActive&&(e=16,V.hblankHdmaTransferLengthRemaining<e&&
(e=V.hblankHdmaTransferLengthRemaining),Oa(V.hblankHdmaSource,V.hblankHdmaDestination,e),V.hblankHdmaSource+=e,V.hblankHdmaDestination+=e,V.hblankHdmaTransferLengthRemaining-=e,0>=V.hblankHdmaTransferLengthRemaining?(V.isHblankHdmaActive=!1,F(V.memoryLocationHdmaTrigger,255)):F(V.memoryLocationHdmaTrigger,l(7,V.hblankHdmaTransferLengthRemaining/16-1)));1===c&&(Q.isVBlankInterruptRequested=!0,Ga(Q.bitPositionVBlankInterrupt));e=W.coincidenceCompare;0!==c&&1!==c||a!==e?d=l(2,d):(d|=4,m(6,d)&&(Q.isLcdInterruptRequested=
!0,Ga(Q.bitPositionLcdInterrupt)));F(W.memoryLocationLcdStatus,d)}}else B.scanlineCycleCounter=0,B.scanlineRegister=0,F(B.memoryLocationScanlineRegister,0),d=A(W.memoryLocationLcdStatus),d=l(1,d),d=l(0,d),W.currentLcdMode=0,F(W.memoryLocationLcdStatus,d)}
function Wa(a){var c=B.memoryLocationTileDataSelectZeroStart;W.bgWindowTileDataSelect&&(c=B.memoryLocationTileDataSelectOneStart);if(n.GBCEnabled||W.bgDisplayEnabled){var d=B.memoryLocationTileMapSelectZeroStart;W.bgTileMapDisplaySelect&&(d=B.memoryLocationTileMapSelectOneStart);var e=B.scrollX,g=a+B.scrollY;256<=g&&(g-=256);Ta(a,c,d,g,0,e)}W.windowDisplayEnabled&&(d=B.memoryLocationTileMapSelectZeroStart,W.windowTileMapDisplaySelect&&(d=B.memoryLocationTileMapSelectOneStart),e=B.windowX,g=B.windowY,
a<g||(e-=7,Ta(a,c,d,a-g,e,-1*e)));if(W.spriteDisplayEnable)for(c=W.tallSpriteSize,d=39;0<=d;d--){g=4*d;var p=A(B.memoryLocationSpriteAttributesTable+g);e=A(B.memoryLocationSpriteAttributesTable+g+1);var D=A(B.memoryLocationSpriteAttributesTable+g+2);p-=16;e-=8;var v=8;c&&(v=16,1===D%2&&--D);if(a>=p&&a<p+v){g=A(B.memoryLocationSpriteAttributesTable+g+3);var I=m(7,g),w=m(6,g),J=m(5,g);p=a-p;w&&(p-=v,p*=-1,--p);p*=2;D=qa(B.memoryLocationTileDataSelectOneStart,D);v=D+=p;p=0;n.GBCEnabled&&m(3,g)&&(p=1);
D=ra(v,p);v=ra(v+1,p);for(p=7;0<=p;p--){w=p;J&&(w-=7,w*=-1);var x=0;m(w,v)&&(x+=1,x<<=1);m(w,D)&&(x+=1);if(0!==x&&(w=e+(7-p),0<=w&&160>=w)){var y=!1,T=!1,N=!1;n.GBCEnabled&&!W.bgDisplayEnabled&&(y=!0);if(!y){var U=b[69632+(160*a+w)],K=U&3;I&&0<K?T=!0:n.GBCEnabled&&m(2,U)&&0<K&&(N=!0)}if(y||!T&&!N)n.GBCEnabled?(T=ka(g&7,x,!0),x=ma(0,T),y=ma(1,T),T=ma(2,T),Ua(w,a,0,x),Ua(w,a,1,y),Ua(w,a,2,T)):(y=B.memoryLocationSpritePaletteOne,m(4,g)&&(y=B.memoryLocationSpritePaletteTwo),x=ja(x,y),Ua(w,a,0,x),Ua(w,
a,1,x),Ua(w,a,2,x))}}}}}function Ua(a,c,d,e){b[93184+3*(160*c+a)+d]=e}function ra(a,c){return b[a-V.videoRamLocation+2048+8192*(c&1)]}
function Xa(a){var c=V.videoRamLocation;return a<c||a>=c&&a<V.cartridgeRamLocation?-1:a>=V.echoRamLocation&&a<V.spriteInformationTableLocation?A(a-8192):a>=V.spriteInformationTableLocation&&a<=V.spriteInformationTableLocationEnd?2>W.currentLcdMode?255:-1:a===n.memoryLocationSpeedSwitch?(a=255,c=A(n.memoryLocationSpeedSwitch),m(0,c)||(a=l(0,a)),n.GBCDoubleSpeed||(a=l(7,a)),a):a===B.memoryLocationScanlineRegister?(F(a,B.scanlineRegister),B.scanlineRegister):65296<=a&&65318>=a?(za(),a=a===P.memoryLocationNR52?
A(P.memoryLocationNR52)&128|112:-1,a):65328<=a&&65343>=a?(za(),-1):a===R.memoryLocationDividerRegister?(c=k(R.dividerRegister),F(a,c),c):a===R.memoryLocationTimerCounter?(F(a,R.timerCounter),R.timerCounter):a===Q.memoryLocationInterruptRequest?224|Q.interruptsRequestedValue:a===S.memoryLocationJoypadRegister?(a=S.joypadRegisterFlipped,S.isDpadType?(a=S.up?l(2,a):a|4,a=S.right?l(0,a):a|1,a=S.down?l(3,a):a|8,a=S.left?l(1,a):a|2):S.isButtonType&&(a=S.a?l(0,a):a|1,a=S.b?l(1,a):a|2,a=S.select?l(2,a):a|
4,a=S.start?l(3,a):a|8),a|240):-1}function A(a){return b[Sa(a)]}function Pa(a){var c=Xa(a);switch(c){case -1:return A(a);default:return c}}function E(a){return 0<b[a]?!0:!1}
var V=function(){function a(){}a.saveState=function(){b[1024+50*a.saveStateSlot]=a.currentRomBank;b[1026+50*a.saveStateSlot]=a.currentRamBank;C(1028+50*a.saveStateSlot,a.isRamBankingEnabled);C(1029+50*a.saveStateSlot,a.isMBC1RomModeEnabled);C(1030+50*a.saveStateSlot,a.isRomOnly);C(1031+50*a.saveStateSlot,a.isMBC1);C(1032+50*a.saveStateSlot,a.isMBC2);C(1033+50*a.saveStateSlot,a.isMBC3);C(1034+50*a.saveStateSlot,a.isMBC5)};a.loadState=function(){a.currentRomBank=b[1024+50*a.saveStateSlot];a.currentRamBank=
b[1026+50*a.saveStateSlot];a.isRamBankingEnabled=E(1028+50*a.saveStateSlot);a.isMBC1RomModeEnabled=E(1029+50*a.saveStateSlot);a.isRomOnly=E(1030+50*a.saveStateSlot);a.isMBC1=E(1031+50*a.saveStateSlot);a.isMBC2=E(1032+50*a.saveStateSlot);a.isMBC3=E(1033+50*a.saveStateSlot);a.isMBC5=E(1034+50*a.saveStateSlot)};a.cartridgeRomLocation=0;a.switchableCartridgeRomLocation=16384;a.videoRamLocation=32768;a.cartridgeRamLocation=40960;a.internalRamBankZeroLocation=49152;a.internalRamBankOneLocation=53248;a.echoRamLocation=
57344;a.spriteInformationTableLocation=65024;a.spriteInformationTableLocationEnd=65183;a.unusableMemoryLocation=65184;a.unusableMemoryEndLocation=65279;a.currentRomBank=0;a.currentRamBank=0;a.isRamBankingEnabled=!1;a.isMBC1RomModeEnabled=!0;a.isRomOnly=!0;a.isMBC1=!1;a.isMBC2=!1;a.isMBC3=!1;a.isMBC5=!1;a.memoryLocationHdmaSourceHigh=65361;a.memoryLocationHdmaSourceLow=65362;a.memoryLocationHdmaDestinationHigh=65363;a.memoryLocationHdmaDestinationLow=65364;a.memoryLocationHdmaTrigger=65365;a.DMACycles=
0;a.isHblankHdmaActive=!1;a.hblankHdmaTransferLengthRemaining=0;a.hblankHdmaSource=0;a.hblankHdmaDestination=0;a.memoryLocationGBCVRAMBank=65359;a.memoryLocationGBCWRAMBank=65392;a.saveStateSlot=4;return a}(),n=function(){function a(){}a.CLOCK_SPEED=function(){return a.GBCDoubleSpeed?8388608:4194304};a.MAX_CYCLES_PER_FRAME=function(){return a.GBCDoubleSpeed?140448:70224};a.enableHalt=function(){Q.masterInterruptSwitch?a.isHaltNormal=!0:0===(Q.interruptsEnabledValue&Q.interruptsRequestedValue&31)?
a.isHaltNoJump=!0:a.isHaltBug=!0};a.exitHaltAndStop=function(){a.isHaltNoJump=!1;a.isHaltNormal=!1;a.isHaltBug=!1;a.isStopped=!1};a.isHalted=function(){return a.isHaltNormal||a.isHaltNoJump?!0:!1};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.registerA;b[1025+50*a.saveStateSlot]=a.registerB;b[1026+50*a.saveStateSlot]=a.registerC;b[1027+50*a.saveStateSlot]=a.registerD;b[1028+50*a.saveStateSlot]=a.registerE;b[1029+50*a.saveStateSlot]=a.registerH;b[1030+50*a.saveStateSlot]=a.registerL;b[1031+50*
a.saveStateSlot]=a.registerF;b[1032+50*a.saveStateSlot]=a.stackPointer;b[1034+50*a.saveStateSlot]=a.programCounter;b[1036+50*a.saveStateSlot]=a.currentCycles;C(1041+50*a.saveStateSlot,a.isHaltNormal);C(1042+50*a.saveStateSlot,a.isHaltNoJump);C(1043+50*a.saveStateSlot,a.isHaltBug);C(1044+50*a.saveStateSlot,a.isStopped)};a.loadState=function(){a.registerA=b[1024+50*a.saveStateSlot];a.registerB=b[1025+50*a.saveStateSlot];a.registerC=b[1026+50*a.saveStateSlot];a.registerD=b[1027+50*a.saveStateSlot];a.registerE=
b[1028+50*a.saveStateSlot];a.registerH=b[1029+50*a.saveStateSlot];a.registerL=b[1030+50*a.saveStateSlot];a.registerF=b[1031+50*a.saveStateSlot];a.stackPointer=b[1032+50*a.saveStateSlot];a.programCounter=b[1034+50*a.saveStateSlot];a.currentCycles=b[1036+50*a.saveStateSlot];a.isHaltNormal=E(1041+50*a.saveStateSlot);a.isHaltNoJump=E(1042+50*a.saveStateSlot);a.isHaltBug=E(1043+50*a.saveStateSlot);a.isStopped=E(1044+50*a.saveStateSlot)};a.GBCEnabled=!1;a.memoryLocationSpeedSwitch=65357;a.GBCDoubleSpeed=
!1;a.registerA=0;a.registerB=0;a.registerC=0;a.registerD=0;a.registerE=0;a.registerH=0;a.registerL=0;a.registerF=0;a.stackPointer=0;a.programCounter=0;a.currentCycles=0;a.isHaltNormal=!1;a.isHaltNoJump=!1;a.isHaltBug=!1;a.isStopped=!1;a.saveStateSlot=0;return a}();function Ya(a){z(n.registerA,a);fa(n.registerA,a);n.registerA=n.registerA+a&255;0===n.registerA?q(1):q(0);r(0)}
function Za(a){var c=n.registerA+a+ea()&255;0!=((n.registerA^a^c)&16)?t(1):t(0);0<(n.registerA+a+ea()&256)?u(1):u(0);n.registerA=c;0===n.registerA?q(1):q(0);r(0)}function $a(a){var c=-1*a;z(n.registerA,c);fa(n.registerA,c);n.registerA=n.registerA-a&255;0===n.registerA?q(1):q(0);r(1)}function ab(a){var c=n.registerA-a-ea()&255;0!=((n.registerA^a^c)&16)?t(1):t(0);0<(n.registerA-a-ea()&256)?u(1):u(0);n.registerA=c;0===n.registerA?q(1):q(0);r(1)}
function bb(a){n.registerA&=a;0===n.registerA?q(1):q(0);r(0);t(1);u(0)}function cb(a){n.registerA=(n.registerA^a)&255;0===n.registerA?q(1):q(0);r(0);t(0);u(0)}function db(a){n.registerA|=a;0===n.registerA?q(1):q(0);r(0);t(0);u(0)}function eb(a){a*=-1;z(n.registerA,a);fa(n.registerA,a);0===n.registerA+a?q(1):q(0);r(1)}function fb(a,c){0===(c&1<<a)?q(1):q(0);r(0);t(1);return c}function gb(a,c,d){return 0<c?d|1<<a:d&~(1<<a)}
function hb(a){a=ba(a);n.programCounter=n.programCounter+a&65535;n.programCounter=n.programCounter+1&65535}
function ib(a){n.programCounter=n.programCounter+1&65535;n.isHaltBug&&(n.programCounter=n.programCounter-1&65535);switch((a&240)>>4){case 0:return jb(a);case 1:return kb(a);case 2:return lb(a);case 3:return mb(a);case 4:return nb(a);case 5:return ob(a);case 6:return pb(a);case 7:return qb(a);case 8:return rb(a);case 9:return sb(a);case 10:return ub(a);case 11:return vb(a);case 12:return wb(a);case 13:return xb(a);case 14:return yb(a);default:return zb(a)}}function X(a){Ab(4);return Pa(a)}
function Y(a,c){Ab(4);Qa(a,c)&&F(a,c)}function Bb(a){Ab(8);var c=Xa(a);switch(c){case -1:c=A(a)}a+=1;var d=Xa(a);switch(d){case -1:a=A(a);break;default:a=d}return h(a,c)}function Cb(a,c){Ab(8);var d=k(c);c&=255;var e=a+1;Qa(a,c)&&F(a,c);Qa(e,d)&&F(e,d)}function Z(){Ab(4);return A(n.programCounter)}function Db(){Ab(4);var a=A(n.programCounter+1&65535);return h(a,Z())}
function jb(a){switch(a){case 0:return 4;case 1:return a=Db(),n.registerB=k(a),n.registerC=a&255,n.programCounter=n.programCounter+2&65535,4;case 2:return Y(h(n.registerB,n.registerC),n.registerA),4;case 3:return a=h(n.registerB,n.registerC),a++,n.registerB=k(a),n.registerC=a&255,8;case 4:return z(n.registerB,1),n.registerB=n.registerB+1&255,0===n.registerB?q(1):q(0),r(0),4;case 5:return z(n.registerB,-1),n.registerB=n.registerB-1&255,0===n.registerB?q(1):q(0),r(1),4;case 6:return n.registerB=Z(),
n.programCounter=n.programCounter+1&65535,4;case 7:128===(n.registerA&128)?u(1):u(0);a=n;var c=n.registerA;a.registerA=(c<<1|c>>7)&255;q(0);r(0);t(0);return 4;case 8:return Cb(Db(),n.stackPointer),n.programCounter=n.programCounter+2&65535,4;case 9:return a=h(n.registerH,n.registerL),c=h(n.registerB,n.registerC),ha(a,c,!1),a=a+c&65535,n.registerH=k(a),n.registerL=a&255,r(0),8;case 10:return n.registerA=X(h(n.registerB,n.registerC)),4;case 11:return a=h(n.registerB,n.registerC),a=a-1&65535,n.registerB=
k(a),n.registerC=a&255,8;case 12:return z(n.registerC,1),n.registerC=n.registerC+1&255,0===n.registerC?q(1):q(0),r(0),4;case 13:return z(n.registerC,-1),n.registerC=n.registerC-1&255,0===n.registerC?q(1):q(0),r(1),4;case 14:return n.registerC=Z(),n.programCounter=n.programCounter+1&65535,4;case 15:return 0<(n.registerA&1)?u(1):u(0),a=n,c=n.registerA,a.registerA=(c>>1|c<<7)&255,q(0),r(0),t(0),4}return-1}
function kb(a){switch(a){case 16:if(n.GBCEnabled&&(a=X(n.memoryLocationSpeedSwitch),m(0,a)))return a=l(0,a),m(7,a)?(n.GBCDoubleSpeed=!1,a=l(7,a)):(n.GBCDoubleSpeed=!0,a|=128),Y(n.memoryLocationSpeedSwitch,a),68;n.isStopped=!0;n.programCounter=n.programCounter+1&65535;return 4;case 17:return a=Db(),n.registerD=k(a),n.registerE=a&255,n.programCounter=n.programCounter+2&65535,4;case 18:return Y(h(n.registerD,n.registerE),n.registerA),4;case 19:return a=h(n.registerD,n.registerE),a=a+1&65535,n.registerD=
k(a),n.registerE=a&255,8;case 20:return z(n.registerD,1),n.registerD=n.registerD+1&255,0===n.registerD?q(1):q(0),r(0),4;case 21:return z(n.registerD,-1),n.registerD=n.registerD-1&255,0===n.registerD?q(1):q(0),r(1),4;case 22:return n.registerD=Z(),n.programCounter=n.programCounter+1&65535,4;case 23:return a=!1,128===(n.registerA&128)&&(a=!0),n.registerA=(n.registerA<<1|ea())&255,a?u(1):u(0),q(0),r(0),t(0),4;case 24:return hb(Z()),8;case 25:a=h(n.registerH,n.registerL);var c=h(n.registerD,n.registerE);
ha(a,c,!1);a=a+c&65535;n.registerH=k(a);n.registerL=a&255;r(0);return 8;case 26:return a=h(n.registerD,n.registerE),n.registerA=X(a),4;case 27:return a=h(n.registerD,n.registerE),a=a-1&65535,n.registerD=k(a),n.registerE=a&255,8;case 28:return z(n.registerE,1),n.registerE=n.registerE+1&255,0===n.registerE?q(1):q(0),r(0),4;case 29:return z(n.registerE,-1),n.registerE=n.registerE-1&255,0===n.registerE?q(1):q(0),r(1),4;case 30:return n.registerE=Z(),n.programCounter=n.programCounter+1&65535,4;case 31:return a=
!1,1===(n.registerA&1)&&(a=!0),n.registerA=(n.registerA>>1|ea()<<7)&255,a?u(1):u(0),q(0),r(0),t(0),4}return-1}
function lb(a){switch(a){case 32:return 0===da()?hb(Z()):n.programCounter=n.programCounter+1&65535,8;case 33:return a=Db(),n.registerH=k(a),n.registerL=a&255,n.programCounter=n.programCounter+2&65535,4;case 34:return a=h(n.registerH,n.registerL),Y(a,n.registerA),a=a+1&65535,n.registerH=k(a),n.registerL=a&255,4;case 35:return a=h(n.registerH,n.registerL),a=a+1&65535,n.registerH=k(a),n.registerL=a&255,8;case 36:return z(n.registerH,1),n.registerH=n.registerH+1&255,0===n.registerH?q(1):q(0),r(0),4;case 37:return z(n.registerH,
-1),n.registerH=n.registerH-1&255,0===n.registerH?q(1):q(0),r(1),4;case 38:return n.registerH=Z(),n.programCounter=n.programCounter+1&65535,4;case 39:var c=0;0<(n.registerF>>5&1)&&(c|=6);0<ea()&&(c|=96);0<(n.registerF>>6&1)?a=n.registerA-c&255:(9<(n.registerA&15)&&(c|=6),153<n.registerA&&(c|=96),a=n.registerA+c&255);0===a?q(1):q(0);0!==(c&96)?u(1):u(0);t(0);n.registerA=a;return 4;case 40:return 0<da()?hb(Z()):n.programCounter=n.programCounter+1&65535,8;case 41:return a=h(n.registerH,n.registerL),
ha(a,a,!1),a=2*a&65535,n.registerH=k(a),n.registerL=a&255,r(0),8;case 42:return a=h(n.registerH,n.registerL),n.registerA=X(a),a=a+1&65535,n.registerH=k(a),n.registerL=a&255,4;case 43:return a=h(n.registerH,n.registerL),a=a-1&65535,n.registerH=k(a),n.registerL=a&255,8;case 44:return z(n.registerL,1),n.registerL=n.registerL+1&255,0===n.registerL?q(1):q(0),r(0),4;case 45:return z(n.registerL,-1),n.registerL=n.registerL-1&255,0===n.registerL?q(1):q(0),r(1),4;case 46:return n.registerL=Z(),n.programCounter=
n.programCounter+1&65535,4;case 47:return n.registerA=~n.registerA,r(1),t(1),4}return-1}
function mb(a){switch(a){case 48:return 0===ea()?hb(Z()):n.programCounter=n.programCounter+1&65535,8;case 49:return n.stackPointer=Db(),n.programCounter=n.programCounter+2&65535,4;case 50:return a=h(n.registerH,n.registerL),Y(a,n.registerA),a=a-1&65535,n.registerH=k(a),n.registerL=a&255,4;case 51:return n.stackPointer=n.stackPointer+1&65535,8;case 52:a=h(n.registerH,n.registerL);var c=X(a);z(c,1);c=c+1&255;0===c?q(1):q(0);r(0);Y(a,c);return 4;case 53:return a=h(n.registerH,n.registerL),c=X(a),z(c,
-1),c=c-1&255,0===c?q(1):q(0),r(1),Y(a,c),4;case 54:return Y(h(n.registerH,n.registerL),Z()),n.programCounter=n.programCounter+1&65535,4;case 55:return r(0),t(0),u(1),4;case 56:return 1===ea()?hb(Z()):n.programCounter=n.programCounter+1&65535,8;case 57:return a=h(n.registerH,n.registerL),ha(a,n.stackPointer,!1),a=a+n.stackPointer&65535,n.registerH=k(a),n.registerL=a&255,r(0),8;case 58:return a=h(n.registerH,n.registerL),n.registerA=X(a),a=a-1&65535,n.registerH=k(a),n.registerL=a&255,4;case 59:return n.stackPointer=
n.stackPointer-1&65535,8;case 60:return z(n.registerA,1),n.registerA=n.registerA+1&255,0===n.registerA?q(1):q(0),r(0),4;case 61:return z(n.registerA,-1),n.registerA=n.registerA-1&255,0===n.registerA?q(1):q(0),r(1),4;case 62:return n.registerA=Z(),n.programCounter=n.programCounter+1&65535,4;case 63:return r(0),t(0),0<ea()?u(0):u(1),4}return-1}
function nb(a){switch(a){case 64:return 4;case 65:return n.registerB=n.registerC,4;case 66:return n.registerB=n.registerD,4;case 67:return n.registerB=n.registerE,4;case 68:return n.registerB=n.registerH,4;case 69:return n.registerB=n.registerL,4;case 70:return n.registerB=X(h(n.registerH,n.registerL)),4;case 71:return n.registerB=n.registerA,4;case 72:return n.registerC=n.registerB,4;case 73:return 4;case 74:return n.registerC=n.registerD,4;case 75:return n.registerC=n.registerE,4;case 76:return n.registerC=
n.registerH,4;case 77:return n.registerC=n.registerL,4;case 78:return n.registerC=X(h(n.registerH,n.registerL)),4;case 79:return n.registerC=n.registerA,4}return-1}
function ob(a){switch(a){case 80:return n.registerD=n.registerB,4;case 81:return n.registerD=n.registerC,4;case 82:return 4;case 83:return n.registerD=n.registerE,4;case 84:return n.registerD=n.registerH,4;case 85:return n.registerD=n.registerL,4;case 86:return n.registerD=X(h(n.registerH,n.registerL)),4;case 87:return n.registerD=n.registerA,4;case 88:return n.registerE=n.registerB,4;case 89:return n.registerE=n.registerC,4;case 90:return n.registerE=n.registerD,4;case 91:return 4;case 92:return n.registerE=
n.registerH,4;case 93:return n.registerE=n.registerL,4;case 94:return n.registerE=X(h(n.registerH,n.registerL)),4;case 95:return n.registerE=n.registerA,4}return-1}
function pb(a){switch(a){case 96:return n.registerH=n.registerB,4;case 97:return n.registerH=n.registerC,4;case 98:return n.registerH=n.registerD,4;case 99:return n.registerH=n.registerE,4;case 100:return n.registerH=n.registerH,4;case 101:return n.registerH=n.registerL,4;case 102:return n.registerH=X(h(n.registerH,n.registerL)),4;case 103:return n.registerH=n.registerA,4;case 104:return n.registerL=n.registerB,4;case 105:return n.registerL=n.registerC,4;case 106:return n.registerL=n.registerD,4;
case 107:return n.registerL=n.registerE,4;case 108:return n.registerL=n.registerH,4;case 109:return n.registerL=n.registerL,4;case 110:return n.registerL=X(h(n.registerH,n.registerL)),4;case 111:return n.registerL=n.registerA,4}return-1}
function qb(a){switch(a){case 112:return Y(h(n.registerH,n.registerL),n.registerB),4;case 113:return Y(h(n.registerH,n.registerL),n.registerC),4;case 114:return Y(h(n.registerH,n.registerL),n.registerD),4;case 115:return Y(h(n.registerH,n.registerL),n.registerE),4;case 116:return Y(h(n.registerH,n.registerL),n.registerH),4;case 117:return Y(h(n.registerH,n.registerL),n.registerL),4;case 118:return V.isHblankHdmaActive||n.enableHalt(),4;case 119:return Y(h(n.registerH,n.registerL),n.registerA),4;case 120:return n.registerA=
n.registerB,4;case 121:return n.registerA=n.registerC,4;case 122:return n.registerA=n.registerD,4;case 123:return n.registerA=n.registerE,4;case 124:return n.registerA=n.registerH,4;case 125:return n.registerA=n.registerL,4;case 126:return n.registerA=X(h(n.registerH,n.registerL)),4;case 127:return 4}return-1}
function rb(a){switch(a){case 128:return Ya(n.registerB),4;case 129:return Ya(n.registerC),4;case 130:return Ya(n.registerD),4;case 131:return Ya(n.registerE),4;case 132:return Ya(n.registerH),4;case 133:return Ya(n.registerL),4;case 134:return a=X(h(n.registerH,n.registerL)),Ya(a),4;case 135:return Ya(n.registerA),4;case 136:return Za(n.registerB),4;case 137:return Za(n.registerC),4;case 138:return Za(n.registerD),4;case 139:return Za(n.registerE),4;case 140:return Za(n.registerH),4;case 141:return Za(n.registerL),
4;case 142:return a=X(h(n.registerH,n.registerL)),Za(a),4;case 143:return Za(n.registerA),4}return-1}
function sb(a){switch(a){case 144:return $a(n.registerB),4;case 145:return $a(n.registerC),4;case 146:return $a(n.registerD),4;case 147:return $a(n.registerE),4;case 148:return $a(n.registerH),4;case 149:return $a(n.registerL),4;case 150:return a=X(h(n.registerH,n.registerL)),$a(a),4;case 151:return $a(n.registerA),4;case 152:return ab(n.registerB),4;case 153:return ab(n.registerC),4;case 154:return ab(n.registerD),4;case 155:return ab(n.registerE),4;case 156:return ab(n.registerH),4;case 157:return ab(n.registerL),
4;case 158:return a=X(h(n.registerH,n.registerL)),ab(a),4;case 159:return ab(n.registerA),4}return-1}
function ub(a){switch(a){case 160:return bb(n.registerB),4;case 161:return bb(n.registerC),4;case 162:return bb(n.registerD),4;case 163:return bb(n.registerE),4;case 164:return bb(n.registerH),4;case 165:return bb(n.registerL),4;case 166:return a=X(h(n.registerH,n.registerL)),bb(a),4;case 167:return bb(n.registerA),4;case 168:return cb(n.registerB),4;case 169:return cb(n.registerC),4;case 170:return cb(n.registerD),4;case 171:return cb(n.registerE),4;case 172:return cb(n.registerH),4;case 173:return cb(n.registerL),
4;case 174:return a=X(h(n.registerH,n.registerL)),cb(a),4;case 175:return cb(n.registerA),4}return-1}
function vb(a){switch(a){case 176:return db(n.registerB),4;case 177:return db(n.registerC),4;case 178:return db(n.registerD),4;case 179:return db(n.registerE),4;case 180:return db(n.registerH),4;case 181:return db(n.registerL),4;case 182:return a=X(h(n.registerH,n.registerL)),db(a),4;case 183:return db(n.registerA),4;case 184:return eb(n.registerB),4;case 185:return eb(n.registerC),4;case 186:return eb(n.registerD),4;case 187:return eb(n.registerE),4;case 188:return eb(n.registerH),4;case 189:return eb(n.registerL),
4;case 190:return a=X(h(n.registerH,n.registerL)),eb(a),4;case 191:return eb(n.registerA),4}return-1}
function wb(a){switch(a){case 192:return 0===da()?(n.programCounter=Bb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,12):8;case 193:return a=Bb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,n.registerB=k(a),n.registerC=a&255,4;case 194:if(0===da())return n.programCounter=Db(),8;n.programCounter=n.programCounter+2&65535;return 12;case 195:return n.programCounter=Db(),8;case 196:if(0===da())return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter+2&65535),n.programCounter=
Db(),8;n.programCounter=n.programCounter+2&65535;return 12;case 197:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,h(n.registerB,n.registerC)),8;case 198:return Ya(Z()),n.programCounter=n.programCounter+1&65535,4;case 199:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter),n.programCounter=0,8;case 200:return 1===da()?(n.programCounter=Bb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,12):8;case 201:return n.programCounter=Bb(n.stackPointer),n.stackPointer=
n.stackPointer+2&65535,8;case 202:if(1===da())return n.programCounter=Db(),8;n.programCounter=n.programCounter+2&65535;return 12;case 203:var c=Z();a=-1;var d=!1,e=0,g=0,p=c%8;switch(p){case 0:e=n.registerB;break;case 1:e=n.registerC;break;case 2:e=n.registerD;break;case 3:e=n.registerE;break;case 4:e=n.registerH;break;case 5:e=n.registerL;break;case 6:e=X(h(n.registerH,n.registerL));break;case 7:e=n.registerA}var D=(c&240)>>4;switch(D){case 0:7>=c?(c=e,128===(c&128)?u(1):u(0),c=(c<<1|c>>7)&255,0===
c?q(1):q(0),r(0),t(0),g=c,d=!0):15>=c&&(c=e,0<(c&1)?u(1):u(0),c=(c>>1|c<<7)&255,0===c?q(1):q(0),r(0),t(0),g=c,d=!0);break;case 1:23>=c?(c=e,d=!1,128===(c&128)&&(d=!0),c=(c<<1|ea())&255,d?u(1):u(0),0===c?q(1):q(0),r(0),t(0),g=c,d=!0):31>=c&&(c=e,d=!1,1===(c&1)&&(d=!0),c=(c>>1|ea()<<7)&255,d?u(1):u(0),0===c?q(1):q(0),r(0),t(0),g=c,d=!0);break;case 2:39>=c?(c=e,d=!1,128===(c&128)&&(d=!0),c=c<<1&255,d?u(1):u(0),0===c?q(1):q(0),r(0),t(0),g=c,d=!0):47>=c&&(c=e,d=!1,128===(c&128)&&(d=!0),e=!1,1===(c&1)&&
(e=!0),c=c>>1&255,d&&(c|=128),0===c?q(1):q(0),r(0),t(0),e?u(1):u(0),g=c,d=!0);break;case 3:55>=c?(c=e,c=((c&15)<<4|(c&240)>>4)&255,0===c?q(1):q(0),r(0),t(0),u(0),g=c,d=!0):63>=c&&(c=e,d=!1,1===(c&1)&&(d=!0),c=c>>1&255,0===c?q(1):q(0),r(0),t(0),d?u(1):u(0),g=c,d=!0);break;case 4:71>=c?(g=fb(0,e),d=!0):79>=c&&(g=fb(1,e),d=!0);break;case 5:87>=c?(g=fb(2,e),d=!0):95>=c&&(g=fb(3,e),d=!0);break;case 6:103>=c?(g=fb(4,e),d=!0):111>=c&&(g=fb(5,e),d=!0);break;case 7:119>=c?(g=fb(6,e),d=!0):127>=c&&(g=fb(7,
e),d=!0);break;case 8:135>=c?(g=gb(0,0,e),d=!0):143>=c&&(g=gb(1,0,e),d=!0);break;case 9:151>=c?(g=gb(2,0,e),d=!0):159>=c&&(g=gb(3,0,e),d=!0);break;case 10:167>=c?(g=gb(4,0,e),d=!0):175>=c&&(g=gb(5,0,e),d=!0);break;case 11:183>=c?(g=gb(6,0,e),d=!0):191>=c&&(g=gb(7,0,e),d=!0);break;case 12:199>=c?(g=gb(0,1,e),d=!0):207>=c&&(g=gb(1,1,e),d=!0);break;case 13:215>=c?(g=gb(2,1,e),d=!0):223>=c&&(g=gb(3,1,e),d=!0);break;case 14:231>=c?(g=gb(4,1,e),d=!0):239>=c&&(g=gb(5,1,e),d=!0);break;case 15:247>=c?(g=gb(6,
1,e),d=!0):255>=c&&(g=gb(7,1,e),d=!0)}switch(p){case 0:n.registerB=g;break;case 1:n.registerC=g;break;case 2:n.registerD=g;break;case 3:n.registerE=g;break;case 4:n.registerH=g;break;case 5:n.registerL=g;break;case 6:(4>D||7<D)&&Y(h(n.registerH,n.registerL),g);break;case 7:n.registerA=g}d&&(a=4);n.programCounter=n.programCounter+1&65535;return a;case 204:if(1===da())return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter+2),n.programCounter=Db(),8;n.programCounter=n.programCounter+
2&65535;return 12;case 205:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter+2&65535),n.programCounter=Db(),8;case 206:return Za(Z()),n.programCounter=n.programCounter+1&65535,4;case 207:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter),n.programCounter=8}return-1}
function xb(a){switch(a){case 208:return 0===ea()?(n.programCounter=Bb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,12):8;case 209:return a=Bb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,n.registerD=k(a),n.registerE=a&255,4;case 210:if(0===ea())return n.programCounter=Db(),8;n.programCounter=n.programCounter+2&65535;return 12;case 212:if(0===ea())return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter+2),n.programCounter=Db(),8;n.programCounter=n.programCounter+
2&65535;return 12;case 213:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,h(n.registerD,n.registerE)),8;case 214:return $a(Z()),n.programCounter=n.programCounter+1&65535,4;case 215:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter),n.programCounter=16,8;case 216:return 1===ea()?(n.programCounter=Bb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,12):8;case 217:return n.programCounter=Bb(n.stackPointer),Fa(!0),n.stackPointer=n.stackPointer+2&65535,
8;case 218:if(1===ea())return n.programCounter=Db(),8;n.programCounter=n.programCounter+2&65535;return 12;case 220:if(1===ea())return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter+2&65535),n.programCounter=Db(),8;n.programCounter=n.programCounter+2&65535;return 12;case 222:return ab(Z()),n.programCounter=n.programCounter+1&65535,4;case 223:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter),n.programCounter=24,8}return-1}
function yb(a){switch(a){case 224:return a=Z(),Y(65280+a,n.registerA),n.programCounter=n.programCounter+1&65535,4;case 225:return a=Bb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,n.registerH=k(a),n.registerL=a&255,4;case 226:return Y(65280+n.registerC,n.registerA),4;case 229:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,h(n.registerH,n.registerL)),8;case 230:return bb(Z()),n.programCounter=n.programCounter+1&65535,4;case 231:return n.stackPointer=n.stackPointer-2&65535,
Cb(n.stackPointer,n.programCounter),n.programCounter=32,8;case 232:return a=ba(Z()),ha(n.stackPointer,a,!0),n.stackPointer=n.stackPointer+a&65535,q(0),r(0),n.programCounter=n.programCounter+1&65535,12;case 233:return n.programCounter=h(n.registerH,n.registerL),4;case 234:return Y(Db(),n.registerA),n.programCounter=n.programCounter+2&65535,4;case 238:return cb(Z()),n.programCounter=n.programCounter+1&65535,4;case 239:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter),
n.programCounter=40,8}return-1}
function zb(a){switch(a){case 240:return a=Z(),n.registerA=X(65280+a)&255,n.programCounter=n.programCounter+1&65535,4;case 241:return a=Bb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,n.registerA=k(a),n.registerF=a&255,4;case 242:return n.registerA=X(65280+n.registerC)&255,4;case 243:return Fa(!1),4;case 245:return n.stackPointer=n.stackPointer-2&65535,Cb(n.stackPointer,h(n.registerA,n.registerF)),8;case 246:return db(Z()),n.programCounter=n.programCounter+1&65535,4;case 247:return n.stackPointer=
n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter),n.programCounter=48,8;case 248:return a=ba(Z()),q(0),r(0),ha(n.stackPointer,a,!0),a=n.stackPointer+a&65535,n.registerH=k(a),n.registerL=a&255,n.programCounter=n.programCounter+1&65535,8;case 249:return n.stackPointer=h(n.registerH,n.registerL),8;case 250:return n.registerA=X(Db()),n.programCounter=n.programCounter+2&65535,4;case 251:return Fa(!0),4;case 254:return eb(Z()),n.programCounter=n.programCounter+1&65535,4;case 255:return n.stackPointer=
n.stackPointer-2&65535,Cb(n.stackPointer,n.programCounter),n.programCounter=56,8}return-1}var Eb=function(){function a(){}a.cyclesPerCycleSet=2E9;a.cycleSets=0;a.cycles=0;return a}();
function Ab(a){0<V.DMACycles&&(a+=V.DMACycles,V.DMACycles=0);n.currentCycles+=a;if(!n.isStopped){if(f.graphicsBatchProcessing){if(B.currentCycles+=a,!(B.currentCycles<B.batchProcessCycles()))for(;B.currentCycles>=B.batchProcessCycles();)Va(B.batchProcessCycles()),B.currentCycles-=B.batchProcessCycles()}else Va(a);f.audioBatchProcessing?P.currentCycles+=a:Aa(a)}f.timersBatchProcessing?(R.currentCycles+=a,Ka(R.currentCycles),R.currentCycles=0):Ka(a);Eb.cycles+=a;Eb.cycles>=Eb.cyclesPerCycleSet&&(Eb.cycleSets+=
1,Eb.cycles-=Eb.cyclesPerCycleSet)}var Fb=function(){function a(){}a.stepsPerStepSet=2E9;a.stepSets=0;a.steps=0;return a}();function Gb(){return Hb(!0,-1,-1)}
function Hb(a,c,d){void 0===c&&(c=-1);void 0===d&&(d=-1);a=1024;0<c?a=c:0>c&&(a=-1);for(var e=!1,g=!1,p=!1,D=!1;!(e||g||p||D);)c=Ib(),0>c?e=!0:n.currentCycles>=n.MAX_CYCLES_PER_FRAME()?g=!0:-1<a&&Ca()>=a?p=!0:-1<d&&n.programCounter===d&&(D=!0);if(g)return n.currentCycles-=n.MAX_CYCLES_PER_FRAME(),0;if(p)return 1;if(D)return 2;n.programCounter=n.programCounter-1&65535;return-1}
function Ib(){Jb=!0;if(n.isHaltBug){var a=A(n.programCounter);a=ib(a);Ab(a);n.exitHaltAndStop()}Q.masterInterruptSwitchDelay&&(Q.masterInterruptSwitch=!0,Q.masterInterruptSwitchDelay=!1);if(0<(Q.interruptsEnabledValue&Q.interruptsRequestedValue&31)){a=!1;Q.masterInterruptSwitch&&!n.isHaltNoJump&&(Q.isVBlankInterruptEnabled&&Q.isVBlankInterruptRequested?(Ea(Q.bitPositionVBlankInterrupt),a=!0):Q.isLcdInterruptEnabled&&Q.isLcdInterruptRequested?(Ea(Q.bitPositionLcdInterrupt),a=!0):Q.isTimerInterruptEnabled&&
Q.isTimerInterruptRequested?(Ea(Q.bitPositionTimerInterrupt),a=!0):Q.isJoypadInterruptEnabled&&Q.isJoypadInterruptRequested&&(Ea(Q.bitPositionJoypadInterrupt),a=!0));var c=0;a&&(c=20,n.isHalted()&&(n.exitHaltAndStop(),c+=4));n.isHalted()&&n.exitHaltAndStop();a=c}else a=0;0<a&&Ab(a);a=4;n.isHalted()||n.isStopped||(a=A(n.programCounter),a=ib(a));n.registerF&=240;if(0>=a)return a;Ab(a);Fb.steps+=1;Fb.steps>=Fb.stepsPerStepSet&&(Fb.stepSets+=1,Fb.steps-=Fb.stepsPerStepSet);return a}
139>aa.size()&&aa.grow(139-aa.size());
var Jb=!1,Kb=Object.freeze({memory:aa,config:function(a,c,d,e,g,p,D,v,I){f.enableBootRom=0<a?!0:!1;f.useGbcWhenAvailable=0<c?!0:!1;f.audioBatchProcessing=0<d?!0:!1;f.graphicsBatchProcessing=0<e?!0:!1;f.timersBatchProcessing=0<g?!0:!1;f.graphicsDisableScanlineRendering=0<p?!0:!1;f.audioAccumulateSamples=0<D?!0:!1;f.tileRendering=0<v?!0:!1;f.tileCaching=0<I?!0:!1;a=A(323);n.GBCEnabled=192===a||f.useGbcWhenAvailable&&128===a?!0:!1;n.GBCDoubleSpeed=!1;n.registerA=0;n.registerB=0;n.registerC=0;n.registerD=
0;n.registerE=0;n.registerH=0;n.registerL=0;n.registerF=0;n.stackPointer=0;n.programCounter=0;n.currentCycles=0;n.isHaltNormal=!1;n.isHaltNoJump=!1;n.isHaltBug=!1;n.isStopped=!1;n.GBCEnabled?(n.registerA=17,n.registerF=128,n.registerB=0,n.registerC=0,n.registerD=255,n.registerE=86,n.registerH=0,n.registerL=13):(n.registerA=1,n.registerF=176,n.registerB=0,n.registerC=19,n.registerD=0,n.registerE=216,n.registerH=1,n.registerL=77);n.programCounter=256;n.stackPointer=65534;V.isRamBankingEnabled=!1;V.isMBC1RomModeEnabled=
!0;a=A(327);V.isRomOnly=!1;V.isMBC1=!1;V.isMBC2=!1;V.isMBC3=!1;V.isMBC5=!1;0===a?V.isRomOnly=!0:1<=a&&3>=a?V.isMBC1=!0:5<=a&&6>=a?V.isMBC2=!0:15<=a&&19>=a?V.isMBC3=!0:25<=a&&30>=a&&(V.isMBC5=!0);V.currentRomBank=1;V.currentRamBank=0;F(65361,255);F(65362,255);F(65363,255);F(65364,255);F(65365,255);B.currentCycles=0;B.scanlineCycleCounter=0;B.scanlineRegister=0;B.scrollX=0;B.scrollY=0;B.windowX=0;B.windowY=0;n.GBCEnabled?(B.scanlineRegister=144,F(65344,145),F(65345,129),F(65348,144),F(65351,252)):(B.scanlineRegister=
144,F(65344,145),F(65345,133),F(65350,255),F(65351,252),F(65352,255),F(65353,255));F(65359,0);F(65392,1);n.GBCEnabled?(F(65384,192),F(65385,255),F(65386,193),F(65387,13)):(F(65384,255),F(65385,255),F(65386,255),F(65387,255));P.currentCycles=0;P.NR50LeftMixerVolume=0;P.NR50RightMixerVolume=0;P.NR51IsChannel1EnabledOnLeftOutput=!0;P.NR51IsChannel2EnabledOnLeftOutput=!0;P.NR51IsChannel3EnabledOnLeftOutput=!0;P.NR51IsChannel4EnabledOnLeftOutput=!0;P.NR51IsChannel1EnabledOnRightOutput=!0;P.NR51IsChannel2EnabledOnRightOutput=
!0;P.NR51IsChannel3EnabledOnRightOutput=!0;P.NR51IsChannel4EnabledOnRightOutput=!0;P.NR52IsSoundEnabled=!0;P.frameSequenceCycleCounter=0;P.downSampleCycleCounter=0;P.frameSequencer=0;P.audioQueueIndex=0;G.initialize();H.initialize();L.initialize();M.initialize();F(P.memoryLocationNR50,119);F(P.memoryLocationNR51,243);F(P.memoryLocationNR52,241);O.channel1Sample=15;O.channel2Sample=15;O.channel3Sample=15;O.channel4Sample=15;O.channel1DacEnabled=!1;O.channel2DacEnabled=!1;O.channel3DacEnabled=!1;O.channel4DacEnabled=
!1;O.leftChannelSampleUnsignedByte=127;O.rightChannelSampleUnsignedByte=127;O.mixerVolumeChanged=!0;O.mixerEnabledChanged=!0;O.needToRemixSamples=!1;Q.updateInterruptEnabled(0);F(Q.memoryLocationInterruptEnabled,Q.interruptsEnabledValue);Q.updateInterruptRequested(225);F(Q.memoryLocationInterruptRequest,Q.interruptsRequestedValue);R.currentCycles=0;R.dividerRegister=0;R.timerCounter=0;R.timerModulo=0;R.timerEnabled=!1;R.timerInputClock=0;R.timerCounterOverflowDelay=!1;R.timerCounterWasReset=!1;n.GBCEnabled?
(F(65284,30),R.dividerRegister=7840):(F(65284,171),R.dividerRegister=43980);F(65287,248);R.timerInputClock=248;n.GBCEnabled?(F(65392,248),F(65359,254),F(65357,126),F(65280,207),F(65282,124),F(65295,225),F(65388,254),F(65397,143)):(F(65392,255),F(65359,255),F(65357,255),F(65280,207),F(65282,126),F(65295,225));Jb=!1;Eb.cyclesPerCycleSet=2E9;Eb.cycleSets=0;Eb.cycles=0;Fb.stepsPerStepSet=2E9;Fb.stepSets=0;Fb.steps=0},hasCoreStarted:function(){return Jb?1:0},saveState:function(){n.saveState();B.saveState();
Q.saveState();S.saveState();V.saveState();R.saveState();P.saveState();G.saveState();H.saveState();L.saveState();M.saveState();Jb=!1},loadState:function(){n.loadState();B.loadState();Q.loadState();S.loadState();V.loadState();R.loadState();P.loadState();G.loadState();H.loadState();L.loadState();M.loadState();Jb=!1;Eb.cyclesPerCycleSet=2E9;Eb.cycleSets=0;Eb.cycles=0;Fb.stepsPerStepSet=2E9;Fb.stepSets=0;Fb.steps=0},getStepsPerStepSet:function(){return Fb.stepsPerStepSet},getStepSets:function(){return Fb.stepSets},
getSteps:function(){return Fb.steps},executeMultipleFrames:function(a){for(var c=0,d=0;d<a&&0<=c;)c=Gb(),d+=1;return 0>c?c:0},executeFrame:Gb,executeFrameAndCheckAudio:function(a){void 0===a&&(a=0);return Hb(!0,a,-1)},executeFrameUntilBreakpoint:function(a){a=Hb(!0,-1,a);return 2===a?1:a},executeUntilCondition:Hb,executeStep:Ib,getCyclesPerCycleSet:function(){return Eb.cyclesPerCycleSet},getCycleSets:function(){return Eb.cycleSets},getCycles:function(){return Eb.cycles},setJoypadState:function(a,
c,d,e,g,p,D,v){0<a?La(0):Na(0,!1);0<c?La(1):Na(1,!1);0<d?La(2):Na(2,!1);0<e?La(3):Na(3,!1);0<g?La(4):Na(4,!1);0<p?La(5):Na(5,!1);0<D?La(6):Na(6,!1);0<v?La(7):Na(7,!1)},getNumberOfSamplesInAudioBuffer:Ca,clearAudioBuffer:wa,WASMBOY_MEMORY_LOCATION:0,WASMBOY_MEMORY_SIZE:9109504,WASMBOY_WASM_PAGES:139,ASSEMBLYSCRIPT_MEMORY_LOCATION:0,ASSEMBLYSCRIPT_MEMORY_SIZE:1024,WASMBOY_STATE_LOCATION:1024,WASMBOY_STATE_SIZE:1024,GAMEBOY_INTERNAL_MEMORY_LOCATION:2048,GAMEBOY_INTERNAL_MEMORY_SIZE:65535,VIDEO_RAM_LOCATION:2048,
VIDEO_RAM_SIZE:16384,WORK_RAM_LOCATION:18432,WORK_RAM_SIZE:32768,OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION:51200,OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE:16384,GRAPHICS_OUTPUT_LOCATION:67584,GRAPHICS_OUTPUT_SIZE:521216,GBC_PALETTE_LOCATION:67584,GBC_PALETTE_SIZE:512,BG_PRIORITY_MAP_LOCATION:69632,BG_PRIORITY_MAP_SIZE:23552,FRAME_LOCATION:93184,FRAME_SIZE:93184,BACKGROUND_MAP_LOCATION:232448,BACKGROUND_MAP_SIZE:196608,TILE_DATA_LOCATION:429056,TILE_DATA_SIZE:147456,OAM_TILES_LOCATION:576512,OAM_TILES_SIZE:12288,
AUDIO_BUFFER_LOCATION:588800,AUDIO_BUFFER_SIZE:131072,CARTRIDGE_RAM_LOCATION:719872,CARTRIDGE_RAM_SIZE:131072,CARTRIDGE_ROM_LOCATION:850944,CARTRIDGE_ROM_SIZE:8258560,getWasmBoyOffsetFromGameBoyOffset:Sa,getRegisterA:function(){return n.registerA},getRegisterB:function(){return n.registerB},getRegisterC:function(){return n.registerC},getRegisterD:function(){return n.registerD},getRegisterE:function(){return n.registerE},getRegisterH:function(){return n.registerH},getRegisterL:function(){return n.registerL},
getRegisterF:function(){return n.registerF},getProgramCounter:function(){return n.programCounter},getStackPointer:function(){return n.stackPointer},getOpcodeAtProgramCounter:function(){return A(n.programCounter)},getLY:function(){return B.scanlineRegister},drawBackgroundMapToWasmMemory:function(a){void 0===a&&(a=0);var c=B.memoryLocationTileDataSelectZeroStart;W.bgWindowTileDataSelect&&(c=B.memoryLocationTileDataSelectOneStart);var d=B.memoryLocationTileMapSelectZeroStart;W.bgTileMapDisplaySelect&&
(d=B.memoryLocationTileMapSelectOneStart);for(var e=0;256>e;e++)for(var g=0;256>g;g++){var p=e,D=g,v=d+32*(p>>3)+(D>>3),I=ra(v,0);I=qa(c,I);var w=p%8;p=D%8;p=7-p;D=0;n.GBCEnabled&&0<a&&(D=ra(v,1));m(6,D)&&(w=7-w);var J=0;m(3,D)&&(J=1);v=ra(I+2*w,J);I=ra(I+2*w+1,J);w=0;m(p,I)&&(w+=1,w<<=1);m(p,v)&&(w+=1);I=3*(256*e+g);if(n.GBCEnabled&&0<a)D=ka(D&7,w,!1),p=ma(0,D),v=ma(1,D),w=ma(2,D),D=232448+I,b[D]=p,b[D+1]=v,b[D+2]=w;else for(p=ja(w,B.memoryLocationBackgroundPalette),v=0;3>v;v++)D=232448+I+v,b[D]=
p}},drawTileDataToWasmMemory:function(){for(var a=0;23>a;a++)for(var c=0;31>c;c++){var d=0;15<c&&(d=1);var e=a;15<a&&(e-=15);e<<=4;e=15<c?e+(c-15):e+c;var g=B.memoryLocationTileDataSelectOneStart;15<a&&(g=B.memoryLocationTileDataSelectZeroStart);for(var p=0;8>p;p++)pa(e,g,d,0,7,p,8*c,8*a+p,248,429056,!0)}},getDIV:function(){return R.dividerRegister},getTIMA:function(){return R.timerCounter},getTMA:function(){return R.timerModulo},getTAC:function(){var a=R.timerInputClock;R.timerEnabled&&(a|=4);return a},
update:Gb,emulationStep:Ib,getAudioQueueIndex:Ca,resetAudioQueue:wa,wasmMemorySize:9109504,wasmBoyInternalStateLocation:1024,wasmBoyInternalStateSize:1024,gameBoyInternalMemoryLocation:2048,gameBoyInternalMemorySize:65535,videoOutputLocation:67584,frameInProgressVideoOutputLocation:93184,gameboyColorPaletteLocation:67584,gameboyColorPaletteSize:512,backgroundMapLocation:232448,tileDataMap:429056,soundOutputLocation:588800,gameBytesLocation:850944,gameRamBanksLocation:719872});
export default async()=>({instance:{exports:Kb},byteMemory:aa.wasmByteMemory,type:"TypeScript"});
