const b=new Uint8ClampedArray(9109504),aa={size:()=>9109504,grow:()=>{},wasmByteMemory:b};var ba=function(){function a(){}a.enableBootRom=!1;a.useGbcWhenAvailable=!0;a.audioBatchProcessing=!1;a.graphicsBatchProcessing=!1;a.timersBatchProcessing=!1;a.graphicsDisableScanlineRendering=!1;a.audioAccumulateSamples=!1;a.tileRendering=!1;a.tileCaching=!1;return a}();function f(a,c){return(a&255)<<8|c&255}function h(a){return(a&65280)>>8}function k(a,c){return c&~(1<<a)}
function l(a,c){return 0!=(c&1<<a)}function ca(a){var c=a;l(7,c)&&(c=-1*(256-a));return c}function da(a,c){a=1<<a&255;m.registerF=0<c?m.registerF|a:m.registerF&(255^a);return m.registerF}function p(a){da(7,a)}function q(a){da(6,a)}function r(a){da(5,a)}function t(a){da(4,a)}function ea(){return m.registerF>>7&1}function fa(){return m.registerF>>4&1}function u(a,c){0<=c?0!==((a&15)+(c&15)&16)?r(1):r(0):(Math.abs(c)&15)>(a&15)?r(1):r(0)}
function ha(a,c){0<=c?a>(a+c&255)?t(1):t(0):Math.abs(c)>a?t(1):t(0)}function ia(a,c,d){d?(a=a^c^a+c,0!==(a&16)?r(1):r(0),0!==(a&256)?t(1):t(0)):(d=a+c&65535,d<a?t(1):t(0),0!==((a^c^d)&4096)?r(1):r(0))}var ja=function(){function a(){}a.memoryLocationBackgroundPaletteIndex=65384;a.memoryLocationBackgroundPaletteData=65385;a.memoryLocationSpritePaletteIndex=65386;a.memoryLocationSpritePaletteData=65387;return a}();
function ka(a,c,d){void 0===d&&(d=!1);var e=a;d||(e=w(c)>>2*a&3);a=242;switch(e){case 1:a=160;break;case 2:a=88;break;case 3:a=8}return a}function la(a,c,d){c=8*a+2*c;a=ma(c+1,d);d=ma(c,d);return f(a,d)}function na(a,c){return 8*((c&31<<5*a)>>5*a)}function ma(a,c){a&=63;c&&(a+=64);return b[67584+a]}function oa(a,c,d,e){void 0===d&&(d=0);void 0===e&&(e=!1);d&=3;e&&(d|=4);b[69632+(160*c+a)]=d}var pa=function(){function a(){}a.tileId=-1;a.horizontalFlip=!1;a.nextXIndexToPerformCacheCheck=-1;return a}();
function qa(a,c,d,e,g,n,D,v,I,x,N,A,B){var V=0;c=ra(c,a);a=sa(c+2*n,d);d=sa(c+2*n+1,d);for(n=e;n<=g;n++)if(c=D+(n-e),c<I){var O=n;if(0>B||!l(5,B))O=7-O;var W=0;l(O,d)&&(W+=1,W<<=1);l(O,a)&&(W+=1);if(0<=B){var J=la(B&7,W,!1);O=na(0,J);var ya=na(1,J);J=na(2,J)}else 0>=A&&(A=y.memoryLocationBackgroundPalette),ya=O=J=ka(W,A,N);var za=3*(v*I+c);b[x+za]=O;b[x+za+1]=ya;b[x+za+2]=J;O=!1;0<=B&&(O=l(7,B));oa(c,v,W,O);V++}return V}
function ra(a,c){if(a===y.memoryLocationTileDataSelectZeroStart){var d=c+128;l(7,c)&&(d=c-128);return a+16*d}return a+16*c}function ta(a,c){switch(a){case 1:return l(c,129);case 2:return l(c,135);case 3:return l(c,126);default:return l(c,1)}}
var F=function(){function a(){}a.updateNRx0=function(c){a.NRx0SweepPeriod=(c&112)>>4;a.NRx0Negate=l(3,c);a.NRx0SweepShift=c&7};a.updateNRx1=function(c){a.NRx1Duty=c>>6&3;a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=l(3,c);a.NRx2EnvelopePeriod=c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=function(c){a.NRx4LengthEnabled=
l(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=function(){z(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.dutyCycle;b[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty;z(1049+50*a.saveStateSlot,a.isSweepEnabled);b[1050+50*a.saveStateSlot]=a.sweepCounter;b[1055+50*
a.saveStateSlot]=a.sweepShadowFrequency};a.loadState=function(){a.isEnabled=C(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];a.volume=b[1038+50*a.saveStateSlot];a.dutyCycle=b[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=b[1044+50*a.saveStateSlot];a.isSweepEnabled=C(1049+50*a.saveStateSlot);a.sweepCounter=b[1050+50*a.saveStateSlot];a.sweepShadowFrequency=b[1055+50*a.saveStateSlot]};a.initialize=
function(){E(a.memoryLocationNRx0,128);E(a.memoryLocationNRx1,191);E(a.memoryLocationNRx2,243);E(a.memoryLocationNRx3,193);E(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=4*(2048-a.frequency);m.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=c,a.waveFormPositionOnDuty+=
1,8<=a.waveFormPositionOnDuty&&(a.waveFormPositionOnDuty=0));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=1;ta(a.NRx1Duty,a.waveFormPositionOnDuty)||(d*=-1);return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.sweepShadowFrequency=a.frequency;a.sweepCounter=a.NRx0SweepPeriod;a.isSweepEnabled=0<a.NRx0SweepPeriod&&0<a.NRx0SweepShift?!0:!1;0<a.NRx0SweepShift&&
ua();a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.updateSweep=function(){--a.sweepCounter;0>=a.sweepCounter&&(a.sweepCounter=a.NRx0SweepPeriod,a.isSweepEnabled&&0<a.NRx0SweepPeriod&&ua())};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,
0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&0<a.volume&&--a.volume))};a.setFrequency=function(c){var d=c>>8;c&=255;var e=w(a.memoryLocationNRx4)&248|d;E(a.memoryLocationNRx3,c);E(a.memoryLocationNRx4,e);a.NRx3FrequencyLSB=c;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.memoryLocationNRx0=65296;a.NRx0SweepPeriod=0;a.NRx0Negate=!1;a.NRx0SweepShift=0;a.memoryLocationNRx1=65297;a.NRx1Duty=0;a.NRx1LengthLoad=
0;a.memoryLocationNRx2=65298;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65299;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65300;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=1;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.isSweepEnabled=!1;a.sweepCounter=0;a.sweepShadowFrequency=0;a.saveStateSlot=7;return a}();
function ua(){var a=va();2047>=a&&0<F.NRx0SweepShift&&(F.sweepShadowFrequency=a,F.setFrequency(a),a=va());2047<a&&(F.isEnabled=!1)}function va(){var a=F.sweepShadowFrequency;a>>=F.NRx0SweepShift;return a=F.NRx0Negate?F.sweepShadowFrequency-a:F.sweepShadowFrequency+a}
var G=function(){function a(){}a.updateNRx1=function(c){a.NRx1Duty=c>>6&3;a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=l(3,c);a.NRx2EnvelopePeriod=c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=function(c){a.NRx4LengthEnabled=l(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=
function(){z(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.dutyCycle;b[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty};a.loadState=function(){a.isEnabled=C(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];
a.volume=b[1038+50*a.saveStateSlot];a.dutyCycle=b[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=b[1044+50*a.saveStateSlot]};a.initialize=function(){E(a.memoryLocationNRx1-1,255);E(a.memoryLocationNRx1,63);E(a.memoryLocationNRx2,0);E(a.memoryLocationNRx3,0);E(a.memoryLocationNRx4,184)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=4*(2048-a.frequency);m.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=
function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=c,a.waveFormPositionOnDuty+=1,8<=a.waveFormPositionOnDuty&&(a.waveFormPositionOnDuty=0));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=1;ta(a.NRx1Duty,a.waveFormPositionOnDuty)||(d*=-1);return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.isDacEnabled||
(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&0<a.volume&&--a.volume))};a.setFrequency=function(c){var d=
c>>8;c&=255;var e=w(a.memoryLocationNRx4)&248|d;E(a.memoryLocationNRx3,c);E(a.memoryLocationNRx4,e);a.NRx3FrequencyLSB=c;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.memoryLocationNRx1=65302;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65303;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65304;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65305;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=
2;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.saveStateSlot=8;return a}(),H=function(){function a(){}a.updateNRx0=function(c){a.isDacEnabled=l(7,c)};a.updateNRx1=function(c){a.NRx1LengthLoad=c;a.lengthCounter=256-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2VolumeCode=c>>5&15};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=
function(c){a.NRx4LengthEnabled=l(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=function(){z(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.lengthCounter;b[1033+50*a.saveStateSlot]=a.waveTablePosition};a.loadState=function(){a.isEnabled=C(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.lengthCounter=b[1029+50*a.saveStateSlot];a.waveTablePosition=b[1033+50*a.saveStateSlot]};
a.initialize=function(){E(a.memoryLocationNRx0,127);E(a.memoryLocationNRx1,255);E(a.memoryLocationNRx2,159);E(a.memoryLocationNRx3,0);E(a.memoryLocationNRx4,184);a.volumeCodeChanged=!0};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=2*(2048-a.frequency);m.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=
c,a.waveTablePosition+=1,32<=a.waveTablePosition&&(a.waveTablePosition=0));c=0;var d=a.volumeCode;if(a.isEnabled&&a.isDacEnabled)a.volumeCodeChanged&&(d=w(a.memoryLocationNRx2),d=d>>5&15,a.volumeCode=d,a.volumeCodeChanged=!1);else return 15;var e=w(a.memoryLocationWaveTable+(a.waveTablePosition/2|0));e=0===a.waveTablePosition%2?e>>4&15:e&15;switch(d){case 0:e>>=4;break;case 1:c=1;break;case 2:e>>=1;c=2;break;default:e>>=2,c=4}return(0<c?e/c:0)+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&
(a.lengthCounter=256);a.resetTimer();a.waveTablePosition=0;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter&&!a.volumeCodeChanged?!1:!0};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.cycleCounter=0;a.memoryLocationNRx0=65306;a.memoryLocationNRx1=65307;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65308;a.NRx2VolumeCode=0;a.memoryLocationNRx3=65309;a.NRx3FrequencyLSB=
0;a.memoryLocationNRx4=65310;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.memoryLocationWaveTable=65328;a.channelNumber=3;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.lengthCounter=0;a.waveTablePosition=0;a.volumeCode=0;a.volumeCodeChanged=!1;a.saveStateSlot=9;return a}(),K=function(){function a(){}a.updateNRx1=function(c){a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=l(3,c);a.NRx2EnvelopePeriod=
c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3ClockShift=c>>4;a.NRx3WidthMode=l(3,c);a.NRx3DivisorCode=c&7;switch(a.NRx3DivisorCode){case 0:a.divisor=8;break;case 1:a.divisor=16;break;case 2:a.divisor=32;break;case 3:a.divisor=48;break;case 4:a.divisor=64;break;case 5:a.divisor=80;break;case 6:a.divisor=96;break;case 7:a.divisor=112}};a.updateNRx4=function(c){a.NRx4LengthEnabled=l(6,c)};a.saveState=function(){z(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;
b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.linearFeedbackShiftRegister};a.loadState=function(){a.isEnabled=C(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];a.volume=b[1038+50*a.saveStateSlot];a.linearFeedbackShiftRegister=b[1043+50*a.saveStateSlot]};a.initialize=function(){E(a.memoryLocationNRx1-
1,255);E(a.memoryLocationNRx1,255);E(a.memoryLocationNRx2,0);E(a.memoryLocationNRx3,0);E(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.frequencyTimer=a.getNoiseChannelFrequencyPeriod(),a.frequencyTimer-=c,c=a.linearFeedbackShiftRegister&1^a.linearFeedbackShiftRegister>>1&1,a.linearFeedbackShiftRegister>>=1,a.linearFeedbackShiftRegister|=
c<<14,a.NRx3WidthMode&&(a.linearFeedbackShiftRegister&=-65,a.linearFeedbackShiftRegister|=c<<6));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=l(0,a.linearFeedbackShiftRegister)?-1:1;return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.frequencyTimer=a.getNoiseChannelFrequencyPeriod();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.linearFeedbackShiftRegister=32767;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=
function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.getNoiseChannelFrequencyPeriod=function(){var c=a.divisor<<a.NRx3ClockShift;m.GBCDoubleSpeed&&(c*=2);return c};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&
0<a.volume&&--a.volume))};a.cycleCounter=0;a.memoryLocationNRx1=65312;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65313;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65314;a.NRx3ClockShift=0;a.NRx3WidthMode=!1;a.NRx3DivisorCode=0;a.memoryLocationNRx4=65315;a.NRx4LengthEnabled=!1;a.channelNumber=4;a.isEnabled=!1;a.isDacEnabled=!1;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.divisor=0;a.linearFeedbackShiftRegister=0;a.saveStateSlot=
10;return a}(),L=function(){function a(){}a.channel1Sample=15;a.channel2Sample=15;a.channel3Sample=15;a.channel4Sample=15;a.channel1DacEnabled=!1;a.channel2DacEnabled=!1;a.channel3DacEnabled=!1;a.channel4DacEnabled=!1;a.leftChannelSampleUnsignedByte=127;a.rightChannelSampleUnsignedByte=127;a.mixerVolumeChanged=!1;a.mixerEnabledChanged=!1;a.needToRemixSamples=!1;return a}();
function wa(a){switch(a){case F.channelNumber:if(L.channel1DacEnabled!==F.isDacEnabled)return L.channel1DacEnabled=F.isDacEnabled,!0;break;case G.channelNumber:if(L.channel2DacEnabled!==G.isDacEnabled)return L.channel2DacEnabled=G.isDacEnabled,!0;break;case H.channelNumber:if(L.channel3DacEnabled!==H.isDacEnabled)return L.channel3DacEnabled=H.isDacEnabled,!0;break;case K.channelNumber:if(L.channel4DacEnabled!==K.isDacEnabled)return L.channel4DacEnabled=K.isDacEnabled,!0}return!1}
var M=function(){function a(){}a.batchProcessCycles=function(){return m.GBCDoubleSpeed?174:87};a.updateNR50=function(c){a.NR50LeftMixerVolume=c>>4&7;a.NR50RightMixerVolume=c&7};a.updateNR51=function(c){a.NR51IsChannel4EnabledOnLeftOutput=l(7,c);a.NR51IsChannel3EnabledOnLeftOutput=l(6,c);a.NR51IsChannel2EnabledOnLeftOutput=l(5,c);a.NR51IsChannel1EnabledOnLeftOutput=l(4,c);a.NR51IsChannel4EnabledOnRightOutput=l(3,c);a.NR51IsChannel3EnabledOnRightOutput=l(2,c);a.NR51IsChannel2EnabledOnRightOutput=l(1,
c);a.NR51IsChannel1EnabledOnRightOutput=l(0,c)};a.updateNR52=function(c){a.NR52IsSoundEnabled=l(7,c)};a.maxFrameSequenceCycles=function(){return m.GBCDoubleSpeed?16384:8192};a.maxDownSampleCycles=function(){return m.CLOCK_SPEED()};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.frameSequenceCycleCounter;b[1028+50*a.saveStateSlot]=a.downSampleCycleCounter;b[1029+50*a.saveStateSlot]=a.frameSequencer};a.loadState=function(){a.frameSequenceCycleCounter=b[1024+50*a.saveStateSlot];a.downSampleCycleCounter=
b[1028+50*a.saveStateSlot];a.frameSequencer=b[1029+50*a.saveStateSlot];xa()};a.currentCycles=0;a.memoryLocationNR50=65316;a.NR50LeftMixerVolume=0;a.NR50RightMixerVolume=0;a.memoryLocationNR51=65317;a.NR51IsChannel1EnabledOnLeftOutput=!0;a.NR51IsChannel2EnabledOnLeftOutput=!0;a.NR51IsChannel3EnabledOnLeftOutput=!0;a.NR51IsChannel4EnabledOnLeftOutput=!0;a.NR51IsChannel1EnabledOnRightOutput=!0;a.NR51IsChannel2EnabledOnRightOutput=!0;a.NR51IsChannel3EnabledOnRightOutput=!0;a.NR51IsChannel4EnabledOnRightOutput=
!0;a.memoryLocationNR52=65318;a.NR52IsSoundEnabled=!0;a.memoryLocationChannel3LoadRegisterStart=65328;a.frameSequenceCycleCounter=0;a.downSampleCycleCounter=0;a.downSampleCycleMultiplier=48E3;a.frameSequencer=0;a.audioQueueIndex=0;a.wasmBoyMemoryMaxBufferSize=131072;a.saveStateSlot=6;return a}();function Aa(){if(!(M.currentCycles<M.batchProcessCycles()))for(;M.currentCycles>=M.batchProcessCycles();)Ba(M.batchProcessCycles()),M.currentCycles-=M.batchProcessCycles()}
function Ba(a){M.frameSequenceCycleCounter+=a;if(M.frameSequenceCycleCounter>=M.maxFrameSequenceCycles()){M.frameSequenceCycleCounter-=M.maxFrameSequenceCycles();switch(M.frameSequencer){case 0:F.updateLength();G.updateLength();H.updateLength();K.updateLength();break;case 2:F.updateLength();G.updateLength();H.updateLength();K.updateLength();F.updateSweep();break;case 4:F.updateLength();G.updateLength();H.updateLength();K.updateLength();break;case 6:F.updateLength();G.updateLength();H.updateLength();
K.updateLength();F.updateSweep();break;case 7:F.updateEnvelope(),G.updateEnvelope(),K.updateEnvelope()}M.frameSequencer+=1;8<=M.frameSequencer&&(M.frameSequencer=0);var c=!0}else c=!1;if(ba.audioAccumulateSamples&&!c){c=F.willChannelUpdate(a)||wa(F.channelNumber);var d=G.willChannelUpdate(a)||wa(G.channelNumber),e=H.willChannelUpdate(a)||wa(H.channelNumber),g=K.willChannelUpdate(a)||wa(K.channelNumber);c&&(L.channel1Sample=F.getSampleFromCycleCounter());d&&(L.channel2Sample=G.getSampleFromCycleCounter());
e&&(L.channel3Sample=H.getSampleFromCycleCounter());g&&(L.channel4Sample=K.getSampleFromCycleCounter());if(c||d||e||g)L.needToRemixSamples=!0;M.downSampleCycleCounter+=a*M.downSampleCycleMultiplier;M.downSampleCycleCounter>=M.maxDownSampleCycles()&&(M.downSampleCycleCounter-=M.maxDownSampleCycles(),(L.needToRemixSamples||L.mixerVolumeChanged||L.mixerEnabledChanged)&&Ca(L.channel1Sample,L.channel2Sample,L.channel3Sample,L.channel4Sample),a=L.rightChannelSampleUnsignedByte+1,c=588800+2*M.audioQueueIndex,
b[c]=L.leftChannelSampleUnsignedByte+1+1,b[c+1]=a+1,M.audioQueueIndex+=1,M.audioQueueIndex>=(M.wasmBoyMemoryMaxBufferSize/2|0)-1&&--M.audioQueueIndex)}else c=F.getSample(a)|0,d=G.getSample(a)|0,e=H.getSample(a)|0,g=K.getSample(a)|0,L.channel1Sample=c,L.channel2Sample=d,L.channel3Sample=e,L.channel4Sample=g,M.downSampleCycleCounter+=a*M.downSampleCycleMultiplier,M.downSampleCycleCounter>=M.maxDownSampleCycles()&&(M.downSampleCycleCounter-=M.maxDownSampleCycles(),a=Ca(c,d,e,g),c=h(a),d=588800+2*M.audioQueueIndex,
b[d]=c+1+1,b[d+1]=(a&255)+2,M.audioQueueIndex+=1,M.audioQueueIndex>=(M.wasmBoyMemoryMaxBufferSize/2|0)-1&&--M.audioQueueIndex)}function Da(){return M.audioQueueIndex}function xa(){M.audioQueueIndex=0}
function Ca(a,c,d,e){void 0===a&&(a=15);void 0===c&&(c=15);void 0===d&&(d=15);void 0===e&&(e=15);L.mixerVolumeChanged=!1;var g=0,n=0;g=M.NR51IsChannel1EnabledOnLeftOutput?g+a:g+15;g=M.NR51IsChannel2EnabledOnLeftOutput?g+c:g+15;g=M.NR51IsChannel3EnabledOnLeftOutput?g+d:g+15;g=M.NR51IsChannel4EnabledOnLeftOutput?g+e:g+15;n=M.NR51IsChannel1EnabledOnRightOutput?n+a:n+15;n=M.NR51IsChannel2EnabledOnRightOutput?n+c:n+15;n=M.NR51IsChannel3EnabledOnRightOutput?n+d:n+15;n=M.NR51IsChannel4EnabledOnRightOutput?
n+e:n+15;L.mixerEnabledChanged=!1;L.needToRemixSamples=!1;a=Ea(g,M.NR50LeftMixerVolume+1);n=Ea(n,M.NR50RightMixerVolume+1);L.leftChannelSampleUnsignedByte=a;L.rightChannelSampleUnsignedByte=n;return f(a,n)}function Ea(a,c){if(60===a)return 127;a=1E5*(a-60)*c/8|0;a=a/1E5|0;a+=60;a=1E5*a/(12E6/254|0)|0;return a|=0}
var P=function(){function a(){}a.updateInterruptEnabled=function(c){a.isVBlankInterruptEnabled=l(a.bitPositionVBlankInterrupt,c);a.isLcdInterruptEnabled=l(a.bitPositionLcdInterrupt,c);a.isTimerInterruptEnabled=l(a.bitPositionTimerInterrupt,c);a.isSerialInterruptEnabled=l(a.bitPositionSerialInterrupt,c);a.isJoypadInterruptEnabled=l(a.bitPositionJoypadInterrupt,c);a.interruptsEnabledValue=c};a.updateInterruptRequested=function(c){a.isVBlankInterruptRequested=l(a.bitPositionVBlankInterrupt,c);a.isLcdInterruptRequested=
l(a.bitPositionLcdInterrupt,c);a.isTimerInterruptRequested=l(a.bitPositionTimerInterrupt,c);a.isSerialInterruptRequested=l(a.bitPositionSerialInterrupt,c);a.isJoypadInterruptRequested=l(a.bitPositionJoypadInterrupt,c);a.interruptsRequestedValue=c};a.areInterruptsPending=function(){return 0<(a.interruptsRequestedValue&a.interruptsEnabledValue&31)};a.saveState=function(){z(1024+50*a.saveStateSlot,a.masterInterruptSwitch);z(1025+50*a.saveStateSlot,a.masterInterruptSwitchDelay)};a.loadState=function(){a.masterInterruptSwitch=
C(1024+50*a.saveStateSlot);a.masterInterruptSwitchDelay=C(1025+50*a.saveStateSlot);a.updateInterruptEnabled(w(a.memoryLocationInterruptEnabled));a.updateInterruptRequested(w(a.memoryLocationInterruptRequest))};a.masterInterruptSwitch=!1;a.masterInterruptSwitchDelay=!1;a.bitPositionVBlankInterrupt=0;a.bitPositionLcdInterrupt=1;a.bitPositionTimerInterrupt=2;a.bitPositionSerialInterrupt=3;a.bitPositionJoypadInterrupt=4;a.memoryLocationInterruptEnabled=65535;a.interruptsEnabledValue=0;a.isVBlankInterruptEnabled=
!1;a.isLcdInterruptEnabled=!1;a.isTimerInterruptEnabled=!1;a.isSerialInterruptEnabled=!1;a.isJoypadInterruptEnabled=!1;a.memoryLocationInterruptRequest=65295;a.interruptsRequestedValue=0;a.isVBlankInterruptRequested=!1;a.isLcdInterruptRequested=!1;a.isTimerInterruptRequested=!1;a.isSerialInterruptRequested=!1;a.isJoypadInterruptRequested=!1;a.saveStateSlot=2;return a}();
function Fa(a){Ga(!1);var c=w(P.memoryLocationInterruptRequest);c=k(a,c);P.interruptsRequestedValue=c;E(P.memoryLocationInterruptRequest,c);m.stackPointer-=2;m.isHalted();c=m.stackPointer;var d=m.programCounter,e=h(d),g=c+1;E(c,d&255);E(g,e);switch(a){case P.bitPositionVBlankInterrupt:P.isVBlankInterruptRequested=!1;m.programCounter=64;break;case P.bitPositionLcdInterrupt:P.isLcdInterruptRequested=!1;m.programCounter=72;break;case P.bitPositionTimerInterrupt:P.isTimerInterruptRequested=!1;m.programCounter=
80;break;case P.bitPositionSerialInterrupt:P.isSerialInterruptRequested=!1;m.programCounter=88;break;case P.bitPositionJoypadInterrupt:P.isJoypadInterruptRequested=!1,m.programCounter=96}}function Ha(a){var c=w(P.memoryLocationInterruptRequest);c|=1<<a;P.interruptsRequestedValue=c;E(P.memoryLocationInterruptRequest,c)}function Ga(a){a?P.masterInterruptSwitchDelay=!0:P.masterInterruptSwitch=!1}
var Q=function(){function a(){}a.batchProcessCycles=function(){return 256};a.updateDividerRegister=function(){var c=a.dividerRegister;a.dividerRegister=0;E(a.memoryLocationDividerRegister,0);a.timerEnabled&&Ia(c,a.dividerRegister)&&Ja()};a.updateTimerCounter=function(c){if(a.timerEnabled){if(a.timerCounterWasReset)return;a.timerCounterOverflowDelay&&(a.timerCounterOverflowDelay=!1)}a.timerCounter=c};a.updateTimerModulo=function(c){a.timerModulo=c;a.timerEnabled&&a.timerCounterWasReset&&(a.timerCounter=
a.timerModulo,a.timerCounterWasReset=!1)};a.updateTimerControl=function(c){var d=a.timerEnabled;a.timerEnabled=l(2,c);c&=3;if(!d){d=Ka(a.timerInputClock);var e=Ka(c);(a.timerEnabled?l(d,a.dividerRegister):l(d,a.dividerRegister)&&l(e,a.dividerRegister))&&Ja()}a.timerInputClock=c};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.currentCycles;b[1028+50*a.saveStateSlot]=a.dividerRegister;z(1032+50*a.saveStateSlot,a.timerCounterOverflowDelay);z(1035+50*a.saveStateSlot,a.timerCounterWasReset);E(a.memoryLocationTimerCounter,
a.timerCounter)};a.loadState=function(){a.currentCycles=b[1024+50*a.saveStateSlot];a.dividerRegister=b[1028+50*a.saveStateSlot];a.timerCounterOverflowDelay=C(1032+50*a.saveStateSlot);a.timerCounterWasReset=C(1035+50*a.saveStateSlot);a.timerCounter=w(a.memoryLocationTimerCounter);a.timerModulo=w(a.memoryLocationTimerModulo);a.timerInputClock=w(a.memoryLocationTimerControl)};a.currentCycles=0;a.memoryLocationDividerRegister=65284;a.dividerRegister=0;a.memoryLocationTimerCounter=65285;a.timerCounter=
0;a.timerCounterOverflowDelay=!1;a.timerCounterWasReset=!1;a.timerCounterMask=0;a.memoryLocationTimerModulo=65286;a.timerModulo=0;a.memoryLocationTimerControl=65287;a.timerEnabled=!1;a.timerInputClock=0;a.saveStateSlot=5;return a}();
function La(a){for(var c=0;c<a;){var d=Q.dividerRegister;c+=4;Q.dividerRegister+=4;65535<Q.dividerRegister&&(Q.dividerRegister-=65536);Q.timerEnabled&&(Q.timerCounterOverflowDelay?(Q.timerCounter=Q.timerModulo,P.isTimerInterruptRequested=!0,Ha(P.bitPositionTimerInterrupt),Q.timerCounterOverflowDelay=!1,Q.timerCounterWasReset=!0):Q.timerCounterWasReset&&(Q.timerCounterWasReset=!1),Ia(d,Q.dividerRegister)&&Ja())}}
function Ja(){Q.timerCounter+=1;255<Q.timerCounter&&(Q.timerCounterOverflowDelay=!0,Q.timerCounter=0)}function Ia(a,c){var d=Ka(Q.timerInputClock);return l(d,a)&&!l(d,c)?!0:!1}function Ka(a){switch(a){case 0:return 9;case 1:return 3;case 2:return 5;case 3:return 7}return 0}
var R=function(){function a(){}a.updateTransferControl=function(c){a.isShiftClockInternal=l(0,c);a.isClockSpeedFast=l(1,c);a.transferStartFlag=l(7,c);return!0};a.currentCycles=0;a.memoryLocationSerialTransferData=65281;a.memoryLocationSerialTransferControl=65282;a.numberOfBitsTransferred=0;a.isShiftClockInternal=!1;a.isClockSpeedFast=!1;a.transferStartFlag=!1;return a}(),S=function(){function a(){}a.updateJoypad=function(c){a.joypadRegisterFlipped=c^255;a.isDpadType=l(4,a.joypadRegisterFlipped);a.isButtonType=
l(5,a.joypadRegisterFlipped)};a.saveState=function(){};a.loadState=function(){a.updateJoypad(w(a.memoryLocationJoypadRegister))};a.up=!1;a.down=!1;a.left=!1;a.right=!1;a.a=!1;a.b=!1;a.select=!1;a.start=!1;a.memoryLocationJoypadRegister=65280;a.joypadRegisterFlipped=0;a.isDpadType=!1;a.isButtonType=!1;a.saveStateSlot=3;return a}();
function Ma(a){var c=m.isStopped=!1;Na(a)||(c=!0);Oa(a,!0);c&&(c=!1,3>=a&&(c=!0),a=!1,S.isDpadType&&c&&(a=!0),S.isButtonType&&!c&&(a=!0),a&&(P.isJoypadInterruptRequested=!0,Ha(P.bitPositionJoypadInterrupt)))}function Na(a){switch(a){case 0:return S.up;case 1:return S.right;case 2:return S.down;case 3:return S.left;case 4:return S.a;case 5:return S.b;case 6:return S.select;case 7:return S.start;default:return!1}}
function Oa(a,c){switch(a){case 0:S.up=c;break;case 1:S.right=c;break;case 2:S.down=c;break;case 3:S.left=c;break;case 4:S.a=c;break;case 5:S.b=c;break;case 6:S.select=c;break;case 7:S.start=c}}function Pa(a,c,d){for(var e=0;e<d;e++){for(var g=Qa(a+e),n=c+e;40959<n;)n-=8192;Ra(n,g)&&E(n,g)}a=32;m.GBCDoubleSpeed&&(a=64);T.DMACycles+=d/16*a}
function Ra(a,c){if(a===m.memoryLocationSpeedSwitch)return E(m.memoryLocationSpeedSwitch,c&1),!1;var d=T.videoRamLocation,e=T.spriteInformationTableLocation;if(a<d){if(!T.isRomOnly)if(8191>=a){if(!T.isMBC2||l(4,c))c&=15,0===c?T.isRamBankingEnabled=!1:10===c&&(T.isRamBankingEnabled=!0)}else 16383>=a?!T.isMBC5||12287>=a?(T.isMBC2&&(T.currentRomBank=c&15),T.isMBC1?(c&=31,T.currentRomBank&=224):T.isMBC3?(c&=127,T.currentRomBank&=128):T.isMBC5&&(T.currentRomBank&=0),T.currentRomBank|=c):(a=0,d=T.currentRomBank&
255,0<c&&(a=1),T.currentRomBank=f(a,d)):!T.isMBC2&&24575>=a?T.isMBC1&&T.isMBC1RomModeEnabled?(T.currentRomBank&=31,T.currentRomBank|=c&224):(c=T.isMBC5?c&15:c&3,T.currentRamBank=c):!T.isMBC2&&32767>=a&&T.isMBC1&&(l(0,c)?T.isMBC1RomModeEnabled=!0:T.isMBC1RomModeEnabled=!1);return!1}if(a>=d&&a<T.cartridgeRamLocation)return!0;if(a>=T.echoRamLocation&&a<e)return E(a-8192,c),!0;if(a>=e&&a<=T.spriteInformationTableLocationEnd)return 2>U.currentLcdMode?!1:!0;if(a>=T.unusableMemoryLocation&&a<=T.unusableMemoryEndLocation)return!1;
if(a===R.memoryLocationSerialTransferControl)return R.updateTransferControl(c);if(65296<=a&&65318>=a){Aa();if(a===M.memoryLocationNR52||M.NR52IsSoundEnabled){switch(a){case F.memoryLocationNRx0:F.updateNRx0(c);break;case H.memoryLocationNRx0:H.updateNRx0(c);break;case F.memoryLocationNRx1:F.updateNRx1(c);break;case G.memoryLocationNRx1:G.updateNRx1(c);break;case H.memoryLocationNRx1:H.updateNRx1(c);break;case K.memoryLocationNRx1:K.updateNRx1(c);break;case F.memoryLocationNRx2:F.updateNRx2(c);break;
case G.memoryLocationNRx2:G.updateNRx2(c);break;case H.memoryLocationNRx2:H.volumeCodeChanged=!0;H.updateNRx2(c);break;case K.memoryLocationNRx2:K.updateNRx2(c);break;case F.memoryLocationNRx3:F.updateNRx3(c);break;case G.memoryLocationNRx3:G.updateNRx3(c);break;case H.memoryLocationNRx3:H.updateNRx3(c);break;case K.memoryLocationNRx3:K.updateNRx3(c);break;case F.memoryLocationNRx4:l(7,c)&&(F.updateNRx4(c),F.trigger());break;case G.memoryLocationNRx4:l(7,c)&&(G.updateNRx4(c),G.trigger());break;case H.memoryLocationNRx4:l(7,
c)&&(H.updateNRx4(c),H.trigger());break;case K.memoryLocationNRx4:l(7,c)&&(K.updateNRx4(c),K.trigger());break;case M.memoryLocationNR50:M.updateNR50(c);L.mixerVolumeChanged=!0;break;case M.memoryLocationNR51:M.updateNR51(c);L.mixerEnabledChanged=!0;break;case M.memoryLocationNR52:if(M.updateNR52(c),!l(7,c))for(c=65296;65318>c;c++)E(c,0)}c=!0}else c=!1;return c}65328<=a&&65343>=a&&Aa();if(a>=U.memoryLocationLcdControl&&a<=y.memoryLocationWindowX){if(a===U.memoryLocationLcdControl)return U.updateLcdControl(c),
!0;if(a===U.memoryLocationLcdStatus)return U.updateLcdStatus(c),!1;if(a===y.memoryLocationScanlineRegister)return y.scanlineRegister=0,E(a,0),!1;if(a===U.memoryLocationCoincidenceCompare)return U.coincidenceCompare=c,!0;if(a===y.memoryLocationDmaTransfer){c<<=8;for(a=0;159>=a;a++)d=w(c+a),E(T.spriteInformationTableLocation+a,d);T.DMACycles=644;return!0}switch(a){case y.memoryLocationScrollX:y.scrollX=c;break;case y.memoryLocationScrollY:y.scrollY=c;break;case y.memoryLocationWindowX:y.windowX=c;break;
case y.memoryLocationWindowY:y.windowY=c}return!0}if(a===T.memoryLocationHdmaTrigger)return m.GBCEnabled&&(T.isHblankHdmaActive&&!l(7,c)?(T.isHblankHdmaActive=!1,c=w(T.memoryLocationHdmaTrigger),E(T.memoryLocationHdmaTrigger,c|128)):(a=w(T.memoryLocationHdmaSourceHigh),d=w(T.memoryLocationHdmaSourceLow),a=f(a,d)&65520,d=w(T.memoryLocationHdmaDestinationHigh),e=w(T.memoryLocationHdmaDestinationLow),d=f(d,e),d=(d&8176)+T.videoRamLocation,e=k(7,c),e=16*(e+1),l(7,c)?(T.isHblankHdmaActive=!0,T.hblankHdmaTransferLengthRemaining=
e,T.hblankHdmaSource=a,T.hblankHdmaDestination=d,E(T.memoryLocationHdmaTrigger,k(7,c))):(Pa(a,d,e),E(T.memoryLocationHdmaTrigger,255)))),!1;if((a===T.memoryLocationGBCWRAMBank||a===T.memoryLocationGBCVRAMBank)&&T.isHblankHdmaActive&&(16384<=T.hblankHdmaSource&&32767>=T.hblankHdmaSource||53248<=T.hblankHdmaSource&&57343>=T.hblankHdmaSource))return!1;if(a>=ja.memoryLocationBackgroundPaletteIndex&&a<=ja.memoryLocationSpritePaletteData){if(a===ja.memoryLocationBackgroundPaletteData||a===ja.memoryLocationSpritePaletteData){d=
w(a-1);d=k(6,d);e=!1;a===ja.memoryLocationSpritePaletteData&&(e=!0);var g=d&63;e&&(g+=64);b[67584+g]=c;c=d;--a;l(7,c)&&E(a,c+1|128)}return!0}if(a>=Q.memoryLocationDividerRegister&&a<=Q.memoryLocationTimerControl){La(Q.currentCycles);Q.currentCycles=0;switch(a){case Q.memoryLocationDividerRegister:return Q.updateDividerRegister(c),!1;case Q.memoryLocationTimerCounter:Q.updateTimerCounter(c);break;case Q.memoryLocationTimerModulo:Q.updateTimerModulo(c);break;case Q.memoryLocationTimerControl:Q.updateTimerControl(c)}return!0}a===
S.memoryLocationJoypadRegister&&S.updateJoypad(c);if(a===P.memoryLocationInterruptRequest)return P.updateInterruptRequested(c),!0;a===P.memoryLocationInterruptEnabled&&P.updateInterruptEnabled(c);return!0}
function Sa(a){switch(a>>12){case 0:case 1:case 2:case 3:return a+850944;case 4:case 5:case 6:case 7:var c=T.currentRomBank;T.isMBC5||0!==c||(c=1);return 16384*c+(a-T.switchableCartridgeRomLocation)+850944;case 8:case 9:return c=0,m.GBCEnabled&&(c=w(T.memoryLocationGBCVRAMBank)&1),a-T.videoRamLocation+2048+8192*c;case 10:case 11:return 8192*T.currentRamBank+(a-T.cartridgeRamLocation)+719872;case 12:return a-T.internalRamBankZeroLocation+18432;case 13:return c=0,m.GBCEnabled&&(c=w(T.memoryLocationGBCWRAMBank)&
7),1>c&&(c=1),a-T.internalRamBankZeroLocation+18432+4096*(c-1);default:return a-T.echoRamLocation+51200}}function E(a,c){a=Sa(a);b[a]=c}function z(a,c){b[a]=c?1:0}
var U=function(){function a(){}a.updateLcdStatus=function(c){var d=w(a.memoryLocationLcdStatus);c=c&248|d&7|128;E(a.memoryLocationLcdStatus,c)};a.updateLcdControl=function(c){var d=a.enabled;a.enabled=l(7,c);a.windowTileMapDisplaySelect=l(6,c);a.windowDisplayEnabled=l(5,c);a.bgWindowTileDataSelect=l(4,c);a.bgTileMapDisplaySelect=l(3,c);a.tallSpriteSize=l(2,c);a.spriteDisplayEnable=l(1,c);a.bgDisplayEnabled=l(0,c);d&&!a.enabled&&Ua(!0);!d&&a.enabled&&Ua(!1)};a.memoryLocationLcdStatus=65345;a.currentLcdMode=
0;a.memoryLocationCoincidenceCompare=65349;a.coincidenceCompare=0;a.memoryLocationLcdControl=65344;a.enabled=!0;a.windowTileMapDisplaySelect=!1;a.windowDisplayEnabled=!1;a.bgWindowTileDataSelect=!1;a.bgTileMapDisplaySelect=!1;a.tallSpriteSize=!1;a.spriteDisplayEnable=!1;a.bgDisplayEnabled=!1;return a}();
function Ua(a){y.scanlineCycleCounter=0;y.scanlineRegister=0;E(y.memoryLocationScanlineRegister,0);var c=w(U.memoryLocationLcdStatus);c=k(1,c);c=k(0,c);U.currentLcdMode=0;E(U.memoryLocationLcdStatus,c);if(a)for(a=0;521216>a;a++)b[67584+a]=255}function Va(a,c){var d=U.coincidenceCompare;0!==a&&1!==a||y.scanlineRegister!==d?c=k(2,c):(c|=4,l(6,c)&&(P.isLcdInterruptRequested=!0,Ha(P.bitPositionLcdInterrupt)));return c}
function Wa(a,c,d,e,g,n){for(var D=e>>3;160>g;g++){var v=g+n;256<=v&&(v-=256);var I=d+32*D+(v>>3),x=sa(I,0),N=!1;if(ba.tileCaching){var A=g;var B=a,V=v,O=I,W=x,J=0;if(0<B&&8<A&&W===pa.tileId&&A===pa.nextXIndexToPerformCacheCheck){var ya=W=!1;l(5,w(O-1))&&(W=!0);l(5,w(O))&&(ya=!0);for(O=0;8>O;O++)if(W!==ya&&(O=7-O),160>=A+O){for(var za=A-(8-O),wb=93184+3*(160*B+(A+O)),Ta=0;3>Ta;Ta++)Xa(A+O,B,Ta,b[wb+Ta]);za=b[69632+(160*B+za)];oa(A+O,B,k(2,za),l(2,za));J++}}else pa.tileId=W;A>=pa.nextXIndexToPerformCacheCheck&&
(pa.nextXIndexToPerformCacheCheck=A+8,B=V%8,A<B&&(pa.nextXIndexToPerformCacheCheck+=B));A=J;0<A&&(g+=A-1,N=!0)}ba.tileRendering&&!N?(N=g,A=a,J=c,B=e%8,V=0,0==N&&(V=v-v/8*8),v=7,160<N+8&&(v=160-N),W=-1,ya=0,m.GBCEnabled&&(W=sa(I,1),l(3,W)&&(ya=1),l(6,W)&&(B=7-B)),A=qa(x,J,ya,V,v,B,N,A,160,93184,!1,0,W),0<A&&(g+=A-1)):N||(m.GBCEnabled?(N=g,A=a,B=e,J=ra(c,x),I=sa(I,1),B%=8,l(6,I)&&(B=7-B),V=0,l(3,I)&&(V=1),x=sa(J+2*B,V),J=sa(J+2*B+1,V),B=v%8,l(5,I)||(B=7-B),v=0,l(B,J)&&(v=v+1<<1),l(B,x)&&(v+=1),B=la(I&
7,v,!1),x=na(0,B),J=na(1,B),B=na(2,B),Xa(N,A,0,x),Xa(N,A,1,J),Xa(N,A,2,B),oa(N,A,v,l(7,I))):(I=g,N=a,J=e,A=ra(c,x),J%=8,x=sa(A+2*J,0),A=sa(A+2*J+1,0),J=7-v%8,v=0,l(J,A)&&(v=v+1<<1),l(J,x)&&(v+=1),x=ka(v,y.memoryLocationBackgroundPalette),Xa(I,N,0,x),Xa(I,N,1,x),Xa(I,N,2,x),oa(I,N,v)))}}
var y=function(){function a(){}a.batchProcessCycles=function(){return a.MAX_CYCLES_PER_SCANLINE()};a.MAX_CYCLES_PER_SCANLINE=function(){return m.GBCDoubleSpeed?153===a.scanlineRegister?8:912:153===a.scanlineRegister?4:456};a.MIN_CYCLES_SPRITES_LCD_MODE=function(){return m.GBCDoubleSpeed?752:376};a.MIN_CYCLES_TRANSFER_DATA_LCD_MODE=function(){return m.GBCDoubleSpeed?498:249};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.scanlineCycleCounter;b[1028+50*a.saveStateSlot]=U.currentLcdMode;E(a.memoryLocationScanlineRegister,
a.scanlineRegister)};a.loadState=function(){a.scanlineCycleCounter=b[1024+50*a.saveStateSlot];U.currentLcdMode=b[1028+50*a.saveStateSlot];a.scanlineRegister=w(a.memoryLocationScanlineRegister);U.updateLcdControl(w(U.memoryLocationLcdControl))};a.currentCycles=0;a.scanlineCycleCounter=0;a.memoryLocationScanlineRegister=65348;a.scanlineRegister=0;a.memoryLocationDmaTransfer=65350;a.memoryLocationScrollX=65347;a.scrollX=0;a.memoryLocationScrollY=65346;a.scrollY=0;a.memoryLocationWindowX=65355;a.windowX=
0;a.memoryLocationWindowY=65354;a.windowY=0;a.memoryLocationTileMapSelectZeroStart=38912;a.memoryLocationTileMapSelectOneStart=39936;a.memoryLocationTileDataSelectZeroStart=34816;a.memoryLocationTileDataSelectOneStart=32768;a.memoryLocationSpriteAttributesTable=65024;a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;a.saveStateSlot=1;return a}();
function Ya(a){if(U.enabled)for(y.scanlineCycleCounter+=a;y.scanlineCycleCounter>=y.MAX_CYCLES_PER_SCANLINE();){y.scanlineCycleCounter-=y.MAX_CYCLES_PER_SCANLINE();a=y.scanlineRegister;if(144===a){if(ba.graphicsDisableScanlineRendering)for(var c=0;144>=c;c++)Za(c);else Za(a);for(c=0;144>c;c++)for(var d=0;160>d;d++)b[69632+(160*c+d)]=0;pa.tileId=-1;pa.nextXIndexToPerformCacheCheck=-1}else 144>a&&(ba.graphicsDisableScanlineRendering||Za(a));a=153<a?0:a+1;y.scanlineRegister=a}if(U.enabled)if(c=y.scanlineRegister,
d=U.currentLcdMode,a=0,144<=c?a=1:y.scanlineCycleCounter>=y.MIN_CYCLES_SPRITES_LCD_MODE()?a=2:y.scanlineCycleCounter>=y.MIN_CYCLES_TRANSFER_DATA_LCD_MODE()&&(a=3),d!==a){c=w(U.memoryLocationLcdStatus);U.currentLcdMode=a;d=!1;switch(a){case 0:c=k(0,c);c=k(1,c);d=l(3,c);break;case 1:c=k(1,c);c|=1;d=l(4,c);break;case 2:c=k(0,c);c|=2;d=l(5,c);break;case 3:c|=3}d&&(P.isLcdInterruptRequested=!0,Ha(P.bitPositionLcdInterrupt));0===a&&T.isHblankHdmaActive&&(d=16,T.hblankHdmaTransferLengthRemaining<d&&(d=T.hblankHdmaTransferLengthRemaining),
Pa(T.hblankHdmaSource,T.hblankHdmaDestination,d),T.hblankHdmaSource+=d,T.hblankHdmaDestination+=d,T.hblankHdmaTransferLengthRemaining-=d,0>=T.hblankHdmaTransferLengthRemaining?(T.isHblankHdmaActive=!1,E(T.memoryLocationHdmaTrigger,255)):E(T.memoryLocationHdmaTrigger,k(7,T.hblankHdmaTransferLengthRemaining/16-1)));1===a&&(P.isVBlankInterruptRequested=!0,Ha(P.bitPositionVBlankInterrupt));c=Va(a,c);E(U.memoryLocationLcdStatus,c)}else 153===c&&(c=w(U.memoryLocationLcdStatus),c=Va(a,c),E(U.memoryLocationLcdStatus,
c))}
function Za(a){var c=y.memoryLocationTileDataSelectZeroStart;U.bgWindowTileDataSelect&&(c=y.memoryLocationTileDataSelectOneStart);if(m.GBCEnabled||U.bgDisplayEnabled){var d=y.memoryLocationTileMapSelectZeroStart;U.bgTileMapDisplaySelect&&(d=y.memoryLocationTileMapSelectOneStart);var e=y.scrollX,g=a+y.scrollY;256<=g&&(g-=256);Wa(a,c,d,g,0,e)}U.windowDisplayEnabled&&(d=y.memoryLocationTileMapSelectZeroStart,U.windowTileMapDisplaySelect&&(d=y.memoryLocationTileMapSelectOneStart),e=y.windowX,g=y.windowY,a<
g||(e-=7,Wa(a,c,d,a-g,e,-1*e)));if(U.spriteDisplayEnable)for(c=U.tallSpriteSize,d=39;0<=d;d--){g=4*d;var n=w(y.memoryLocationSpriteAttributesTable+g);e=w(y.memoryLocationSpriteAttributesTable+g+1);var D=w(y.memoryLocationSpriteAttributesTable+g+2);n-=16;e-=8;var v=8;c&&(v=16,1===D%2&&--D);if(a>=n&&a<n+v){g=w(y.memoryLocationSpriteAttributesTable+g+3);var I=l(7,g),x=l(6,g),N=l(5,g);n=a-n;x&&(n-=v,n*=-1,--n);n*=2;D=ra(y.memoryLocationTileDataSelectOneStart,D);v=D+=n;n=0;m.GBCEnabled&&l(3,g)&&(n=1);
D=sa(v,n);v=sa(v+1,n);for(n=7;0<=n;n--){x=n;N&&(x-=7,x*=-1);var A=0;l(x,v)&&(A+=1,A<<=1);l(x,D)&&(A+=1);if(0!==A&&(x=e+(7-n),0<=x&&160>=x)){var B=!1,V=!1,O=!1;m.GBCEnabled&&!U.bgDisplayEnabled&&(B=!0);if(!B){var W=b[69632+(160*a+x)],J=W&3;I&&0<J?V=!0:m.GBCEnabled&&l(2,W)&&0<J&&(O=!0)}if(B||!V&&!O)m.GBCEnabled?(V=la(g&7,A,!0),A=na(0,V),B=na(1,V),V=na(2,V),Xa(x,a,0,A),Xa(x,a,1,B),Xa(x,a,2,V)):(B=y.memoryLocationSpritePaletteOne,l(4,g)&&(B=y.memoryLocationSpritePaletteTwo),A=ka(A,B),Xa(x,a,0,A),Xa(x,
a,1,A),Xa(x,a,2,A))}}}}}function Xa(a,c,d,e){b[93184+3*(160*c+a)+d]=e}function sa(a,c){return b[a-T.videoRamLocation+2048+8192*(c&1)]}
function $a(a){var c=T.videoRamLocation;return a<c||a>=c&&a<T.cartridgeRamLocation?-1:a>=T.echoRamLocation&&a<T.spriteInformationTableLocation?w(a-8192):a>=T.spriteInformationTableLocation&&a<=T.spriteInformationTableLocationEnd?2>U.currentLcdMode?255:-1:a===m.memoryLocationSpeedSwitch?(a=255,c=w(m.memoryLocationSpeedSwitch),l(0,c)||(a=k(0,a)),m.GBCDoubleSpeed||(a=k(7,a)),a):a===y.memoryLocationScanlineRegister?(E(a,y.scanlineRegister),y.scanlineRegister):65296<=a&&65318>=a?(Aa(),a=a===M.memoryLocationNR52?
w(M.memoryLocationNR52)&128|112:-1,a):65328<=a&&65343>=a?(Aa(),-1):a===Q.memoryLocationDividerRegister?(c=h(Q.dividerRegister),E(a,c),c):a===Q.memoryLocationTimerCounter?(E(a,Q.timerCounter),Q.timerCounter):a===P.memoryLocationInterruptRequest?224|P.interruptsRequestedValue:a===S.memoryLocationJoypadRegister?(a=S.joypadRegisterFlipped,S.isDpadType?(a=S.up?k(2,a):a|4,a=S.right?k(0,a):a|1,a=S.down?k(3,a):a|8,a=S.left?k(1,a):a|2):S.isButtonType&&(a=S.a?k(0,a):a|1,a=S.b?k(1,a):a|2,a=S.select?k(2,a):a|
4,a=S.start?k(3,a):a|8),a|240):-1}function w(a){return b[Sa(a)]}function Qa(a){var c=$a(a);switch(c){case -1:return w(a);default:return c}}function C(a){return 0<b[a]?!0:!1}
var T=function(){function a(){}a.saveState=function(){b[1024+50*a.saveStateSlot]=a.currentRomBank;b[1026+50*a.saveStateSlot]=a.currentRamBank;z(1028+50*a.saveStateSlot,a.isRamBankingEnabled);z(1029+50*a.saveStateSlot,a.isMBC1RomModeEnabled);z(1030+50*a.saveStateSlot,a.isRomOnly);z(1031+50*a.saveStateSlot,a.isMBC1);z(1032+50*a.saveStateSlot,a.isMBC2);z(1033+50*a.saveStateSlot,a.isMBC3);z(1034+50*a.saveStateSlot,a.isMBC5)};a.loadState=function(){a.currentRomBank=b[1024+50*a.saveStateSlot];a.currentRamBank=
b[1026+50*a.saveStateSlot];a.isRamBankingEnabled=C(1028+50*a.saveStateSlot);a.isMBC1RomModeEnabled=C(1029+50*a.saveStateSlot);a.isRomOnly=C(1030+50*a.saveStateSlot);a.isMBC1=C(1031+50*a.saveStateSlot);a.isMBC2=C(1032+50*a.saveStateSlot);a.isMBC3=C(1033+50*a.saveStateSlot);a.isMBC5=C(1034+50*a.saveStateSlot)};a.cartridgeRomLocation=0;a.switchableCartridgeRomLocation=16384;a.videoRamLocation=32768;a.cartridgeRamLocation=40960;a.internalRamBankZeroLocation=49152;a.internalRamBankOneLocation=53248;a.echoRamLocation=
57344;a.spriteInformationTableLocation=65024;a.spriteInformationTableLocationEnd=65183;a.unusableMemoryLocation=65184;a.unusableMemoryEndLocation=65279;a.currentRomBank=0;a.currentRamBank=0;a.isRamBankingEnabled=!1;a.isMBC1RomModeEnabled=!0;a.isRomOnly=!0;a.isMBC1=!1;a.isMBC2=!1;a.isMBC3=!1;a.isMBC5=!1;a.memoryLocationHdmaSourceHigh=65361;a.memoryLocationHdmaSourceLow=65362;a.memoryLocationHdmaDestinationHigh=65363;a.memoryLocationHdmaDestinationLow=65364;a.memoryLocationHdmaTrigger=65365;a.DMACycles=
0;a.isHblankHdmaActive=!1;a.hblankHdmaTransferLengthRemaining=0;a.hblankHdmaSource=0;a.hblankHdmaDestination=0;a.memoryLocationGBCVRAMBank=65359;a.memoryLocationGBCWRAMBank=65392;a.saveStateSlot=4;return a}(),m=function(){function a(){}a.CLOCK_SPEED=function(){return a.GBCDoubleSpeed?8388608:4194304};a.MAX_CYCLES_PER_FRAME=function(){return a.GBCDoubleSpeed?140448:70224};a.enableHalt=function(){P.masterInterruptSwitch?a.isHaltNormal=!0:0===(P.interruptsEnabledValue&P.interruptsRequestedValue&31)?
a.isHaltNoJump=!0:a.isHaltBug=!0};a.exitHaltAndStop=function(){a.isHaltNoJump=!1;a.isHaltNormal=!1;a.isHaltBug=!1;a.isStopped=!1};a.isHalted=function(){return a.isHaltNormal||a.isHaltNoJump?!0:!1};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.registerA;b[1025+50*a.saveStateSlot]=a.registerB;b[1026+50*a.saveStateSlot]=a.registerC;b[1027+50*a.saveStateSlot]=a.registerD;b[1028+50*a.saveStateSlot]=a.registerE;b[1029+50*a.saveStateSlot]=a.registerH;b[1030+50*a.saveStateSlot]=a.registerL;b[1031+50*
a.saveStateSlot]=a.registerF;b[1032+50*a.saveStateSlot]=a.stackPointer;b[1034+50*a.saveStateSlot]=a.programCounter;b[1036+50*a.saveStateSlot]=a.currentCycles;z(1041+50*a.saveStateSlot,a.isHaltNormal);z(1042+50*a.saveStateSlot,a.isHaltNoJump);z(1043+50*a.saveStateSlot,a.isHaltBug);z(1044+50*a.saveStateSlot,a.isStopped)};a.loadState=function(){a.registerA=b[1024+50*a.saveStateSlot];a.registerB=b[1025+50*a.saveStateSlot];a.registerC=b[1026+50*a.saveStateSlot];a.registerD=b[1027+50*a.saveStateSlot];a.registerE=
b[1028+50*a.saveStateSlot];a.registerH=b[1029+50*a.saveStateSlot];a.registerL=b[1030+50*a.saveStateSlot];a.registerF=b[1031+50*a.saveStateSlot];a.stackPointer=b[1032+50*a.saveStateSlot];a.programCounter=b[1034+50*a.saveStateSlot];a.currentCycles=b[1036+50*a.saveStateSlot];a.isHaltNormal=C(1041+50*a.saveStateSlot);a.isHaltNoJump=C(1042+50*a.saveStateSlot);a.isHaltBug=C(1043+50*a.saveStateSlot);a.isStopped=C(1044+50*a.saveStateSlot)};a.GBCEnabled=!1;a.memoryLocationSpeedSwitch=65357;a.GBCDoubleSpeed=
!1;a.registerA=0;a.registerB=0;a.registerC=0;a.registerD=0;a.registerE=0;a.registerH=0;a.registerL=0;a.registerF=0;a.stackPointer=0;a.programCounter=0;a.currentCycles=0;a.isHaltNormal=!1;a.isHaltNoJump=!1;a.isHaltBug=!1;a.isStopped=!1;a.saveStateSlot=0;return a}();function ab(a){u(m.registerA,a);ha(m.registerA,a);m.registerA=m.registerA+a&255;0===m.registerA?p(1):p(0);q(0)}
function bb(a){var c=m.registerA+a+fa()&255;0!=((m.registerA^a^c)&16)?r(1):r(0);0<(m.registerA+a+fa()&256)?t(1):t(0);m.registerA=c;0===m.registerA?p(1):p(0);q(0)}function cb(a){var c=-1*a;u(m.registerA,c);ha(m.registerA,c);m.registerA=m.registerA-a&255;0===m.registerA?p(1):p(0);q(1)}function db(a){var c=m.registerA-a-fa()&255;0!=((m.registerA^a^c)&16)?r(1):r(0);0<(m.registerA-a-fa()&256)?t(1):t(0);m.registerA=c;0===m.registerA?p(1):p(0);q(1)}
function eb(a){m.registerA&=a;0===m.registerA?p(1):p(0);q(0);r(1);t(0)}function fb(a){m.registerA=(m.registerA^a)&255;0===m.registerA?p(1):p(0);q(0);r(0);t(0)}function gb(a){m.registerA|=a;0===m.registerA?p(1):p(0);q(0);r(0);t(0)}function hb(a){a*=-1;u(m.registerA,a);ha(m.registerA,a);0===m.registerA+a?p(1):p(0);q(1)}function ib(a,c){0===(c&1<<a)?p(1):p(0);q(0);r(1);return c}function jb(a,c,d){return 0<c?d|1<<a:d&~(1<<a)}
function kb(a){a=ca(a);m.programCounter=m.programCounter+a&65535;m.programCounter=m.programCounter+1&65535}
function lb(a){m.programCounter=m.programCounter+1&65535;m.isHaltBug&&(m.programCounter=m.programCounter-1&65535);switch((a&240)>>4){case 0:return mb(a);case 1:return nb(a);case 2:return ob(a);case 3:return pb(a);case 4:return qb(a);case 5:return rb(a);case 6:return sb(a);case 7:return tb(a);case 8:return ub(a);case 9:return vb(a);case 10:return xb(a);case 11:return yb(a);case 12:return zb(a);case 13:return Ab(a);case 14:return Bb(a);default:return Cb(a)}}function X(a){Db(4);return Qa(a)}
function Eb(a,c){Db(4);Ra(a,c)&&E(a,c)}function Fb(a){Db(8);var c=$a(a);switch(c){case -1:c=w(a)}a+=1;var d=$a(a);switch(d){case -1:a=w(a);break;default:a=d}return f(a,c)}function Gb(a,c){Db(8);var d=h(c);c&=255;var e=a+1;Ra(a,c)&&E(a,c);Ra(e,d)&&E(e,d)}function Y(){Db(4);return w(m.programCounter)}function Hb(){Db(4);var a=w(m.programCounter+1&65535);return f(a,Y())}
function mb(a){switch(a){case 0:return 4;case 1:return a=Hb(),m.registerB=h(a),m.registerC=a&255,m.programCounter=m.programCounter+2&65535,4;case 2:return Eb(f(m.registerB,m.registerC),m.registerA),4;case 3:return a=f(m.registerB,m.registerC),a++,m.registerB=h(a),m.registerC=a&255,8;case 4:return u(m.registerB,1),m.registerB=m.registerB+1&255,0===m.registerB?p(1):p(0),q(0),4;case 5:return u(m.registerB,-1),m.registerB=m.registerB-1&255,0===m.registerB?p(1):p(0),q(1),4;case 6:return m.registerB=Y(),
m.programCounter=m.programCounter+1&65535,4;case 7:128===(m.registerA&128)?t(1):t(0);a=m;var c=m.registerA;a.registerA=(c<<1|c>>7)&255;p(0);q(0);r(0);return 4;case 8:return Gb(Hb(),m.stackPointer),m.programCounter=m.programCounter+2&65535,4;case 9:return a=f(m.registerH,m.registerL),c=f(m.registerB,m.registerC),ia(a,c,!1),a=a+c&65535,m.registerH=h(a),m.registerL=a&255,q(0),8;case 10:return m.registerA=X(f(m.registerB,m.registerC)),4;case 11:return a=f(m.registerB,m.registerC),a=a-1&65535,m.registerB=
h(a),m.registerC=a&255,8;case 12:return u(m.registerC,1),m.registerC=m.registerC+1&255,0===m.registerC?p(1):p(0),q(0),4;case 13:return u(m.registerC,-1),m.registerC=m.registerC-1&255,0===m.registerC?p(1):p(0),q(1),4;case 14:return m.registerC=Y(),m.programCounter=m.programCounter+1&65535,4;case 15:return 0<(m.registerA&1)?t(1):t(0),a=m,c=m.registerA,a.registerA=(c>>1|c<<7)&255,p(0),q(0),r(0),4}return-1}
function nb(a){switch(a){case 16:if(m.GBCEnabled&&(a=X(m.memoryLocationSpeedSwitch),l(0,a)))return a=k(0,a),l(7,a)?(m.GBCDoubleSpeed=!1,a=k(7,a)):(m.GBCDoubleSpeed=!0,a|=128),Eb(m.memoryLocationSpeedSwitch,a),68;m.isStopped=!0;m.programCounter=m.programCounter+1&65535;return 4;case 17:return a=Hb(),m.registerD=h(a),m.registerE=a&255,m.programCounter=m.programCounter+2&65535,4;case 18:return Eb(f(m.registerD,m.registerE),m.registerA),4;case 19:return a=f(m.registerD,m.registerE),a=a+1&65535,m.registerD=
h(a),m.registerE=a&255,8;case 20:return u(m.registerD,1),m.registerD=m.registerD+1&255,0===m.registerD?p(1):p(0),q(0),4;case 21:return u(m.registerD,-1),m.registerD=m.registerD-1&255,0===m.registerD?p(1):p(0),q(1),4;case 22:return m.registerD=Y(),m.programCounter=m.programCounter+1&65535,4;case 23:return a=!1,128===(m.registerA&128)&&(a=!0),m.registerA=(m.registerA<<1|fa())&255,a?t(1):t(0),p(0),q(0),r(0),4;case 24:return kb(Y()),8;case 25:a=f(m.registerH,m.registerL);var c=f(m.registerD,m.registerE);
ia(a,c,!1);a=a+c&65535;m.registerH=h(a);m.registerL=a&255;q(0);return 8;case 26:return a=f(m.registerD,m.registerE),m.registerA=X(a),4;case 27:return a=f(m.registerD,m.registerE),a=a-1&65535,m.registerD=h(a),m.registerE=a&255,8;case 28:return u(m.registerE,1),m.registerE=m.registerE+1&255,0===m.registerE?p(1):p(0),q(0),4;case 29:return u(m.registerE,-1),m.registerE=m.registerE-1&255,0===m.registerE?p(1):p(0),q(1),4;case 30:return m.registerE=Y(),m.programCounter=m.programCounter+1&65535,4;case 31:return a=
!1,1===(m.registerA&1)&&(a=!0),m.registerA=(m.registerA>>1|fa()<<7)&255,a?t(1):t(0),p(0),q(0),r(0),4}return-1}
function ob(a){switch(a){case 32:return 0===ea()?kb(Y()):m.programCounter=m.programCounter+1&65535,8;case 33:return a=Hb(),m.registerH=h(a),m.registerL=a&255,m.programCounter=m.programCounter+2&65535,4;case 34:return a=f(m.registerH,m.registerL),Eb(a,m.registerA),a=a+1&65535,m.registerH=h(a),m.registerL=a&255,4;case 35:return a=f(m.registerH,m.registerL),a=a+1&65535,m.registerH=h(a),m.registerL=a&255,8;case 36:return u(m.registerH,1),m.registerH=m.registerH+1&255,0===m.registerH?p(1):p(0),q(0),4;
case 37:return u(m.registerH,-1),m.registerH=m.registerH-1&255,0===m.registerH?p(1):p(0),q(1),4;case 38:return m.registerH=Y(),m.programCounter=m.programCounter+1&65535,4;case 39:var c=0;0<(m.registerF>>5&1)&&(c|=6);0<fa()&&(c|=96);0<(m.registerF>>6&1)?a=m.registerA-c&255:(9<(m.registerA&15)&&(c|=6),153<m.registerA&&(c|=96),a=m.registerA+c&255);0===a?p(1):p(0);0!==(c&96)?t(1):t(0);r(0);m.registerA=a;return 4;case 40:return 0<ea()?kb(Y()):m.programCounter=m.programCounter+1&65535,8;case 41:return a=
f(m.registerH,m.registerL),ia(a,a,!1),a=2*a&65535,m.registerH=h(a),m.registerL=a&255,q(0),8;case 42:return a=f(m.registerH,m.registerL),m.registerA=X(a),a=a+1&65535,m.registerH=h(a),m.registerL=a&255,4;case 43:return a=f(m.registerH,m.registerL),a=a-1&65535,m.registerH=h(a),m.registerL=a&255,8;case 44:return u(m.registerL,1),m.registerL=m.registerL+1&255,0===m.registerL?p(1):p(0),q(0),4;case 45:return u(m.registerL,-1),m.registerL=m.registerL-1&255,0===m.registerL?p(1):p(0),q(1),4;case 46:return m.registerL=
Y(),m.programCounter=m.programCounter+1&65535,4;case 47:return m.registerA=~m.registerA,q(1),r(1),4}return-1}
function pb(a){switch(a){case 48:return 0===fa()?kb(Y()):m.programCounter=m.programCounter+1&65535,8;case 49:return m.stackPointer=Hb(),m.programCounter=m.programCounter+2&65535,4;case 50:return a=f(m.registerH,m.registerL),Eb(a,m.registerA),a=a-1&65535,m.registerH=h(a),m.registerL=a&255,4;case 51:return m.stackPointer=m.stackPointer+1&65535,8;case 52:a=f(m.registerH,m.registerL);var c=X(a);u(c,1);c=c+1&255;0===c?p(1):p(0);q(0);Eb(a,c);return 4;case 53:return a=f(m.registerH,m.registerL),c=X(a),u(c,
-1),c=c-1&255,0===c?p(1):p(0),q(1),Eb(a,c),4;case 54:return Eb(f(m.registerH,m.registerL),Y()),m.programCounter=m.programCounter+1&65535,4;case 55:return q(0),r(0),t(1),4;case 56:return 1===fa()?kb(Y()):m.programCounter=m.programCounter+1&65535,8;case 57:return a=f(m.registerH,m.registerL),ia(a,m.stackPointer,!1),a=a+m.stackPointer&65535,m.registerH=h(a),m.registerL=a&255,q(0),8;case 58:return a=f(m.registerH,m.registerL),m.registerA=X(a),a=a-1&65535,m.registerH=h(a),m.registerL=a&255,4;case 59:return m.stackPointer=
m.stackPointer-1&65535,8;case 60:return u(m.registerA,1),m.registerA=m.registerA+1&255,0===m.registerA?p(1):p(0),q(0),4;case 61:return u(m.registerA,-1),m.registerA=m.registerA-1&255,0===m.registerA?p(1):p(0),q(1),4;case 62:return m.registerA=Y(),m.programCounter=m.programCounter+1&65535,4;case 63:return q(0),r(0),0<fa()?t(0):t(1),4}return-1}
function qb(a){switch(a){case 64:return 4;case 65:return m.registerB=m.registerC,4;case 66:return m.registerB=m.registerD,4;case 67:return m.registerB=m.registerE,4;case 68:return m.registerB=m.registerH,4;case 69:return m.registerB=m.registerL,4;case 70:return m.registerB=X(f(m.registerH,m.registerL)),4;case 71:return m.registerB=m.registerA,4;case 72:return m.registerC=m.registerB,4;case 73:return 4;case 74:return m.registerC=m.registerD,4;case 75:return m.registerC=m.registerE,4;case 76:return m.registerC=
m.registerH,4;case 77:return m.registerC=m.registerL,4;case 78:return m.registerC=X(f(m.registerH,m.registerL)),4;case 79:return m.registerC=m.registerA,4}return-1}
function rb(a){switch(a){case 80:return m.registerD=m.registerB,4;case 81:return m.registerD=m.registerC,4;case 82:return 4;case 83:return m.registerD=m.registerE,4;case 84:return m.registerD=m.registerH,4;case 85:return m.registerD=m.registerL,4;case 86:return m.registerD=X(f(m.registerH,m.registerL)),4;case 87:return m.registerD=m.registerA,4;case 88:return m.registerE=m.registerB,4;case 89:return m.registerE=m.registerC,4;case 90:return m.registerE=m.registerD,4;case 91:return 4;case 92:return m.registerE=
m.registerH,4;case 93:return m.registerE=m.registerL,4;case 94:return m.registerE=X(f(m.registerH,m.registerL)),4;case 95:return m.registerE=m.registerA,4}return-1}
function sb(a){switch(a){case 96:return m.registerH=m.registerB,4;case 97:return m.registerH=m.registerC,4;case 98:return m.registerH=m.registerD,4;case 99:return m.registerH=m.registerE,4;case 100:return m.registerH=m.registerH,4;case 101:return m.registerH=m.registerL,4;case 102:return m.registerH=X(f(m.registerH,m.registerL)),4;case 103:return m.registerH=m.registerA,4;case 104:return m.registerL=m.registerB,4;case 105:return m.registerL=m.registerC,4;case 106:return m.registerL=m.registerD,4;
case 107:return m.registerL=m.registerE,4;case 108:return m.registerL=m.registerH,4;case 109:return m.registerL=m.registerL,4;case 110:return m.registerL=X(f(m.registerH,m.registerL)),4;case 111:return m.registerL=m.registerA,4}return-1}
function tb(a){switch(a){case 112:return Eb(f(m.registerH,m.registerL),m.registerB),4;case 113:return Eb(f(m.registerH,m.registerL),m.registerC),4;case 114:return Eb(f(m.registerH,m.registerL),m.registerD),4;case 115:return Eb(f(m.registerH,m.registerL),m.registerE),4;case 116:return Eb(f(m.registerH,m.registerL),m.registerH),4;case 117:return Eb(f(m.registerH,m.registerL),m.registerL),4;case 118:return T.isHblankHdmaActive||m.enableHalt(),4;case 119:return Eb(f(m.registerH,m.registerL),m.registerA),
4;case 120:return m.registerA=m.registerB,4;case 121:return m.registerA=m.registerC,4;case 122:return m.registerA=m.registerD,4;case 123:return m.registerA=m.registerE,4;case 124:return m.registerA=m.registerH,4;case 125:return m.registerA=m.registerL,4;case 126:return m.registerA=X(f(m.registerH,m.registerL)),4;case 127:return 4}return-1}
function ub(a){switch(a){case 128:return ab(m.registerB),4;case 129:return ab(m.registerC),4;case 130:return ab(m.registerD),4;case 131:return ab(m.registerE),4;case 132:return ab(m.registerH),4;case 133:return ab(m.registerL),4;case 134:return a=X(f(m.registerH,m.registerL)),ab(a),4;case 135:return ab(m.registerA),4;case 136:return bb(m.registerB),4;case 137:return bb(m.registerC),4;case 138:return bb(m.registerD),4;case 139:return bb(m.registerE),4;case 140:return bb(m.registerH),4;case 141:return bb(m.registerL),
4;case 142:return a=X(f(m.registerH,m.registerL)),bb(a),4;case 143:return bb(m.registerA),4}return-1}
function vb(a){switch(a){case 144:return cb(m.registerB),4;case 145:return cb(m.registerC),4;case 146:return cb(m.registerD),4;case 147:return cb(m.registerE),4;case 148:return cb(m.registerH),4;case 149:return cb(m.registerL),4;case 150:return a=X(f(m.registerH,m.registerL)),cb(a),4;case 151:return cb(m.registerA),4;case 152:return db(m.registerB),4;case 153:return db(m.registerC),4;case 154:return db(m.registerD),4;case 155:return db(m.registerE),4;case 156:return db(m.registerH),4;case 157:return db(m.registerL),
4;case 158:return a=X(f(m.registerH,m.registerL)),db(a),4;case 159:return db(m.registerA),4}return-1}
function xb(a){switch(a){case 160:return eb(m.registerB),4;case 161:return eb(m.registerC),4;case 162:return eb(m.registerD),4;case 163:return eb(m.registerE),4;case 164:return eb(m.registerH),4;case 165:return eb(m.registerL),4;case 166:return a=X(f(m.registerH,m.registerL)),eb(a),4;case 167:return eb(m.registerA),4;case 168:return fb(m.registerB),4;case 169:return fb(m.registerC),4;case 170:return fb(m.registerD),4;case 171:return fb(m.registerE),4;case 172:return fb(m.registerH),4;case 173:return fb(m.registerL),
4;case 174:return a=X(f(m.registerH,m.registerL)),fb(a),4;case 175:return fb(m.registerA),4}return-1}
function yb(a){switch(a){case 176:return gb(m.registerB),4;case 177:return gb(m.registerC),4;case 178:return gb(m.registerD),4;case 179:return gb(m.registerE),4;case 180:return gb(m.registerH),4;case 181:return gb(m.registerL),4;case 182:return a=X(f(m.registerH,m.registerL)),gb(a),4;case 183:return gb(m.registerA),4;case 184:return hb(m.registerB),4;case 185:return hb(m.registerC),4;case 186:return hb(m.registerD),4;case 187:return hb(m.registerE),4;case 188:return hb(m.registerH),4;case 189:return hb(m.registerL),
4;case 190:return a=X(f(m.registerH,m.registerL)),hb(a),4;case 191:return hb(m.registerA),4}return-1}
function zb(a){switch(a){case 192:return 0===ea()?(m.programCounter=Fb(m.stackPointer),m.stackPointer=m.stackPointer+2&65535,12):8;case 193:return a=Fb(m.stackPointer),m.stackPointer=m.stackPointer+2&65535,m.registerB=h(a),m.registerC=a&255,4;case 194:if(0===ea())return m.programCounter=Hb(),8;m.programCounter=m.programCounter+2&65535;return 12;case 195:return m.programCounter=Hb(),8;case 196:if(0===ea())return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter+2&65535),m.programCounter=
Hb(),8;m.programCounter=m.programCounter+2&65535;return 12;case 197:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,f(m.registerB,m.registerC)),8;case 198:return ab(Y()),m.programCounter=m.programCounter+1&65535,4;case 199:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter),m.programCounter=0,8;case 200:return 1===ea()?(m.programCounter=Fb(m.stackPointer),m.stackPointer=m.stackPointer+2&65535,12):8;case 201:return m.programCounter=Fb(m.stackPointer),m.stackPointer=
m.stackPointer+2&65535,8;case 202:if(1===ea())return m.programCounter=Hb(),8;m.programCounter=m.programCounter+2&65535;return 12;case 203:var c=Y();a=-1;var d=!1,e=0,g=0,n=c%8;switch(n){case 0:e=m.registerB;break;case 1:e=m.registerC;break;case 2:e=m.registerD;break;case 3:e=m.registerE;break;case 4:e=m.registerH;break;case 5:e=m.registerL;break;case 6:e=X(f(m.registerH,m.registerL));break;case 7:e=m.registerA}var D=(c&240)>>4;switch(D){case 0:7>=c?(c=e,128===(c&128)?t(1):t(0),c=(c<<1|c>>7)&255,0===
c?p(1):p(0),q(0),r(0),g=c,d=!0):15>=c&&(c=e,0<(c&1)?t(1):t(0),c=(c>>1|c<<7)&255,0===c?p(1):p(0),q(0),r(0),g=c,d=!0);break;case 1:23>=c?(c=e,d=!1,128===(c&128)&&(d=!0),c=(c<<1|fa())&255,d?t(1):t(0),0===c?p(1):p(0),q(0),r(0),g=c,d=!0):31>=c&&(c=e,d=!1,1===(c&1)&&(d=!0),c=(c>>1|fa()<<7)&255,d?t(1):t(0),0===c?p(1):p(0),q(0),r(0),g=c,d=!0);break;case 2:39>=c?(c=e,d=!1,128===(c&128)&&(d=!0),c=c<<1&255,d?t(1):t(0),0===c?p(1):p(0),q(0),r(0),g=c,d=!0):47>=c&&(c=e,d=!1,128===(c&128)&&(d=!0),e=!1,1===(c&1)&&
(e=!0),c=c>>1&255,d&&(c|=128),0===c?p(1):p(0),q(0),r(0),e?t(1):t(0),g=c,d=!0);break;case 3:55>=c?(c=e,c=((c&15)<<4|(c&240)>>4)&255,0===c?p(1):p(0),q(0),r(0),t(0),g=c,d=!0):63>=c&&(c=e,d=!1,1===(c&1)&&(d=!0),c=c>>1&255,0===c?p(1):p(0),q(0),r(0),d?t(1):t(0),g=c,d=!0);break;case 4:71>=c?(g=ib(0,e),d=!0):79>=c&&(g=ib(1,e),d=!0);break;case 5:87>=c?(g=ib(2,e),d=!0):95>=c&&(g=ib(3,e),d=!0);break;case 6:103>=c?(g=ib(4,e),d=!0):111>=c&&(g=ib(5,e),d=!0);break;case 7:119>=c?(g=ib(6,e),d=!0):127>=c&&(g=ib(7,
e),d=!0);break;case 8:135>=c?(g=jb(0,0,e),d=!0):143>=c&&(g=jb(1,0,e),d=!0);break;case 9:151>=c?(g=jb(2,0,e),d=!0):159>=c&&(g=jb(3,0,e),d=!0);break;case 10:167>=c?(g=jb(4,0,e),d=!0):175>=c&&(g=jb(5,0,e),d=!0);break;case 11:183>=c?(g=jb(6,0,e),d=!0):191>=c&&(g=jb(7,0,e),d=!0);break;case 12:199>=c?(g=jb(0,1,e),d=!0):207>=c&&(g=jb(1,1,e),d=!0);break;case 13:215>=c?(g=jb(2,1,e),d=!0):223>=c&&(g=jb(3,1,e),d=!0);break;case 14:231>=c?(g=jb(4,1,e),d=!0):239>=c&&(g=jb(5,1,e),d=!0);break;case 15:247>=c?(g=jb(6,
1,e),d=!0):255>=c&&(g=jb(7,1,e),d=!0)}switch(n){case 0:m.registerB=g;break;case 1:m.registerC=g;break;case 2:m.registerD=g;break;case 3:m.registerE=g;break;case 4:m.registerH=g;break;case 5:m.registerL=g;break;case 6:(4>D||7<D)&&Eb(f(m.registerH,m.registerL),g);break;case 7:m.registerA=g}d&&(a=4);m.programCounter=m.programCounter+1&65535;return a;case 204:if(1===ea())return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter+2),m.programCounter=Hb(),8;m.programCounter=m.programCounter+
2&65535;return 12;case 205:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter+2&65535),m.programCounter=Hb(),8;case 206:return bb(Y()),m.programCounter=m.programCounter+1&65535,4;case 207:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter),m.programCounter=8}return-1}
function Ab(a){switch(a){case 208:return 0===fa()?(m.programCounter=Fb(m.stackPointer),m.stackPointer=m.stackPointer+2&65535,12):8;case 209:return a=Fb(m.stackPointer),m.stackPointer=m.stackPointer+2&65535,m.registerD=h(a),m.registerE=a&255,4;case 210:if(0===fa())return m.programCounter=Hb(),8;m.programCounter=m.programCounter+2&65535;return 12;case 212:if(0===fa())return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter+2),m.programCounter=Hb(),8;m.programCounter=m.programCounter+
2&65535;return 12;case 213:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,f(m.registerD,m.registerE)),8;case 214:return cb(Y()),m.programCounter=m.programCounter+1&65535,4;case 215:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter),m.programCounter=16,8;case 216:return 1===fa()?(m.programCounter=Fb(m.stackPointer),m.stackPointer=m.stackPointer+2&65535,12):8;case 217:return m.programCounter=Fb(m.stackPointer),Ga(!0),m.stackPointer=m.stackPointer+2&65535,
8;case 218:if(1===fa())return m.programCounter=Hb(),8;m.programCounter=m.programCounter+2&65535;return 12;case 220:if(1===fa())return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter+2&65535),m.programCounter=Hb(),8;m.programCounter=m.programCounter+2&65535;return 12;case 222:return db(Y()),m.programCounter=m.programCounter+1&65535,4;case 223:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter),m.programCounter=24,8}return-1}
function Bb(a){switch(a){case 224:return a=Y(),Eb(65280+a,m.registerA),m.programCounter=m.programCounter+1&65535,4;case 225:return a=Fb(m.stackPointer),m.stackPointer=m.stackPointer+2&65535,m.registerH=h(a),m.registerL=a&255,4;case 226:return Eb(65280+m.registerC,m.registerA),4;case 229:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,f(m.registerH,m.registerL)),8;case 230:return eb(Y()),m.programCounter=m.programCounter+1&65535,4;case 231:return m.stackPointer=m.stackPointer-2&65535,
Gb(m.stackPointer,m.programCounter),m.programCounter=32,8;case 232:return a=ca(Y()),ia(m.stackPointer,a,!0),m.stackPointer=m.stackPointer+a&65535,p(0),q(0),m.programCounter=m.programCounter+1&65535,12;case 233:return m.programCounter=f(m.registerH,m.registerL),4;case 234:return Eb(Hb(),m.registerA),m.programCounter=m.programCounter+2&65535,4;case 238:return fb(Y()),m.programCounter=m.programCounter+1&65535,4;case 239:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter),
m.programCounter=40,8}return-1}
function Cb(a){switch(a){case 240:return a=Y(),m.registerA=X(65280+a)&255,m.programCounter=m.programCounter+1&65535,4;case 241:return a=Fb(m.stackPointer),m.stackPointer=m.stackPointer+2&65535,m.registerA=h(a),m.registerF=a&255,4;case 242:return m.registerA=X(65280+m.registerC)&255,4;case 243:return Ga(!1),4;case 245:return m.stackPointer=m.stackPointer-2&65535,Gb(m.stackPointer,f(m.registerA,m.registerF)),8;case 246:return gb(Y()),m.programCounter=m.programCounter+1&65535,4;case 247:return m.stackPointer=
m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter),m.programCounter=48,8;case 248:return a=ca(Y()),p(0),q(0),ia(m.stackPointer,a,!0),a=m.stackPointer+a&65535,m.registerH=h(a),m.registerL=a&255,m.programCounter=m.programCounter+1&65535,8;case 249:return m.stackPointer=f(m.registerH,m.registerL),8;case 250:return m.registerA=X(Hb()),m.programCounter=m.programCounter+2&65535,4;case 251:return Ga(!0),4;case 254:return hb(Y()),m.programCounter=m.programCounter+1&65535,4;case 255:return m.stackPointer=
m.stackPointer-2&65535,Gb(m.stackPointer,m.programCounter),m.programCounter=56,8}return-1}var Ib=function(){function a(){}a.cyclesPerCycleSet=2E9;a.cycleSets=0;a.cycles=0;return a}();
function Db(a){0<T.DMACycles&&(a+=T.DMACycles,T.DMACycles=0);m.currentCycles+=a;if(!m.isStopped){if(ba.graphicsBatchProcessing){if(y.currentCycles+=a,!(y.currentCycles<y.batchProcessCycles()))for(;y.currentCycles>=y.batchProcessCycles();)Ya(y.batchProcessCycles()),y.currentCycles-=y.batchProcessCycles()}else Ya(a);ba.audioBatchProcessing?M.currentCycles+=a:Ba(a);var c=a;if(R.transferStartFlag)for(var d=0;d<c;){var e=R.currentCycles;d+=4;R.currentCycles+=4;65535<R.currentCycles&&(R.currentCycles-=
65536);var g=R.currentCycles;var n=R.isClockSpeedFast?2:7;l(n,e)&&!l(n,g)&&(e=w(R.memoryLocationSerialTransferData),e=(e<<1)+1,e&=255,E(R.memoryLocationSerialTransferData,e),R.numberOfBitsTransferred+=1,8===R.numberOfBitsTransferred&&(R.numberOfBitsTransferred=0,P.isSerialInterruptRequested=!0,Ha(P.bitPositionSerialInterrupt),e=w(R.memoryLocationSerialTransferControl),E(R.memoryLocationSerialTransferControl,k(7,e)),R.transferStartFlag=!1))}}ba.timersBatchProcessing?(Q.currentCycles+=a,La(Q.currentCycles),
Q.currentCycles=0):La(a);Ib.cycles+=a;Ib.cycles>=Ib.cyclesPerCycleSet&&(Ib.cycleSets+=1,Ib.cycles-=Ib.cyclesPerCycleSet)}var Z=function(){function a(){}a.stepsPerStepSet=2E9;a.stepSets=0;a.steps=0;a.RESPONSE_CONDITION_ERROR=-1;a.RESPONSE_CONDITION_FRAME=0;a.RESPONSE_CONDITION_AUDIO=1;a.RESPONSE_CONDITION_BREAKPOINT=2;return a}();function Jb(){return Kb(!0,-1,-1)}
function Kb(a,c,d){void 0===c&&(c=-1);void 0===d&&(d=-1);a=1024;0<c?a=c:0>c&&(a=-1);for(var e=!1,g=!1,n=!1,D=!1;!(e||g||n||D);)c=Lb(),0>c?e=!0:m.currentCycles>=m.MAX_CYCLES_PER_FRAME()?g=!0:-1<a&&Da()>=a?n=!0:-1<d&&m.programCounter===d&&(D=!0);if(g)return m.currentCycles-=m.MAX_CYCLES_PER_FRAME(),Z.RESPONSE_CONDITION_FRAME;if(n)return Z.RESPONSE_CONDITION_AUDIO;if(D)return Z.RESPONSE_CONDITION_BREAKPOINT;m.programCounter=m.programCounter-1&65535;return-1}
function Lb(){Mb=!0;if(m.isHaltBug){var a=w(m.programCounter);a=lb(a);Db(a);m.exitHaltAndStop()}P.masterInterruptSwitchDelay&&(P.masterInterruptSwitch=!0,P.masterInterruptSwitchDelay=!1);if(0<(P.interruptsEnabledValue&P.interruptsRequestedValue&31)){a=!1;P.masterInterruptSwitch&&!m.isHaltNoJump&&(P.isVBlankInterruptEnabled&&P.isVBlankInterruptRequested?(Fa(P.bitPositionVBlankInterrupt),a=!0):P.isLcdInterruptEnabled&&P.isLcdInterruptRequested?(Fa(P.bitPositionLcdInterrupt),a=!0):P.isTimerInterruptEnabled&&
P.isTimerInterruptRequested?(Fa(P.bitPositionTimerInterrupt),a=!0):P.isSerialInterruptEnabled&&P.isSerialInterruptRequested?(Fa(P.bitPositionSerialInterrupt),a=!0):P.isJoypadInterruptEnabled&&P.isJoypadInterruptRequested&&(Fa(P.bitPositionJoypadInterrupt),a=!0));var c=0;a&&(c=20,m.isHalted()&&(m.exitHaltAndStop(),c+=4));m.isHalted()&&m.exitHaltAndStop();a=c}else a=0;0<a&&Db(a);a=4;m.isHalted()||m.isStopped||(a=w(m.programCounter),a=lb(a));m.registerF&=240;if(0>=a)return a;Db(a);Z.steps+=1;Z.steps>=
Z.stepsPerStepSet&&(Z.stepSets+=1,Z.steps-=Z.stepsPerStepSet);return a}140>aa.size()&&aa.grow(140-aa.size());
var Mb=!1,Nb=Object.freeze({memory:aa,config:function(a,c,d,e,g,n,D,v,I){ba.enableBootRom=0<a?!0:!1;ba.useGbcWhenAvailable=0<c?!0:!1;ba.audioBatchProcessing=0<d?!0:!1;ba.graphicsBatchProcessing=0<e?!0:!1;ba.timersBatchProcessing=0<g?!0:!1;ba.graphicsDisableScanlineRendering=0<n?!0:!1;ba.audioAccumulateSamples=0<D?!0:!1;ba.tileRendering=0<v?!0:!1;ba.tileCaching=0<I?!0:!1;a=w(323);m.GBCEnabled=192===a||ba.useGbcWhenAvailable&&128===a?!0:!1;m.GBCDoubleSpeed=!1;m.registerA=0;m.registerB=0;m.registerC=
0;m.registerD=0;m.registerE=0;m.registerH=0;m.registerL=0;m.registerF=0;m.stackPointer=0;m.programCounter=0;m.currentCycles=0;m.isHaltNormal=!1;m.isHaltNoJump=!1;m.isHaltBug=!1;m.isStopped=!1;m.GBCEnabled?(m.registerA=17,m.registerF=128,m.registerB=0,m.registerC=0,m.registerD=255,m.registerE=86,m.registerH=0,m.registerL=13):(m.registerA=1,m.registerF=176,m.registerB=0,m.registerC=19,m.registerD=0,m.registerE=216,m.registerH=1,m.registerL=77);m.programCounter=256;m.stackPointer=65534;T.isRamBankingEnabled=
!1;T.isMBC1RomModeEnabled=!0;a=w(327);T.isRomOnly=!1;T.isMBC1=!1;T.isMBC2=!1;T.isMBC3=!1;T.isMBC5=!1;0===a?T.isRomOnly=!0:1<=a&&3>=a?T.isMBC1=!0:5<=a&&6>=a?T.isMBC2=!0:15<=a&&19>=a?T.isMBC3=!0:25<=a&&30>=a&&(T.isMBC5=!0);T.currentRomBank=1;T.currentRamBank=0;E(65361,255);E(65362,255);E(65363,255);E(65364,255);E(65365,255);y.currentCycles=0;y.scanlineCycleCounter=0;y.scanlineRegister=0;y.scrollX=0;y.scrollY=0;y.windowX=0;y.windowY=0;m.GBCEnabled?(y.scanlineRegister=144,E(65344,145),E(65345,129),E(65348,
144),E(65351,252)):(y.scanlineRegister=144,E(65344,145),E(65345,133),E(65350,255),E(65351,252),E(65352,255),E(65353,255));E(65359,0);E(65392,1);m.GBCEnabled?(E(65384,192),E(65385,255),E(65386,193),E(65387,13)):(E(65384,255),E(65385,255),E(65386,255),E(65387,255));M.currentCycles=0;M.NR50LeftMixerVolume=0;M.NR50RightMixerVolume=0;M.NR51IsChannel1EnabledOnLeftOutput=!0;M.NR51IsChannel2EnabledOnLeftOutput=!0;M.NR51IsChannel3EnabledOnLeftOutput=!0;M.NR51IsChannel4EnabledOnLeftOutput=!0;M.NR51IsChannel1EnabledOnRightOutput=
!0;M.NR51IsChannel2EnabledOnRightOutput=!0;M.NR51IsChannel3EnabledOnRightOutput=!0;M.NR51IsChannel4EnabledOnRightOutput=!0;M.NR52IsSoundEnabled=!0;M.frameSequenceCycleCounter=0;M.downSampleCycleCounter=0;M.frameSequencer=0;M.audioQueueIndex=0;F.initialize();G.initialize();H.initialize();K.initialize();E(M.memoryLocationNR50,119);E(M.memoryLocationNR51,243);E(M.memoryLocationNR52,241);L.channel1Sample=15;L.channel2Sample=15;L.channel3Sample=15;L.channel4Sample=15;L.channel1DacEnabled=!1;L.channel2DacEnabled=
!1;L.channel3DacEnabled=!1;L.channel4DacEnabled=!1;L.leftChannelSampleUnsignedByte=127;L.rightChannelSampleUnsignedByte=127;L.mixerVolumeChanged=!0;L.mixerEnabledChanged=!0;L.needToRemixSamples=!1;P.updateInterruptEnabled(0);E(P.memoryLocationInterruptEnabled,P.interruptsEnabledValue);P.updateInterruptRequested(225);E(P.memoryLocationInterruptRequest,P.interruptsRequestedValue);Q.currentCycles=0;Q.dividerRegister=0;Q.timerCounter=0;Q.timerModulo=0;Q.timerEnabled=!1;Q.timerInputClock=0;Q.timerCounterOverflowDelay=
!1;Q.timerCounterWasReset=!1;m.GBCEnabled?(E(65284,30),Q.dividerRegister=7840):(E(65284,171),Q.dividerRegister=43980);E(65287,248);Q.timerInputClock=248;R.currentCycles=0;R.numberOfBitsTransferred=0;m.GBCEnabled?(E(65282,124),R.updateTransferControl(124)):(E(65282,126),R.updateTransferControl(126));m.GBCEnabled?(E(65392,248),E(65359,254),E(65357,126),E(65280,207),E(65295,225),E(65388,254),E(65397,143)):(E(65392,255),E(65359,255),E(65357,255),E(65280,207),E(65295,225));Mb=!1;Ib.cyclesPerCycleSet=2E9;
Ib.cycleSets=0;Ib.cycles=0;Z.stepsPerStepSet=2E9;Z.stepSets=0;Z.steps=0},hasCoreStarted:function(){return Mb?1:0},saveState:function(){m.saveState();y.saveState();P.saveState();S.saveState();T.saveState();Q.saveState();M.saveState();F.saveState();G.saveState();H.saveState();K.saveState();Mb=!1},loadState:function(){m.loadState();y.loadState();P.loadState();S.loadState();T.loadState();Q.loadState();M.loadState();F.loadState();G.loadState();H.loadState();K.loadState();Mb=!1;Ib.cyclesPerCycleSet=2E9;
Ib.cycleSets=0;Ib.cycles=0;Z.stepsPerStepSet=2E9;Z.stepSets=0;Z.steps=0},getStepsPerStepSet:function(){return Z.stepsPerStepSet},getStepSets:function(){return Z.stepSets},getSteps:function(){return Z.steps},executeMultipleFrames:function(a){for(var c=0,d=0;d<a&&0<=c;)c=Jb(),d+=1;return 0>c?c:0},executeFrame:Jb,executeFrameAndCheckAudio:function(a){void 0===a&&(a=0);return Kb(!0,a,-1)},executeFrameUntilBreakpoint:function(a){return Kb(!0,-1,a)},executeFrameAndCheckAudioUntilBreakpoint:function(a,c){return Kb(!0,
a,c)},executeUntilCondition:Kb,executeStep:Lb,getCyclesPerCycleSet:function(){return Ib.cyclesPerCycleSet},getCycleSets:function(){return Ib.cycleSets},getCycles:function(){return Ib.cycles},setJoypadState:function(a,c,d,e,g,n,D,v){0<a?Ma(0):Oa(0,!1);0<c?Ma(1):Oa(1,!1);0<d?Ma(2):Oa(2,!1);0<e?Ma(3):Oa(3,!1);0<g?Ma(4):Oa(4,!1);0<n?Ma(5):Oa(5,!1);0<D?Ma(6):Oa(6,!1);0<v?Ma(7):Oa(7,!1)},getNumberOfSamplesInAudioBuffer:Da,clearAudioBuffer:xa,WASMBOY_MEMORY_LOCATION:0,WASMBOY_MEMORY_SIZE:9175040,WASMBOY_WASM_PAGES:140,
ASSEMBLYSCRIPT_MEMORY_LOCATION:0,ASSEMBLYSCRIPT_MEMORY_SIZE:1024,WASMBOY_STATE_LOCATION:1024,WASMBOY_STATE_SIZE:1024,GAMEBOY_INTERNAL_MEMORY_LOCATION:2048,GAMEBOY_INTERNAL_MEMORY_SIZE:65535,VIDEO_RAM_LOCATION:2048,VIDEO_RAM_SIZE:16384,WORK_RAM_LOCATION:18432,WORK_RAM_SIZE:32768,OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION:51200,OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE:16384,GRAPHICS_OUTPUT_LOCATION:67584,GRAPHICS_OUTPUT_SIZE:521216,GBC_PALETTE_LOCATION:67584,GBC_PALETTE_SIZE:512,BG_PRIORITY_MAP_LOCATION:69632,
BG_PRIORITY_MAP_SIZE:23552,FRAME_LOCATION:93184,FRAME_SIZE:93184,BACKGROUND_MAP_LOCATION:232448,BACKGROUND_MAP_SIZE:196608,TILE_DATA_LOCATION:429056,TILE_DATA_SIZE:147456,OAM_TILES_LOCATION:576512,OAM_TILES_SIZE:12288,AUDIO_BUFFER_LOCATION:588800,AUDIO_BUFFER_SIZE:131072,CARTRIDGE_RAM_LOCATION:719872,CARTRIDGE_RAM_SIZE:131072,CARTRIDGE_ROM_LOCATION:850944,CARTRIDGE_ROM_SIZE:8258560,DEBUG_GAMEBOY_MEMORY_LOCATION:9109504,DEBUG_GAMEBOY_MEMORY_SIZE:65535,getWasmBoyOffsetFromGameBoyOffset:Sa,getRegisterA:function(){return m.registerA},
getRegisterB:function(){return m.registerB},getRegisterC:function(){return m.registerC},getRegisterD:function(){return m.registerD},getRegisterE:function(){return m.registerE},getRegisterH:function(){return m.registerH},getRegisterL:function(){return m.registerL},getRegisterF:function(){return m.registerF},getProgramCounter:function(){return m.programCounter},getStackPointer:function(){return m.stackPointer},getOpcodeAtProgramCounter:function(){return w(m.programCounter)},getLY:function(){return y.scanlineRegister},
drawBackgroundMapToWasmMemory:function(a){var c=y.memoryLocationTileDataSelectZeroStart;U.bgWindowTileDataSelect&&(c=y.memoryLocationTileDataSelectOneStart);var d=y.memoryLocationTileMapSelectZeroStart;U.bgTileMapDisplaySelect&&(d=y.memoryLocationTileMapSelectOneStart);for(var e=0;256>e;e++)for(var g=0;256>g;g++){var n=e,D=g,v=d+32*(n>>3)+(D>>3),I=sa(v,0);I=ra(c,I);var x=n%8;n=D%8;n=7-n;D=0;m.GBCEnabled&&0<a&&(D=sa(v,1));l(6,D)&&(x=7-x);var N=0;l(3,D)&&(N=1);v=sa(I+2*x,N);I=sa(I+2*x+1,N);x=0;l(n,
I)&&(x+=1,x<<=1);l(n,v)&&(x+=1);I=3*(256*e+g);if(m.GBCEnabled&&0<a)D=la(D&7,x,!1),n=na(0,D),v=na(1,D),x=na(2,D),D=232448+I,b[D]=n,b[D+1]=v,b[D+2]=x;else for(n=ka(x,y.memoryLocationBackgroundPalette),v=0;3>v;v++)D=232448+I+v,b[D]=n}},drawTileDataToWasmMemory:function(){for(var a=0;23>a;a++)for(var c=0;31>c;c++){var d=0;15<c&&(d=1);var e=a;15<a&&(e-=15);e<<=4;e=15<c?e+(c-15):e+c;var g=y.memoryLocationTileDataSelectOneStart;15<a&&(g=y.memoryLocationTileDataSelectZeroStart);for(var n=0;8>n;n++)qa(e,g,
d,0,7,n,8*c,8*a+n,248,429056,!0,0,-1)}},getDIV:function(){return Q.dividerRegister},getTIMA:function(){return Q.timerCounter},getTMA:function(){return Q.timerModulo},getTAC:function(){var a=Q.timerInputClock;Q.timerEnabled&&(a|=4);return a},updateDebugGBMemory:function(){for(var a=0;65535>=a;a++){var c=Qa(a);b[9109504+a]=c}},update:Jb,emulationStep:Lb,getAudioQueueIndex:Da,resetAudioQueue:xa,wasmMemorySize:9175040,wasmBoyInternalStateLocation:1024,wasmBoyInternalStateSize:1024,gameBoyInternalMemoryLocation:2048,
gameBoyInternalMemorySize:65535,videoOutputLocation:67584,frameInProgressVideoOutputLocation:93184,gameboyColorPaletteLocation:67584,gameboyColorPaletteSize:512,backgroundMapLocation:232448,tileDataMap:429056,soundOutputLocation:588800,gameBytesLocation:850944,gameRamBanksLocation:719872});export default async()=>({instance:{exports:Nb},byteMemory:aa.wasmByteMemory,type:"TypeScript"});
