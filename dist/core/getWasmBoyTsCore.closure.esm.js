const b=new Uint8ClampedArray(9109504),aa={size:()=>9109504,grow:()=>{},wasmByteMemory:b};
var ba=91264,ca=ba+93184,da=ca+196608,ea=da+147456,fa=ea-67584+15360,ha=ea+15360,ia=ha+131072,ja=ia+131072,ka=ja+131072,la=ka+131072,ma=la+131072,na=ma+131072,oa=na+8258560,pa=oa+65535+1,qa=Math.ceil(pa/1024/64)+1,g=function(){function a(){}a.enableBootRom=!1;a.useGbcWhenAvailable=!0;a.audioBatchProcessing=!1;a.graphicsBatchProcessing=!1;a.timersBatchProcessing=!1;a.graphicsDisableScanlineRendering=!1;a.audioAccumulateSamples=!1;a.tileRendering=!1;a.tileCaching=!1;a.enableAudioDebugging=!1;return a}();
function h(a,c){return(a&255)<<8|c&255}function k(a){return(a&65280)>>8}function l(a,c){return c&~(1<<a)}function n(a,c){return 0!=(c&1<<a)}function ra(a){var c=a;n(7,c)&&(c=-1*(256-a));return c}function sa(a,c){a=1<<a&255;p.registerF=0<c?p.registerF|a:p.registerF&(255^a);return p.registerF}function q(a){sa(7,a)}function r(a){sa(6,a)}function t(a){sa(5,a)}function u(a){sa(4,a)}function ta(){return p.registerF>>7&1}function ua(){return p.registerF>>4&1}
function va(a,c){0<=c?0!==((a&15)+(c&15)&16)?t(1):t(0):(Math.abs(c)&15)>(a&15)?t(1):t(0)}function wa(a,c){0<=c?a>(a+c&255)?u(1):u(0):Math.abs(c)>a?u(1):u(0)}function xa(a,c,d){d?(a=a^c^a+c,0!==(a&16)?t(1):t(0),0!==(a&256)?u(1):u(0)):(d=a+c&65535,d<a?u(1):u(0),0!==((a^c^d)&4096)?t(1):t(0))}var Aa=function(){function a(){}a.memoryLocationBackgroundPaletteIndex=65384;a.memoryLocationBackgroundPaletteData=65385;a.memoryLocationSpritePaletteIndex=65386;a.memoryLocationSpritePaletteData=65387;return a}();
function Ba(a,c,d){void 0===d&&(d=!1);var e=a;d||(e=v(c)>>2*a&3);a=242;switch(e){case 1:a=160;break;case 2:a=88;break;case 3:a=8}return a}function Ca(a,c,d){c=8*a+2*c;a=Da(c+1,d);d=Da(c,d);return h(a,d)}function Ea(a,c){return 8*((c&31<<5*a)>>5*a)}function Da(a,c){a&=63;c&&(a+=64);return b[67584+a]}function Fa(a,c,d,e){void 0===d&&(d=0);void 0===e&&(e=!1);d&=3;e&&(d|=4);b[67712+(160*c+a)]=d}var Ga=function(){function a(){}a.tileId=-1;a.horizontalFlip=!1;a.nextXIndexToPerformCacheCheck=-1;return a}();
function Ha(a,c,d,e,f,m,z,w,I,x,N,B,C){var W=0;c=Ia(c,a);a=Ja(c+2*m,d);d=Ja(c+2*m+1,d);for(m=e;m<=f;m++)if(c=z+(m-e),c<I){var O=m;if(0>C||!n(5,C))O=7-O;var X=0;n(O,d)&&(X+=1,X<<=1);n(O,a)&&(X+=1);if(0<=C){var K=Ca(C&7,X,!1);O=Ea(0,K);var ya=Ea(1,K);K=Ea(2,K)}else 0>=B&&(B=y.memoryLocationBackgroundPalette),ya=O=K=Ba(X,B,N);var za=3*(w*I+c);b[x+za]=O;b[x+za+1]=ya;b[x+za+2]=K;O=!1;0<=C&&(O=n(7,C));Fa(c,w,X,O);W++}return W}
function Ia(a,c){if(a===y.memoryLocationTileDataSelectZeroStart){var d=c+128;n(7,c)&&(d=c-128);return a+16*d}return a+16*c}function Ka(a,c){switch(a){case 1:return n(c,129);case 2:return n(c,135);case 3:return n(c,126);default:return n(c,1)}}
var F=function(){function a(){}a.updateNRx0=function(c){a.NRx0SweepPeriod=(c&112)>>4;a.NRx0Negate=n(3,c);a.NRx0SweepShift=c&7};a.updateNRx1=function(c){a.NRx1Duty=c>>6&3;a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=n(3,c);a.NRx2EnvelopePeriod=c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=function(c){a.NRx4LengthEnabled=
n(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=function(){A(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.dutyCycle;b[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty;A(1049+50*a.saveStateSlot,a.isSweepEnabled);b[1050+50*a.saveStateSlot]=a.sweepCounter;b[1055+50*
a.saveStateSlot]=a.sweepShadowFrequency};a.loadState=function(){a.isEnabled=D(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];a.volume=b[1038+50*a.saveStateSlot];a.dutyCycle=b[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=b[1044+50*a.saveStateSlot];a.isSweepEnabled=D(1049+50*a.saveStateSlot);a.sweepCounter=b[1050+50*a.saveStateSlot];a.sweepShadowFrequency=b[1055+50*a.saveStateSlot]};a.initialize=
function(){E(a.memoryLocationNRx0,128);E(a.memoryLocationNRx1,191);E(a.memoryLocationNRx2,243);E(a.memoryLocationNRx3,193);E(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=4*(2048-a.frequency);p.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=c,a.waveFormPositionOnDuty+=
1,8<=a.waveFormPositionOnDuty&&(a.waveFormPositionOnDuty=0));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=1;Ka(a.NRx1Duty,a.waveFormPositionOnDuty)||(d*=-1);return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.sweepShadowFrequency=a.frequency;a.sweepCounter=a.NRx0SweepPeriod;a.isSweepEnabled=0<a.NRx0SweepPeriod&&0<a.NRx0SweepShift?!0:!1;0<a.NRx0SweepShift&&
La();a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.updateSweep=function(){--a.sweepCounter;0>=a.sweepCounter&&(a.sweepCounter=a.NRx0SweepPeriod,a.isSweepEnabled&&0<a.NRx0SweepPeriod&&La())};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,
0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&0<a.volume&&--a.volume))};a.setFrequency=function(c){var d=c>>8;c&=255;var e=v(a.memoryLocationNRx4)&248|d;E(a.memoryLocationNRx3,c);E(a.memoryLocationNRx4,e);a.NRx3FrequencyLSB=c;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.memoryLocationNRx0=65296;a.NRx0SweepPeriod=0;a.NRx0Negate=!1;a.NRx0SweepShift=0;a.memoryLocationNRx1=65297;a.NRx1Duty=0;a.NRx1LengthLoad=
0;a.memoryLocationNRx2=65298;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65299;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65300;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=1;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.isSweepEnabled=!1;a.sweepCounter=0;a.sweepShadowFrequency=0;a.saveStateSlot=7;return a}();
function La(){var a=Ma();2047>=a&&0<F.NRx0SweepShift&&(F.sweepShadowFrequency=a,F.setFrequency(a),a=Ma());2047<a&&(F.isEnabled=!1)}function Ma(){var a=F.sweepShadowFrequency;a>>=F.NRx0SweepShift;return a=F.NRx0Negate?F.sweepShadowFrequency-a:F.sweepShadowFrequency+a}
var G=function(){function a(){}a.updateNRx1=function(c){a.NRx1Duty=c>>6&3;a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=n(3,c);a.NRx2EnvelopePeriod=c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=function(c){a.NRx4LengthEnabled=n(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=
function(){A(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.dutyCycle;b[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty};a.loadState=function(){a.isEnabled=D(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];
a.volume=b[1038+50*a.saveStateSlot];a.dutyCycle=b[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=b[1044+50*a.saveStateSlot]};a.initialize=function(){E(a.memoryLocationNRx1-1,255);E(a.memoryLocationNRx1,63);E(a.memoryLocationNRx2,0);E(a.memoryLocationNRx3,0);E(a.memoryLocationNRx4,184)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=4*(2048-a.frequency);p.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=
function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=c,a.waveFormPositionOnDuty+=1,8<=a.waveFormPositionOnDuty&&(a.waveFormPositionOnDuty=0));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=1;Ka(a.NRx1Duty,a.waveFormPositionOnDuty)||(d*=-1);return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.isDacEnabled||
(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&0<a.volume&&--a.volume))};a.setFrequency=function(c){var d=
c>>8;c&=255;var e=v(a.memoryLocationNRx4)&248|d;E(a.memoryLocationNRx3,c);E(a.memoryLocationNRx4,e);a.NRx3FrequencyLSB=c;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.memoryLocationNRx1=65302;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65303;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65304;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65305;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=
2;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.saveStateSlot=8;return a}(),H=function(){function a(){}a.updateNRx0=function(c){a.isDacEnabled=n(7,c)};a.updateNRx1=function(c){a.NRx1LengthLoad=c;a.lengthCounter=256-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2VolumeCode=c>>5&15};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=
function(c){a.NRx4LengthEnabled=n(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=function(){A(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.lengthCounter;b[1033+50*a.saveStateSlot]=a.waveTablePosition};a.loadState=function(){a.isEnabled=D(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.lengthCounter=b[1029+50*a.saveStateSlot];a.waveTablePosition=b[1033+50*a.saveStateSlot]};
a.initialize=function(){E(a.memoryLocationNRx0,127);E(a.memoryLocationNRx1,255);E(a.memoryLocationNRx2,159);E(a.memoryLocationNRx3,0);E(a.memoryLocationNRx4,184);a.volumeCodeChanged=!0};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=2*(2048-a.frequency);p.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=
c,a.waveTablePosition+=1,32<=a.waveTablePosition&&(a.waveTablePosition=0));c=0;var d=a.volumeCode;if(a.isEnabled&&a.isDacEnabled)a.volumeCodeChanged&&(d=v(a.memoryLocationNRx2),d=d>>5&15,a.volumeCode=d,a.volumeCodeChanged=!1);else return 15;var e=v(a.memoryLocationWaveTable+(a.waveTablePosition/2|0));e=0===a.waveTablePosition%2?e>>4&15:e&15;switch(d){case 0:e>>=4;break;case 1:c=1;break;case 2:e>>=1;c=2;break;default:e>>=2,c=4}return(0<c?e/c:0)+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&
(a.lengthCounter=256);a.resetTimer();a.waveTablePosition=0;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter&&!a.volumeCodeChanged?!1:!0};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.cycleCounter=0;a.memoryLocationNRx0=65306;a.memoryLocationNRx1=65307;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65308;a.NRx2VolumeCode=0;a.memoryLocationNRx3=65309;a.NRx3FrequencyLSB=
0;a.memoryLocationNRx4=65310;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.memoryLocationWaveTable=65328;a.channelNumber=3;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.lengthCounter=0;a.waveTablePosition=0;a.volumeCode=0;a.volumeCodeChanged=!1;a.saveStateSlot=9;return a}(),J=function(){function a(){}a.updateNRx1=function(c){a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=n(3,c);a.NRx2EnvelopePeriod=
c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3ClockShift=c>>4;a.NRx3WidthMode=n(3,c);a.NRx3DivisorCode=c&7;switch(a.NRx3DivisorCode){case 0:a.divisor=8;break;case 1:a.divisor=16;break;case 2:a.divisor=32;break;case 3:a.divisor=48;break;case 4:a.divisor=64;break;case 5:a.divisor=80;break;case 6:a.divisor=96;break;case 7:a.divisor=112}};a.updateNRx4=function(c){a.NRx4LengthEnabled=n(6,c)};a.saveState=function(){A(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;
b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.linearFeedbackShiftRegister};a.loadState=function(){a.isEnabled=D(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];a.volume=b[1038+50*a.saveStateSlot];a.linearFeedbackShiftRegister=b[1043+50*a.saveStateSlot]};a.initialize=function(){E(a.memoryLocationNRx1-
1,255);E(a.memoryLocationNRx1,255);E(a.memoryLocationNRx2,0);E(a.memoryLocationNRx3,0);E(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.frequencyTimer=a.getNoiseChannelFrequencyPeriod(),a.frequencyTimer-=c,c=a.linearFeedbackShiftRegister&1^a.linearFeedbackShiftRegister>>1&1,a.linearFeedbackShiftRegister>>=1,a.linearFeedbackShiftRegister|=
c<<14,a.NRx3WidthMode&&(a.linearFeedbackShiftRegister&=-65,a.linearFeedbackShiftRegister|=c<<6));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=n(0,a.linearFeedbackShiftRegister)?-1:1;return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.frequencyTimer=a.getNoiseChannelFrequencyPeriod();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.linearFeedbackShiftRegister=32767;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=
function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.getNoiseChannelFrequencyPeriod=function(){var c=a.divisor<<a.NRx3ClockShift;p.GBCDoubleSpeed&&(c*=2);return c};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&
0<a.volume&&--a.volume))};a.cycleCounter=0;a.memoryLocationNRx1=65312;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65313;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65314;a.NRx3ClockShift=0;a.NRx3WidthMode=!1;a.NRx3DivisorCode=0;a.memoryLocationNRx4=65315;a.NRx4LengthEnabled=!1;a.channelNumber=4;a.isEnabled=!1;a.isDacEnabled=!1;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.divisor=0;a.linearFeedbackShiftRegister=0;a.saveStateSlot=
10;return a}(),L=function(){function a(){}a.channel1Sample=15;a.channel2Sample=15;a.channel3Sample=15;a.channel4Sample=15;a.channel1DacEnabled=!1;a.channel2DacEnabled=!1;a.channel3DacEnabled=!1;a.channel4DacEnabled=!1;a.leftChannelSampleUnsignedByte=127;a.rightChannelSampleUnsignedByte=127;a.mixerVolumeChanged=!1;a.mixerEnabledChanged=!1;a.needToRemixSamples=!1;return a}();
function Na(a){switch(a){case F.channelNumber:if(L.channel1DacEnabled!==F.isDacEnabled)return L.channel1DacEnabled=F.isDacEnabled,!0;break;case G.channelNumber:if(L.channel2DacEnabled!==G.isDacEnabled)return L.channel2DacEnabled=G.isDacEnabled,!0;break;case H.channelNumber:if(L.channel3DacEnabled!==H.isDacEnabled)return L.channel3DacEnabled=H.isDacEnabled,!0;break;case J.channelNumber:if(L.channel4DacEnabled!==J.isDacEnabled)return L.channel4DacEnabled=J.isDacEnabled,!0}return!1}
var M=function(){function a(){}a.batchProcessCycles=function(){return p.GBCDoubleSpeed?174:87};a.updateNR50=function(c){a.NR50LeftMixerVolume=c>>4&7;a.NR50RightMixerVolume=c&7};a.updateNR51=function(c){a.NR51IsChannel4EnabledOnLeftOutput=n(7,c);a.NR51IsChannel3EnabledOnLeftOutput=n(6,c);a.NR51IsChannel2EnabledOnLeftOutput=n(5,c);a.NR51IsChannel1EnabledOnLeftOutput=n(4,c);a.NR51IsChannel4EnabledOnRightOutput=n(3,c);a.NR51IsChannel3EnabledOnRightOutput=n(2,c);a.NR51IsChannel2EnabledOnRightOutput=n(1,
c);a.NR51IsChannel1EnabledOnRightOutput=n(0,c)};a.updateNR52=function(c){a.NR52IsSoundEnabled=n(7,c)};a.maxFrameSequenceCycles=function(){return p.GBCDoubleSpeed?16384:8192};a.maxDownSampleCycles=function(){return p.CLOCK_SPEED()};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.frameSequenceCycleCounter;b[1028+50*a.saveStateSlot]=a.downSampleCycleCounter;b[1029+50*a.saveStateSlot]=a.frameSequencer};a.loadState=function(){a.frameSequenceCycleCounter=b[1024+50*a.saveStateSlot];a.downSampleCycleCounter=
b[1028+50*a.saveStateSlot];a.frameSequencer=b[1029+50*a.saveStateSlot];Oa()};a.currentCycles=0;a.memoryLocationNR50=65316;a.NR50LeftMixerVolume=0;a.NR50RightMixerVolume=0;a.memoryLocationNR51=65317;a.NR51IsChannel1EnabledOnLeftOutput=!0;a.NR51IsChannel2EnabledOnLeftOutput=!0;a.NR51IsChannel3EnabledOnLeftOutput=!0;a.NR51IsChannel4EnabledOnLeftOutput=!0;a.NR51IsChannel1EnabledOnRightOutput=!0;a.NR51IsChannel2EnabledOnRightOutput=!0;a.NR51IsChannel3EnabledOnRightOutput=!0;a.NR51IsChannel4EnabledOnRightOutput=
!0;a.memoryLocationNR52=65318;a.NR52IsSoundEnabled=!0;a.memoryLocationChannel3LoadRegisterStart=65328;a.frameSequenceCycleCounter=0;a.downSampleCycleCounter=0;a.downSampleCycleMultiplier=48E3;a.frameSequencer=0;a.audioQueueIndex=0;a.wasmBoyMemoryMaxBufferSize=131072;a.saveStateSlot=6;return a}();function Pa(){if(!(M.currentCycles<M.batchProcessCycles()))for(;M.currentCycles>=M.batchProcessCycles();)Qa(M.batchProcessCycles()),M.currentCycles-=M.batchProcessCycles()}
function Qa(a){M.frameSequenceCycleCounter+=a;if(M.frameSequenceCycleCounter>=M.maxFrameSequenceCycles()){M.frameSequenceCycleCounter-=M.maxFrameSequenceCycles();switch(M.frameSequencer){case 0:F.updateLength();G.updateLength();H.updateLength();J.updateLength();break;case 2:F.updateLength();G.updateLength();H.updateLength();J.updateLength();F.updateSweep();break;case 4:F.updateLength();G.updateLength();H.updateLength();J.updateLength();break;case 6:F.updateLength();G.updateLength();H.updateLength();
J.updateLength();F.updateSweep();break;case 7:F.updateEnvelope(),G.updateEnvelope(),J.updateEnvelope()}M.frameSequencer+=1;8<=M.frameSequencer&&(M.frameSequencer=0);var c=!0}else c=!1;if(g.audioAccumulateSamples&&!c){c=F.willChannelUpdate(a)||Na(F.channelNumber);var d=G.willChannelUpdate(a)||Na(G.channelNumber),e=H.willChannelUpdate(a)||Na(H.channelNumber),f=J.willChannelUpdate(a)||Na(J.channelNumber);c&&(L.channel1Sample=F.getSampleFromCycleCounter());d&&(L.channel2Sample=G.getSampleFromCycleCounter());
e&&(L.channel3Sample=H.getSampleFromCycleCounter());f&&(L.channel4Sample=J.getSampleFromCycleCounter());if(c||d||e||f)L.needToRemixSamples=!0;M.downSampleCycleCounter+=a*M.downSampleCycleMultiplier;M.downSampleCycleCounter>=M.maxDownSampleCycles()&&(M.downSampleCycleCounter-=M.maxDownSampleCycles(),(L.needToRemixSamples||L.mixerVolumeChanged||L.mixerEnabledChanged)&&Ra(L.channel1Sample,L.channel2Sample,L.channel3Sample,L.channel4Sample),Sa(L.leftChannelSampleUnsignedByte+1,L.rightChannelSampleUnsignedByte+
1,la),M.audioQueueIndex+=1,M.audioQueueIndex>=(M.wasmBoyMemoryMaxBufferSize/2|0)-1&&--M.audioQueueIndex)}else if(c=F.getSample(a)|0,d=G.getSample(a)|0,e=H.getSample(a)|0,f=J.getSample(a)|0,L.channel1Sample=c,L.channel2Sample=d,L.channel3Sample=e,L.channel4Sample=f,M.downSampleCycleCounter+=a*M.downSampleCycleMultiplier,M.downSampleCycleCounter>=M.maxDownSampleCycles()){M.downSampleCycleCounter-=M.maxDownSampleCycles();a=Ra(c,d,e,f);var m=k(a);Sa(m+1,(a&255)+1,la);g.enableAudioDebugging&&(a=Ra(c,15,
15,15),m=k(a),Sa(m+1,(a&255)+1,ha),a=Ra(15,d,15,15),m=k(a),Sa(m+1,(a&255)+1,ia),a=Ra(15,15,e,15),m=k(a),Sa(m+1,(a&255)+1,ja),a=Ra(15,15,15,f),m=k(a),Sa(m+1,(a&255)+1,ka));M.audioQueueIndex+=1;M.audioQueueIndex>=(M.wasmBoyMemoryMaxBufferSize/2|0)-1&&--M.audioQueueIndex}}function Ta(){return M.audioQueueIndex}function Oa(){M.audioQueueIndex=0}
function Ra(a,c,d,e){void 0===a&&(a=15);void 0===c&&(c=15);void 0===d&&(d=15);void 0===e&&(e=15);L.mixerVolumeChanged=!1;var f=0,m=0;f=M.NR51IsChannel1EnabledOnLeftOutput?f+a:f+15;f=M.NR51IsChannel2EnabledOnLeftOutput?f+c:f+15;f=M.NR51IsChannel3EnabledOnLeftOutput?f+d:f+15;f=M.NR51IsChannel4EnabledOnLeftOutput?f+e:f+15;m=M.NR51IsChannel1EnabledOnRightOutput?m+a:m+15;m=M.NR51IsChannel2EnabledOnRightOutput?m+c:m+15;m=M.NR51IsChannel3EnabledOnRightOutput?m+d:m+15;m=M.NR51IsChannel4EnabledOnRightOutput?
m+e:m+15;L.mixerEnabledChanged=!1;L.needToRemixSamples=!1;a=Ua(f,M.NR50LeftMixerVolume+1);m=Ua(m,M.NR50RightMixerVolume+1);L.leftChannelSampleUnsignedByte=a;L.rightChannelSampleUnsignedByte=m;return h(a,m)}function Ua(a,c){if(60===a)return 127;a=1E5*(a-60)*c/8|0;a=a/1E5|0;a+=60;a=1E5*a/(12E6/254|0)|0;return a|=0}function Sa(a,c,d){d+=2*M.audioQueueIndex;b[d]=a+1;b[d+1]=c+1}
var P=function(){function a(){}a.updateInterruptEnabled=function(c){a.isVBlankInterruptEnabled=n(a.bitPositionVBlankInterrupt,c);a.isLcdInterruptEnabled=n(a.bitPositionLcdInterrupt,c);a.isTimerInterruptEnabled=n(a.bitPositionTimerInterrupt,c);a.isSerialInterruptEnabled=n(a.bitPositionSerialInterrupt,c);a.isJoypadInterruptEnabled=n(a.bitPositionJoypadInterrupt,c);a.interruptsEnabledValue=c};a.updateInterruptRequested=function(c){a.isVBlankInterruptRequested=n(a.bitPositionVBlankInterrupt,c);a.isLcdInterruptRequested=
n(a.bitPositionLcdInterrupt,c);a.isTimerInterruptRequested=n(a.bitPositionTimerInterrupt,c);a.isSerialInterruptRequested=n(a.bitPositionSerialInterrupt,c);a.isJoypadInterruptRequested=n(a.bitPositionJoypadInterrupt,c);a.interruptsRequestedValue=c};a.areInterruptsPending=function(){return 0<(a.interruptsRequestedValue&a.interruptsEnabledValue&31)};a.saveState=function(){A(1024+50*a.saveStateSlot,a.masterInterruptSwitch);A(1025+50*a.saveStateSlot,a.masterInterruptSwitchDelay)};a.loadState=function(){a.masterInterruptSwitch=
D(1024+50*a.saveStateSlot);a.masterInterruptSwitchDelay=D(1025+50*a.saveStateSlot);a.updateInterruptEnabled(v(a.memoryLocationInterruptEnabled));a.updateInterruptRequested(v(a.memoryLocationInterruptRequest))};a.masterInterruptSwitch=!1;a.masterInterruptSwitchDelay=!1;a.bitPositionVBlankInterrupt=0;a.bitPositionLcdInterrupt=1;a.bitPositionTimerInterrupt=2;a.bitPositionSerialInterrupt=3;a.bitPositionJoypadInterrupt=4;a.memoryLocationInterruptEnabled=65535;a.interruptsEnabledValue=0;a.isVBlankInterruptEnabled=
!1;a.isLcdInterruptEnabled=!1;a.isTimerInterruptEnabled=!1;a.isSerialInterruptEnabled=!1;a.isJoypadInterruptEnabled=!1;a.memoryLocationInterruptRequest=65295;a.interruptsRequestedValue=0;a.isVBlankInterruptRequested=!1;a.isLcdInterruptRequested=!1;a.isTimerInterruptRequested=!1;a.isSerialInterruptRequested=!1;a.isJoypadInterruptRequested=!1;a.saveStateSlot=2;return a}();
function Va(a){Wa(!1);var c=v(P.memoryLocationInterruptRequest);c=l(a,c);P.interruptsRequestedValue=c;E(P.memoryLocationInterruptRequest,c);p.stackPointer-=2;p.isHalted();c=p.stackPointer;var d=p.programCounter,e=k(d),f=c+1;E(c,d&255);E(f,e);switch(a){case P.bitPositionVBlankInterrupt:P.isVBlankInterruptRequested=!1;p.programCounter=64;break;case P.bitPositionLcdInterrupt:P.isLcdInterruptRequested=!1;p.programCounter=72;break;case P.bitPositionTimerInterrupt:P.isTimerInterruptRequested=!1;p.programCounter=
80;break;case P.bitPositionSerialInterrupt:P.isSerialInterruptRequested=!1;p.programCounter=88;break;case P.bitPositionJoypadInterrupt:P.isJoypadInterruptRequested=!1,p.programCounter=96}}function Xa(a){var c=v(P.memoryLocationInterruptRequest);c|=1<<a;P.interruptsRequestedValue=c;E(P.memoryLocationInterruptRequest,c)}function Wa(a){a?P.masterInterruptSwitchDelay=!0:P.masterInterruptSwitch=!1}
var Q=function(){function a(){}a.batchProcessCycles=function(){return 256};a.updateDividerRegister=function(){var c=a.dividerRegister;a.dividerRegister=0;E(a.memoryLocationDividerRegister,0);a.timerEnabled&&Ya(c,a.dividerRegister)&&Za()};a.updateTimerCounter=function(c){if(a.timerEnabled){if(a.timerCounterWasReset)return;a.timerCounterOverflowDelay&&(a.timerCounterOverflowDelay=!1)}a.timerCounter=c};a.updateTimerModulo=function(c){a.timerModulo=c;a.timerEnabled&&a.timerCounterWasReset&&(a.timerCounter=
a.timerModulo,a.timerCounterWasReset=!1)};a.updateTimerControl=function(c){var d=a.timerEnabled;a.timerEnabled=n(2,c);c&=3;if(!d){d=$a(a.timerInputClock);var e=$a(c);(a.timerEnabled?n(d,a.dividerRegister):n(d,a.dividerRegister)&&n(e,a.dividerRegister))&&Za()}a.timerInputClock=c};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.currentCycles;b[1028+50*a.saveStateSlot]=a.dividerRegister;A(1032+50*a.saveStateSlot,a.timerCounterOverflowDelay);A(1035+50*a.saveStateSlot,a.timerCounterWasReset);E(a.memoryLocationTimerCounter,
a.timerCounter)};a.loadState=function(){a.currentCycles=b[1024+50*a.saveStateSlot];a.dividerRegister=b[1028+50*a.saveStateSlot];a.timerCounterOverflowDelay=D(1032+50*a.saveStateSlot);a.timerCounterWasReset=D(1035+50*a.saveStateSlot);a.timerCounter=v(a.memoryLocationTimerCounter);a.timerModulo=v(a.memoryLocationTimerModulo);a.timerInputClock=v(a.memoryLocationTimerControl)};a.currentCycles=0;a.memoryLocationDividerRegister=65284;a.dividerRegister=0;a.memoryLocationTimerCounter=65285;a.timerCounter=
0;a.timerCounterOverflowDelay=!1;a.timerCounterWasReset=!1;a.timerCounterMask=0;a.memoryLocationTimerModulo=65286;a.timerModulo=0;a.memoryLocationTimerControl=65287;a.timerEnabled=!1;a.timerInputClock=0;a.saveStateSlot=5;return a}();
function ab(a){for(var c=0;c<a;){var d=Q.dividerRegister;c+=4;Q.dividerRegister+=4;65535<Q.dividerRegister&&(Q.dividerRegister-=65536);Q.timerEnabled&&(Q.timerCounterOverflowDelay?(Q.timerCounter=Q.timerModulo,P.isTimerInterruptRequested=!0,Xa(P.bitPositionTimerInterrupt),Q.timerCounterOverflowDelay=!1,Q.timerCounterWasReset=!0):Q.timerCounterWasReset&&(Q.timerCounterWasReset=!1),Ya(d,Q.dividerRegister)&&Za())}}
function Za(){Q.timerCounter+=1;255<Q.timerCounter&&(Q.timerCounterOverflowDelay=!0,Q.timerCounter=0)}function Ya(a,c){var d=$a(Q.timerInputClock);return n(d,a)&&!n(d,c)?!0:!1}function $a(a){switch(a){case 0:return 9;case 1:return 3;case 2:return 5;case 3:return 7}return 0}
var R=function(){function a(){}a.updateTransferControl=function(c){a.isShiftClockInternal=n(0,c);a.isClockSpeedFast=n(1,c);a.transferStartFlag=n(7,c);return!0};a.currentCycles=0;a.memoryLocationSerialTransferData=65281;a.memoryLocationSerialTransferControl=65282;a.numberOfBitsTransferred=0;a.isShiftClockInternal=!1;a.isClockSpeedFast=!1;a.transferStartFlag=!1;return a}(),S=function(){function a(){}a.updateJoypad=function(c){a.joypadRegisterFlipped=c^255;a.isDpadType=n(4,a.joypadRegisterFlipped);a.isButtonType=
n(5,a.joypadRegisterFlipped)};a.saveState=function(){};a.loadState=function(){a.updateJoypad(v(a.memoryLocationJoypadRegister))};a.up=!1;a.down=!1;a.left=!1;a.right=!1;a.a=!1;a.b=!1;a.select=!1;a.start=!1;a.memoryLocationJoypadRegister=65280;a.joypadRegisterFlipped=0;a.isDpadType=!1;a.isButtonType=!1;a.saveStateSlot=3;return a}();
function cb(a){var c=p.isStopped=!1;db(a)||(c=!0);eb(a,!0);c&&(c=!1,3>=a&&(c=!0),a=!1,S.isDpadType&&c&&(a=!0),S.isButtonType&&!c&&(a=!0),a&&(P.isJoypadInterruptRequested=!0,Xa(P.bitPositionJoypadInterrupt)))}function db(a){switch(a){case 0:return S.up;case 1:return S.right;case 2:return S.down;case 3:return S.left;case 4:return S.a;case 5:return S.b;case 6:return S.select;case 7:return S.start;default:return!1}}
function eb(a,c){switch(a){case 0:S.up=c;break;case 1:S.right=c;break;case 2:S.down=c;break;case 3:S.left=c;break;case 4:S.a=c;break;case 5:S.b=c;break;case 6:S.select=c;break;case 7:S.start=c}}function fb(a,c,d){for(var e=0;e<d;e++){for(var f=gb(a+e),m=c+e;40959<m;)m-=8192;hb(m,f)&&E(m,f)}a=32;p.GBCDoubleSpeed&&(a=64);T.DMACycles+=d/16*a}
function hb(a,c){if(a===p.memoryLocationSpeedSwitch)return E(p.memoryLocationSpeedSwitch,c&1),!1;var d=T.videoRamLocation,e=T.spriteInformationTableLocation;if(a<d){if(!T.isRomOnly)if(8191>=a){if(!T.isMBC2||n(4,c))c&=15,0===c?T.isRamBankingEnabled=!1:10===c&&(T.isRamBankingEnabled=!0)}else 16383>=a?!T.isMBC5||12287>=a?(T.isMBC2&&(T.currentRomBank=c&15),T.isMBC1?(c&=31,T.currentRomBank&=224):T.isMBC3?(c&=127,T.currentRomBank&=128):T.isMBC5&&(T.currentRomBank&=0),T.currentRomBank|=c):(a=0,d=T.currentRomBank&
255,0<c&&(a=1),T.currentRomBank=h(a,d)):!T.isMBC2&&24575>=a?T.isMBC1&&T.isMBC1RomModeEnabled?(T.currentRomBank&=31,T.currentRomBank|=c&224):(c=T.isMBC5?c&15:c&3,T.currentRamBank=c):!T.isMBC2&&32767>=a&&T.isMBC1&&(n(0,c)?T.isMBC1RomModeEnabled=!0:T.isMBC1RomModeEnabled=!1);return!1}if(a>=d&&a<T.cartridgeRamLocation)return!0;if(a>=T.echoRamLocation&&a<e)return E(a-8192,c),!0;if(a>=e&&a<=T.spriteInformationTableLocationEnd)return 2>U.currentLcdMode?!1:!0;if(a>=T.unusableMemoryLocation&&a<=T.unusableMemoryEndLocation)return!1;
if(a===R.memoryLocationSerialTransferControl)return R.updateTransferControl(c);if(65296<=a&&65318>=a){Pa();if(a===M.memoryLocationNR52||M.NR52IsSoundEnabled){switch(a){case F.memoryLocationNRx0:F.updateNRx0(c);break;case H.memoryLocationNRx0:H.updateNRx0(c);break;case F.memoryLocationNRx1:F.updateNRx1(c);break;case G.memoryLocationNRx1:G.updateNRx1(c);break;case H.memoryLocationNRx1:H.updateNRx1(c);break;case J.memoryLocationNRx1:J.updateNRx1(c);break;case F.memoryLocationNRx2:F.updateNRx2(c);break;
case G.memoryLocationNRx2:G.updateNRx2(c);break;case H.memoryLocationNRx2:H.volumeCodeChanged=!0;H.updateNRx2(c);break;case J.memoryLocationNRx2:J.updateNRx2(c);break;case F.memoryLocationNRx3:F.updateNRx3(c);break;case G.memoryLocationNRx3:G.updateNRx3(c);break;case H.memoryLocationNRx3:H.updateNRx3(c);break;case J.memoryLocationNRx3:J.updateNRx3(c);break;case F.memoryLocationNRx4:n(7,c)&&(F.updateNRx4(c),F.trigger());break;case G.memoryLocationNRx4:n(7,c)&&(G.updateNRx4(c),G.trigger());break;case H.memoryLocationNRx4:n(7,
c)&&(H.updateNRx4(c),H.trigger());break;case J.memoryLocationNRx4:n(7,c)&&(J.updateNRx4(c),J.trigger());break;case M.memoryLocationNR50:M.updateNR50(c);L.mixerVolumeChanged=!0;break;case M.memoryLocationNR51:M.updateNR51(c);L.mixerEnabledChanged=!0;break;case M.memoryLocationNR52:if(M.updateNR52(c),!n(7,c))for(c=65296;65318>c;c++)E(c,0)}c=!0}else c=!1;return c}65328<=a&&65343>=a&&Pa();if(a>=U.memoryLocationLcdControl&&a<=y.memoryLocationWindowX){if(a===U.memoryLocationLcdControl)return U.updateLcdControl(c),
!0;if(a===U.memoryLocationLcdStatus)return U.updateLcdStatus(c),!1;if(a===y.memoryLocationScanlineRegister)return y.scanlineRegister=0,E(a,0),!1;if(a===U.memoryLocationCoincidenceCompare)return U.coincidenceCompare=c,!0;if(a===y.memoryLocationDmaTransfer){c<<=8;for(a=0;159>=a;a++)d=v(c+a),E(T.spriteInformationTableLocation+a,d);T.DMACycles=644;return!0}switch(a){case y.memoryLocationScrollX:y.scrollX=c;break;case y.memoryLocationScrollY:y.scrollY=c;break;case y.memoryLocationWindowX:y.windowX=c;break;
case y.memoryLocationWindowY:y.windowY=c}return!0}if(a===T.memoryLocationHdmaTrigger)return p.GBCEnabled&&(T.isHblankHdmaActive&&!n(7,c)?(T.isHblankHdmaActive=!1,c=v(T.memoryLocationHdmaTrigger),E(T.memoryLocationHdmaTrigger,c|128)):(a=v(T.memoryLocationHdmaSourceHigh),d=v(T.memoryLocationHdmaSourceLow),a=h(a,d)&65520,d=v(T.memoryLocationHdmaDestinationHigh),e=v(T.memoryLocationHdmaDestinationLow),d=h(d,e),d=(d&8176)+T.videoRamLocation,e=l(7,c),e=16*(e+1),n(7,c)?(T.isHblankHdmaActive=!0,T.hblankHdmaTransferLengthRemaining=
e,T.hblankHdmaSource=a,T.hblankHdmaDestination=d,E(T.memoryLocationHdmaTrigger,l(7,c))):(fb(a,d,e),E(T.memoryLocationHdmaTrigger,255)))),!1;if((a===T.memoryLocationGBCWRAMBank||a===T.memoryLocationGBCVRAMBank)&&T.isHblankHdmaActive&&(16384<=T.hblankHdmaSource&&32767>=T.hblankHdmaSource||53248<=T.hblankHdmaSource&&57343>=T.hblankHdmaSource))return!1;if(a>=Aa.memoryLocationBackgroundPaletteIndex&&a<=Aa.memoryLocationSpritePaletteData){if(a===Aa.memoryLocationBackgroundPaletteData||a===Aa.memoryLocationSpritePaletteData){d=
v(a-1);d=l(6,d);e=!1;a===Aa.memoryLocationSpritePaletteData&&(e=!0);var f=d&63;e&&(f+=64);b[67584+f]=c;c=d;--a;n(7,c)&&E(a,c+1|128)}return!0}if(a>=Q.memoryLocationDividerRegister&&a<=Q.memoryLocationTimerControl){ab(Q.currentCycles);Q.currentCycles=0;switch(a){case Q.memoryLocationDividerRegister:return Q.updateDividerRegister(c),!1;case Q.memoryLocationTimerCounter:Q.updateTimerCounter(c);break;case Q.memoryLocationTimerModulo:Q.updateTimerModulo(c);break;case Q.memoryLocationTimerControl:Q.updateTimerControl(c)}return!0}a===
S.memoryLocationJoypadRegister&&S.updateJoypad(c);if(a===P.memoryLocationInterruptRequest)return P.updateInterruptRequested(c),!0;a===P.memoryLocationInterruptEnabled&&P.updateInterruptEnabled(c);return!0}
function ib(a){switch(a>>12){case 0:case 1:case 2:case 3:return a+na;case 4:case 5:case 6:case 7:var c=T.currentRomBank;T.isMBC5||0!==c||(c=1);return 16384*c+(a-T.switchableCartridgeRomLocation)+na;case 8:case 9:return c=0,p.GBCEnabled&&(c=v(T.memoryLocationGBCVRAMBank)&1),a-T.videoRamLocation+2048+8192*c;case 10:case 11:return 8192*T.currentRamBank+(a-T.cartridgeRamLocation)+ma;case 12:return a-T.internalRamBankZeroLocation+18432;case 13:return c=0,p.GBCEnabled&&(c=v(T.memoryLocationGBCWRAMBank)&
7),1>c&&(c=1),a-T.internalRamBankZeroLocation+18432+4096*(c-1);default:return a-T.echoRamLocation+51200}}function E(a,c){a=ib(a);b[a]=c}function A(a,c){b[a]=c?1:0}
var U=function(){function a(){}a.updateLcdStatus=function(c){var d=v(a.memoryLocationLcdStatus);c=c&248|d&7|128;E(a.memoryLocationLcdStatus,c)};a.updateLcdControl=function(c){var d=a.enabled;a.enabled=n(7,c);a.windowTileMapDisplaySelect=n(6,c);a.windowDisplayEnabled=n(5,c);a.bgWindowTileDataSelect=n(4,c);a.bgTileMapDisplaySelect=n(3,c);a.tallSpriteSize=n(2,c);a.spriteDisplayEnable=n(1,c);a.bgDisplayEnabled=n(0,c);d&&!a.enabled&&jb(!0);!d&&a.enabled&&jb(!1)};a.memoryLocationLcdStatus=65345;a.currentLcdMode=
0;a.memoryLocationCoincidenceCompare=65349;a.coincidenceCompare=0;a.memoryLocationLcdControl=65344;a.enabled=!0;a.windowTileMapDisplaySelect=!1;a.windowDisplayEnabled=!1;a.bgWindowTileDataSelect=!1;a.bgTileMapDisplaySelect=!1;a.tallSpriteSize=!1;a.spriteDisplayEnable=!1;a.bgDisplayEnabled=!1;return a}();
function jb(a){y.scanlineCycleCounter=0;y.scanlineRegister=0;E(y.memoryLocationScanlineRegister,0);var c=v(U.memoryLocationLcdStatus);c=l(1,c);c=l(0,c);U.currentLcdMode=0;E(U.memoryLocationLcdStatus,c);if(a)for(a=0;a<fa;a++)b[67584+a]=255}function kb(a,c){var d=U.coincidenceCompare;0!==a&&1!==a||y.scanlineRegister!==d?c=l(2,c):(c|=4,n(6,c)&&(P.isLcdInterruptRequested=!0,Xa(P.bitPositionLcdInterrupt)));return c}
function lb(a,c,d,e,f,m){for(var z=e>>3;160>f;f++){var w=f+m;256<=w&&(w-=256);var I=d+32*z+(w>>3),x=Ja(I,0),N=!1;if(g.tileCaching){var B=f;var C=a,W=w,O=I,X=x,K=0;if(0<C&&8<B&&X===Ga.tileId&&B===Ga.nextXIndexToPerformCacheCheck){var ya=X=!1;n(5,v(O-1))&&(X=!0);n(5,v(O))&&(ya=!0);for(O=0;8>O;O++)if(X!==ya&&(O=7-O),160>=B+O){for(var za=B-(8-O),Mb=ba+3*(160*C+(B+O)),bb=0;3>bb;bb++)mb(B+O,C,bb,b[Mb+bb]);za=b[67712+(160*C+za)];Fa(B+O,C,l(2,za),n(2,za));K++}}else Ga.tileId=X;B>=Ga.nextXIndexToPerformCacheCheck&&
(Ga.nextXIndexToPerformCacheCheck=B+8,C=W%8,B<C&&(Ga.nextXIndexToPerformCacheCheck+=C));B=K;0<B&&(f+=B-1,N=!0)}g.tileRendering&&!N?(N=f,B=a,K=c,C=e%8,W=0,0==N&&(W=w-w/8*8),w=7,160<N+8&&(w=160-N),X=-1,ya=0,p.GBCEnabled&&(X=Ja(I,1),n(3,X)&&(ya=1),n(6,X)&&(C=7-C)),B=Ha(x,K,ya,W,w,C,N,B,160,ba,!1,0,X,-1),0<B&&(f+=B-1)):N||(p.GBCEnabled?(N=f,B=a,C=e,K=Ia(c,x),I=Ja(I,1),C%=8,n(6,I)&&(C=7-C),W=0,n(3,I)&&(W=1),x=Ja(K+2*C,W),K=Ja(K+2*C+1,W),C=w%8,n(5,I)||(C=7-C),w=0,n(C,K)&&(w=w+1<<1),n(C,x)&&(w+=1),C=Ca(I&
7,w,!1),x=Ea(0,C),K=Ea(1,C),C=Ea(2,C),mb(N,B,0,x),mb(N,B,1,K),mb(N,B,2,C),Fa(N,B,w,n(7,I))):(I=f,N=a,K=e,B=Ia(c,x),K%=8,x=Ja(B+2*K,0),B=Ja(B+2*K+1,0),K=7-w%8,w=0,n(K,B)&&(w=w+1<<1),n(K,x)&&(w+=1),x=Ba(w,y.memoryLocationBackgroundPalette),mb(I,N,0,x),mb(I,N,1,x),mb(I,N,2,x),Fa(I,N,w)))}}
var y=function(){function a(){}a.batchProcessCycles=function(){return a.MAX_CYCLES_PER_SCANLINE()};a.MAX_CYCLES_PER_SCANLINE=function(){return p.GBCDoubleSpeed?153===a.scanlineRegister?8:912:153===a.scanlineRegister?4:456};a.MIN_CYCLES_SPRITES_LCD_MODE=function(){return p.GBCDoubleSpeed?752:376};a.MIN_CYCLES_TRANSFER_DATA_LCD_MODE=function(){return p.GBCDoubleSpeed?498:249};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.scanlineCycleCounter;b[1028+50*a.saveStateSlot]=U.currentLcdMode;E(a.memoryLocationScanlineRegister,
a.scanlineRegister)};a.loadState=function(){a.scanlineCycleCounter=b[1024+50*a.saveStateSlot];U.currentLcdMode=b[1028+50*a.saveStateSlot];a.scanlineRegister=v(a.memoryLocationScanlineRegister);U.updateLcdControl(v(U.memoryLocationLcdControl))};a.currentCycles=0;a.scanlineCycleCounter=0;a.memoryLocationScanlineRegister=65348;a.scanlineRegister=0;a.memoryLocationDmaTransfer=65350;a.memoryLocationScrollX=65347;a.scrollX=0;a.memoryLocationScrollY=65346;a.scrollY=0;a.memoryLocationWindowX=65355;a.windowX=
0;a.memoryLocationWindowY=65354;a.windowY=0;a.memoryLocationTileMapSelectZeroStart=38912;a.memoryLocationTileMapSelectOneStart=39936;a.memoryLocationTileDataSelectZeroStart=34816;a.memoryLocationTileDataSelectOneStart=32768;a.memoryLocationSpriteAttributesTable=65024;a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;a.saveStateSlot=1;return a}();
function nb(a){if(U.enabled)for(y.scanlineCycleCounter+=a;y.scanlineCycleCounter>=y.MAX_CYCLES_PER_SCANLINE();){y.scanlineCycleCounter-=y.MAX_CYCLES_PER_SCANLINE();a=y.scanlineRegister;if(144===a){if(g.graphicsDisableScanlineRendering)for(var c=0;144>=c;c++)ob(c);else ob(a);for(c=0;144>c;c++)for(var d=0;160>d;d++)b[67712+(160*c+d)]=0;Ga.tileId=-1;Ga.nextXIndexToPerformCacheCheck=-1}else 144>a&&(g.graphicsDisableScanlineRendering||ob(a));a=153<a?0:a+1;y.scanlineRegister=a}if(U.enabled)if(c=y.scanlineRegister,
d=U.currentLcdMode,a=0,144<=c?a=1:y.scanlineCycleCounter>=y.MIN_CYCLES_SPRITES_LCD_MODE()?a=2:y.scanlineCycleCounter>=y.MIN_CYCLES_TRANSFER_DATA_LCD_MODE()&&(a=3),d!==a){c=v(U.memoryLocationLcdStatus);U.currentLcdMode=a;d=!1;switch(a){case 0:c=l(0,c);c=l(1,c);d=n(3,c);break;case 1:c=l(1,c);c|=1;d=n(4,c);break;case 2:c=l(0,c);c|=2;d=n(5,c);break;case 3:c|=3}d&&(P.isLcdInterruptRequested=!0,Xa(P.bitPositionLcdInterrupt));0===a&&T.isHblankHdmaActive&&(d=16,T.hblankHdmaTransferLengthRemaining<d&&(d=T.hblankHdmaTransferLengthRemaining),
fb(T.hblankHdmaSource,T.hblankHdmaDestination,d),T.hblankHdmaSource+=d,T.hblankHdmaDestination+=d,T.hblankHdmaTransferLengthRemaining-=d,0>=T.hblankHdmaTransferLengthRemaining?(T.isHblankHdmaActive=!1,E(T.memoryLocationHdmaTrigger,255)):E(T.memoryLocationHdmaTrigger,l(7,T.hblankHdmaTransferLengthRemaining/16-1)));1===a&&(P.isVBlankInterruptRequested=!0,Xa(P.bitPositionVBlankInterrupt));c=kb(a,c);E(U.memoryLocationLcdStatus,c)}else 153===c&&(c=v(U.memoryLocationLcdStatus),c=kb(a,c),E(U.memoryLocationLcdStatus,
c))}
function ob(a){var c=y.memoryLocationTileDataSelectZeroStart;U.bgWindowTileDataSelect&&(c=y.memoryLocationTileDataSelectOneStart);if(p.GBCEnabled||U.bgDisplayEnabled){var d=y.memoryLocationTileMapSelectZeroStart;U.bgTileMapDisplaySelect&&(d=y.memoryLocationTileMapSelectOneStart);var e=y.scrollX,f=a+y.scrollY;256<=f&&(f-=256);lb(a,c,d,f,0,e)}U.windowDisplayEnabled&&(d=y.memoryLocationTileMapSelectZeroStart,U.windowTileMapDisplaySelect&&(d=y.memoryLocationTileMapSelectOneStart),e=y.windowX,f=y.windowY,a<
f||(e-=7,lb(a,c,d,a-f,e,-1*e)));if(U.spriteDisplayEnable)for(c=U.tallSpriteSize,d=39;0<=d;d--){f=4*d;var m=v(y.memoryLocationSpriteAttributesTable+f);e=v(y.memoryLocationSpriteAttributesTable+f+1);var z=v(y.memoryLocationSpriteAttributesTable+f+2);m-=16;e-=8;var w=8;c&&(w=16,1===z%2&&--z);if(a>=m&&a<m+w){f=v(y.memoryLocationSpriteAttributesTable+f+3);var I=n(7,f),x=n(6,f),N=n(5,f);m=a-m;x&&(m-=w,m*=-1,--m);m*=2;z=Ia(y.memoryLocationTileDataSelectOneStart,z);w=z+=m;m=0;p.GBCEnabled&&n(3,f)&&(m=1);
z=Ja(w,m);w=Ja(w+1,m);for(m=7;0<=m;m--){x=m;N&&(x-=7,x*=-1);var B=0;n(x,w)&&(B+=1,B<<=1);n(x,z)&&(B+=1);if(0!==B&&(x=e+(7-m),0<=x&&160>=x)){var C=!1,W=!1,O=!1;p.GBCEnabled&&!U.bgDisplayEnabled&&(C=!0);if(!C){var X=b[67712+(160*a+x)],K=X&3;I&&0<K?W=!0:p.GBCEnabled&&n(2,X)&&0<K&&(O=!0)}if(C||!W&&!O)p.GBCEnabled?(W=Ca(f&7,B,!0),B=Ea(0,W),C=Ea(1,W),W=Ea(2,W),mb(x,a,0,B),mb(x,a,1,C),mb(x,a,2,W)):(C=y.memoryLocationSpritePaletteOne,n(4,f)&&(C=y.memoryLocationSpritePaletteTwo),B=Ba(B,C),mb(x,a,0,B),mb(x,
a,1,B),mb(x,a,2,B))}}}}}function mb(a,c,d,e){b[ba+3*(160*c+a)+d]=e}function Ja(a,c){return b[a-T.videoRamLocation+2048+8192*(c&1)]}
function pb(a){var c=T.videoRamLocation;return a<c||a>=c&&a<T.cartridgeRamLocation?-1:a>=T.echoRamLocation&&a<T.spriteInformationTableLocation?v(a-8192):a>=T.spriteInformationTableLocation&&a<=T.spriteInformationTableLocationEnd?2>U.currentLcdMode?255:-1:a===p.memoryLocationSpeedSwitch?(a=255,c=v(p.memoryLocationSpeedSwitch),n(0,c)||(a=l(0,a)),p.GBCDoubleSpeed||(a=l(7,a)),a):a===y.memoryLocationScanlineRegister?(E(a,y.scanlineRegister),y.scanlineRegister):65296<=a&&65318>=a?(Pa(),a=a===M.memoryLocationNR52?
v(M.memoryLocationNR52)&128|112:-1,a):65328<=a&&65343>=a?(Pa(),-1):a===Q.memoryLocationDividerRegister?(c=k(Q.dividerRegister),E(a,c),c):a===Q.memoryLocationTimerCounter?(E(a,Q.timerCounter),Q.timerCounter):a===P.memoryLocationInterruptRequest?224|P.interruptsRequestedValue:a===S.memoryLocationJoypadRegister?(a=S.joypadRegisterFlipped,S.isDpadType?(a=S.up?l(2,a):a|4,a=S.right?l(0,a):a|1,a=S.down?l(3,a):a|8,a=S.left?l(1,a):a|2):S.isButtonType&&(a=S.a?l(0,a):a|1,a=S.b?l(1,a):a|2,a=S.select?l(2,a):a|
4,a=S.start?l(3,a):a|8),a|240):-1}function v(a){return b[ib(a)]}function gb(a){var c=pb(a);switch(c){case -1:return v(a);default:return c}}function D(a){return 0<b[a]?!0:!1}
var T=function(){function a(){}a.saveState=function(){b[1024+50*a.saveStateSlot]=a.currentRomBank;b[1026+50*a.saveStateSlot]=a.currentRamBank;A(1028+50*a.saveStateSlot,a.isRamBankingEnabled);A(1029+50*a.saveStateSlot,a.isMBC1RomModeEnabled);A(1030+50*a.saveStateSlot,a.isRomOnly);A(1031+50*a.saveStateSlot,a.isMBC1);A(1032+50*a.saveStateSlot,a.isMBC2);A(1033+50*a.saveStateSlot,a.isMBC3);A(1034+50*a.saveStateSlot,a.isMBC5)};a.loadState=function(){a.currentRomBank=b[1024+50*a.saveStateSlot];a.currentRamBank=
b[1026+50*a.saveStateSlot];a.isRamBankingEnabled=D(1028+50*a.saveStateSlot);a.isMBC1RomModeEnabled=D(1029+50*a.saveStateSlot);a.isRomOnly=D(1030+50*a.saveStateSlot);a.isMBC1=D(1031+50*a.saveStateSlot);a.isMBC2=D(1032+50*a.saveStateSlot);a.isMBC3=D(1033+50*a.saveStateSlot);a.isMBC5=D(1034+50*a.saveStateSlot)};a.cartridgeRomLocation=0;a.switchableCartridgeRomLocation=16384;a.videoRamLocation=32768;a.cartridgeRamLocation=40960;a.internalRamBankZeroLocation=49152;a.internalRamBankOneLocation=53248;a.echoRamLocation=
57344;a.spriteInformationTableLocation=65024;a.spriteInformationTableLocationEnd=65183;a.unusableMemoryLocation=65184;a.unusableMemoryEndLocation=65279;a.currentRomBank=0;a.currentRamBank=0;a.isRamBankingEnabled=!1;a.isMBC1RomModeEnabled=!0;a.isRomOnly=!0;a.isMBC1=!1;a.isMBC2=!1;a.isMBC3=!1;a.isMBC5=!1;a.memoryLocationHdmaSourceHigh=65361;a.memoryLocationHdmaSourceLow=65362;a.memoryLocationHdmaDestinationHigh=65363;a.memoryLocationHdmaDestinationLow=65364;a.memoryLocationHdmaTrigger=65365;a.DMACycles=
0;a.isHblankHdmaActive=!1;a.hblankHdmaTransferLengthRemaining=0;a.hblankHdmaSource=0;a.hblankHdmaDestination=0;a.memoryLocationGBCVRAMBank=65359;a.memoryLocationGBCWRAMBank=65392;a.saveStateSlot=4;return a}(),p=function(){function a(){}a.CLOCK_SPEED=function(){return a.GBCDoubleSpeed?8388608:4194304};a.MAX_CYCLES_PER_FRAME=function(){return a.GBCDoubleSpeed?140448:70224};a.enableHalt=function(){P.masterInterruptSwitch?a.isHaltNormal=!0:0===(P.interruptsEnabledValue&P.interruptsRequestedValue&31)?
a.isHaltNoJump=!0:a.isHaltBug=!0};a.exitHaltAndStop=function(){a.isHaltNoJump=!1;a.isHaltNormal=!1;a.isHaltBug=!1;a.isStopped=!1};a.isHalted=function(){return a.isHaltNormal||a.isHaltNoJump?!0:!1};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.registerA;b[1025+50*a.saveStateSlot]=a.registerB;b[1026+50*a.saveStateSlot]=a.registerC;b[1027+50*a.saveStateSlot]=a.registerD;b[1028+50*a.saveStateSlot]=a.registerE;b[1029+50*a.saveStateSlot]=a.registerH;b[1030+50*a.saveStateSlot]=a.registerL;b[1031+50*
a.saveStateSlot]=a.registerF;b[1032+50*a.saveStateSlot]=a.stackPointer;b[1034+50*a.saveStateSlot]=a.programCounter;b[1036+50*a.saveStateSlot]=a.currentCycles;A(1041+50*a.saveStateSlot,a.isHaltNormal);A(1042+50*a.saveStateSlot,a.isHaltNoJump);A(1043+50*a.saveStateSlot,a.isHaltBug);A(1044+50*a.saveStateSlot,a.isStopped)};a.loadState=function(){a.registerA=b[1024+50*a.saveStateSlot];a.registerB=b[1025+50*a.saveStateSlot];a.registerC=b[1026+50*a.saveStateSlot];a.registerD=b[1027+50*a.saveStateSlot];a.registerE=
b[1028+50*a.saveStateSlot];a.registerH=b[1029+50*a.saveStateSlot];a.registerL=b[1030+50*a.saveStateSlot];a.registerF=b[1031+50*a.saveStateSlot];a.stackPointer=b[1032+50*a.saveStateSlot];a.programCounter=b[1034+50*a.saveStateSlot];a.currentCycles=b[1036+50*a.saveStateSlot];a.isHaltNormal=D(1041+50*a.saveStateSlot);a.isHaltNoJump=D(1042+50*a.saveStateSlot);a.isHaltBug=D(1043+50*a.saveStateSlot);a.isStopped=D(1044+50*a.saveStateSlot)};a.GBCEnabled=!1;a.memoryLocationSpeedSwitch=65357;a.GBCDoubleSpeed=
!1;a.registerA=0;a.registerB=0;a.registerC=0;a.registerD=0;a.registerE=0;a.registerH=0;a.registerL=0;a.registerF=0;a.stackPointer=0;a.programCounter=0;a.currentCycles=0;a.isHaltNormal=!1;a.isHaltNoJump=!1;a.isHaltBug=!1;a.isStopped=!1;a.saveStateSlot=0;return a}();function qb(a){va(p.registerA,a);wa(p.registerA,a);p.registerA=p.registerA+a&255;0===p.registerA?q(1):q(0);r(0)}
function rb(a){var c=p.registerA+a+ua()&255;0!=((p.registerA^a^c)&16)?t(1):t(0);0<(p.registerA+a+ua()&256)?u(1):u(0);p.registerA=c;0===p.registerA?q(1):q(0);r(0)}function sb(a){var c=-1*a;va(p.registerA,c);wa(p.registerA,c);p.registerA=p.registerA-a&255;0===p.registerA?q(1):q(0);r(1)}function tb(a){var c=p.registerA-a-ua()&255;0!=((p.registerA^a^c)&16)?t(1):t(0);0<(p.registerA-a-ua()&256)?u(1):u(0);p.registerA=c;0===p.registerA?q(1):q(0);r(1)}
function ub(a){p.registerA&=a;0===p.registerA?q(1):q(0);r(0);t(1);u(0)}function vb(a){p.registerA=(p.registerA^a)&255;0===p.registerA?q(1):q(0);r(0);t(0);u(0)}function wb(a){p.registerA|=a;0===p.registerA?q(1):q(0);r(0);t(0);u(0)}function xb(a){a*=-1;va(p.registerA,a);wa(p.registerA,a);0===p.registerA+a?q(1):q(0);r(1)}function yb(a,c){0===(c&1<<a)?q(1):q(0);r(0);t(1);return c}function zb(a,c,d){return 0<c?d|1<<a:d&~(1<<a)}
function Ab(a){a=ra(a);p.programCounter=p.programCounter+a&65535;p.programCounter=p.programCounter+1&65535}
function Bb(a){p.programCounter=p.programCounter+1&65535;p.isHaltBug&&(p.programCounter=p.programCounter-1&65535);switch((a&240)>>4){case 0:return Cb(a);case 1:return Db(a);case 2:return Eb(a);case 3:return Fb(a);case 4:return Gb(a);case 5:return Hb(a);case 6:return Ib(a);case 7:return Jb(a);case 8:return Kb(a);case 9:return Lb(a);case 10:return Nb(a);case 11:return Ob(a);case 12:return Pb(a);case 13:return Qb(a);case 14:return Rb(a);default:return Sb(a)}}function V(a){Tb(4);return gb(a)}
function Ub(a,c){Tb(4);hb(a,c)&&E(a,c)}function Vb(a){Tb(8);var c=pb(a);switch(c){case -1:c=v(a)}a+=1;var d=pb(a);switch(d){case -1:a=v(a);break;default:a=d}return h(a,c)}function Wb(a,c){Tb(8);var d=k(c);c&=255;var e=a+1;hb(a,c)&&E(a,c);hb(e,d)&&E(e,d)}function Y(){Tb(4);return v(p.programCounter)}function Xb(){Tb(4);var a=v(p.programCounter+1&65535);return h(a,Y())}
function Cb(a){switch(a){case 0:return 4;case 1:return a=Xb(),p.registerB=k(a),p.registerC=a&255,p.programCounter=p.programCounter+2&65535,4;case 2:return Ub(h(p.registerB,p.registerC),p.registerA),4;case 3:return a=h(p.registerB,p.registerC),a++,p.registerB=k(a),p.registerC=a&255,8;case 4:return va(p.registerB,1),p.registerB=p.registerB+1&255,0===p.registerB?q(1):q(0),r(0),4;case 5:return va(p.registerB,-1),p.registerB=p.registerB-1&255,0===p.registerB?q(1):q(0),r(1),4;case 6:return p.registerB=
Y(),p.programCounter=p.programCounter+1&65535,4;case 7:return 128===(p.registerA&128)?u(1):u(0),a=p.registerA,p.registerA=(a<<1|a>>7)&255,q(0),r(0),t(0),4;case 8:return Wb(Xb(),p.stackPointer),p.programCounter=p.programCounter+2&65535,4;case 9:a=h(p.registerH,p.registerL);var c=h(p.registerB,p.registerC);xa(a,c,!1);a=a+c&65535;p.registerH=k(a);p.registerL=a&255;r(0);return 8;case 10:return p.registerA=V(h(p.registerB,p.registerC)),4;case 11:return a=h(p.registerB,p.registerC),a=a-1&65535,p.registerB=
k(a),p.registerC=a&255,8;case 12:return va(p.registerC,1),p.registerC=p.registerC+1&255,0===p.registerC?q(1):q(0),r(0),4;case 13:return va(p.registerC,-1),p.registerC=p.registerC-1&255,0===p.registerC?q(1):q(0),r(1),4;case 14:return p.registerC=Y(),p.programCounter=p.programCounter+1&65535,4;case 15:return 0<(p.registerA&1)?u(1):u(0),a=p.registerA,p.registerA=(a>>1|a<<7)&255,q(0),r(0),t(0),4}return-1}
function Db(a){switch(a){case 16:if(p.GBCEnabled&&(a=V(p.memoryLocationSpeedSwitch),n(0,a)))return a=l(0,a),n(7,a)?(p.GBCDoubleSpeed=!1,a=l(7,a)):(p.GBCDoubleSpeed=!0,a|=128),Ub(p.memoryLocationSpeedSwitch,a),68;p.isStopped=!0;p.programCounter=p.programCounter+1&65535;return 4;case 17:return a=Xb(),p.registerD=k(a),p.registerE=a&255,p.programCounter=p.programCounter+2&65535,4;case 18:return Ub(h(p.registerD,p.registerE),p.registerA),4;case 19:return a=h(p.registerD,p.registerE),a=a+1&65535,p.registerD=
k(a),p.registerE=a&255,8;case 20:return va(p.registerD,1),p.registerD=p.registerD+1&255,0===p.registerD?q(1):q(0),r(0),4;case 21:return va(p.registerD,-1),p.registerD=p.registerD-1&255,0===p.registerD?q(1):q(0),r(1),4;case 22:return p.registerD=Y(),p.programCounter=p.programCounter+1&65535,4;case 23:return a=!1,128===(p.registerA&128)&&(a=!0),p.registerA=(p.registerA<<1|ua())&255,a?u(1):u(0),q(0),r(0),t(0),4;case 24:return Ab(Y()),8;case 25:a=h(p.registerH,p.registerL);var c=h(p.registerD,p.registerE);
xa(a,c,!1);a=a+c&65535;p.registerH=k(a);p.registerL=a&255;r(0);return 8;case 26:return a=h(p.registerD,p.registerE),p.registerA=V(a),4;case 27:return a=h(p.registerD,p.registerE),a=a-1&65535,p.registerD=k(a),p.registerE=a&255,8;case 28:return va(p.registerE,1),p.registerE=p.registerE+1&255,0===p.registerE?q(1):q(0),r(0),4;case 29:return va(p.registerE,-1),p.registerE=p.registerE-1&255,0===p.registerE?q(1):q(0),r(1),4;case 30:return p.registerE=Y(),p.programCounter=p.programCounter+1&65535,4;case 31:return a=
!1,1===(p.registerA&1)&&(a=!0),p.registerA=(p.registerA>>1|ua()<<7)&255,a?u(1):u(0),q(0),r(0),t(0),4}return-1}
function Eb(a){switch(a){case 32:return 0===ta()?Ab(Y()):p.programCounter=p.programCounter+1&65535,8;case 33:return a=Xb(),p.registerH=k(a),p.registerL=a&255,p.programCounter=p.programCounter+2&65535,4;case 34:return a=h(p.registerH,p.registerL),Ub(a,p.registerA),a=a+1&65535,p.registerH=k(a),p.registerL=a&255,4;case 35:return a=h(p.registerH,p.registerL),a=a+1&65535,p.registerH=k(a),p.registerL=a&255,8;case 36:return va(p.registerH,1),p.registerH=p.registerH+1&255,0===p.registerH?q(1):q(0),r(0),4;
case 37:return va(p.registerH,-1),p.registerH=p.registerH-1&255,0===p.registerH?q(1):q(0),r(1),4;case 38:return p.registerH=Y(),p.programCounter=p.programCounter+1&65535,4;case 39:var c=0;0<(p.registerF>>5&1)&&(c|=6);0<ua()&&(c|=96);0<(p.registerF>>6&1)?a=p.registerA-c&255:(9<(p.registerA&15)&&(c|=6),153<p.registerA&&(c|=96),a=p.registerA+c&255);0===a?q(1):q(0);0!==(c&96)?u(1):u(0);t(0);p.registerA=a;return 4;case 40:return 0<ta()?Ab(Y()):p.programCounter=p.programCounter+1&65535,8;case 41:return a=
h(p.registerH,p.registerL),xa(a,a,!1),a=2*a&65535,p.registerH=k(a),p.registerL=a&255,r(0),8;case 42:return a=h(p.registerH,p.registerL),p.registerA=V(a),a=a+1&65535,p.registerH=k(a),p.registerL=a&255,4;case 43:return a=h(p.registerH,p.registerL),a=a-1&65535,p.registerH=k(a),p.registerL=a&255,8;case 44:return va(p.registerL,1),p.registerL=p.registerL+1&255,0===p.registerL?q(1):q(0),r(0),4;case 45:return va(p.registerL,-1),p.registerL=p.registerL-1&255,0===p.registerL?q(1):q(0),r(1),4;case 46:return p.registerL=
Y(),p.programCounter=p.programCounter+1&65535,4;case 47:return p.registerA=~p.registerA,r(1),t(1),4}return-1}
function Fb(a){switch(a){case 48:return 0===ua()?Ab(Y()):p.programCounter=p.programCounter+1&65535,8;case 49:return p.stackPointer=Xb(),p.programCounter=p.programCounter+2&65535,4;case 50:return a=h(p.registerH,p.registerL),Ub(a,p.registerA),a=a-1&65535,p.registerH=k(a),p.registerL=a&255,4;case 51:return p.stackPointer=p.stackPointer+1&65535,8;case 52:a=h(p.registerH,p.registerL);var c=V(a);va(c,1);c=c+1&255;0===c?q(1):q(0);r(0);Ub(a,c);return 4;case 53:return a=h(p.registerH,p.registerL),c=V(a),
va(c,-1),c=c-1&255,0===c?q(1):q(0),r(1),Ub(a,c),4;case 54:return Ub(h(p.registerH,p.registerL),Y()),p.programCounter=p.programCounter+1&65535,4;case 55:return r(0),t(0),u(1),4;case 56:return 1===ua()?Ab(Y()):p.programCounter=p.programCounter+1&65535,8;case 57:return a=h(p.registerH,p.registerL),xa(a,p.stackPointer,!1),a=a+p.stackPointer&65535,p.registerH=k(a),p.registerL=a&255,r(0),8;case 58:return a=h(p.registerH,p.registerL),p.registerA=V(a),a=a-1&65535,p.registerH=k(a),p.registerL=a&255,4;case 59:return p.stackPointer=
p.stackPointer-1&65535,8;case 60:return va(p.registerA,1),p.registerA=p.registerA+1&255,0===p.registerA?q(1):q(0),r(0),4;case 61:return va(p.registerA,-1),p.registerA=p.registerA-1&255,0===p.registerA?q(1):q(0),r(1),4;case 62:return p.registerA=Y(),p.programCounter=p.programCounter+1&65535,4;case 63:return r(0),t(0),0<ua()?u(0):u(1),4}return-1}
function Gb(a){switch(a){case 64:return 4;case 65:return p.registerB=p.registerC,4;case 66:return p.registerB=p.registerD,4;case 67:return p.registerB=p.registerE,4;case 68:return p.registerB=p.registerH,4;case 69:return p.registerB=p.registerL,4;case 70:return p.registerB=V(h(p.registerH,p.registerL)),4;case 71:return p.registerB=p.registerA,4;case 72:return p.registerC=p.registerB,4;case 73:return 4;case 74:return p.registerC=p.registerD,4;case 75:return p.registerC=p.registerE,4;case 76:return p.registerC=
p.registerH,4;case 77:return p.registerC=p.registerL,4;case 78:return p.registerC=V(h(p.registerH,p.registerL)),4;case 79:return p.registerC=p.registerA,4}return-1}
function Hb(a){switch(a){case 80:return p.registerD=p.registerB,4;case 81:return p.registerD=p.registerC,4;case 82:return 4;case 83:return p.registerD=p.registerE,4;case 84:return p.registerD=p.registerH,4;case 85:return p.registerD=p.registerL,4;case 86:return p.registerD=V(h(p.registerH,p.registerL)),4;case 87:return p.registerD=p.registerA,4;case 88:return p.registerE=p.registerB,4;case 89:return p.registerE=p.registerC,4;case 90:return p.registerE=p.registerD,4;case 91:return 4;case 92:return p.registerE=
p.registerH,4;case 93:return p.registerE=p.registerL,4;case 94:return p.registerE=V(h(p.registerH,p.registerL)),4;case 95:return p.registerE=p.registerA,4}return-1}
function Ib(a){switch(a){case 96:return p.registerH=p.registerB,4;case 97:return p.registerH=p.registerC,4;case 98:return p.registerH=p.registerD,4;case 99:return p.registerH=p.registerE,4;case 100:return p.registerH=p.registerH,4;case 101:return p.registerH=p.registerL,4;case 102:return p.registerH=V(h(p.registerH,p.registerL)),4;case 103:return p.registerH=p.registerA,4;case 104:return p.registerL=p.registerB,4;case 105:return p.registerL=p.registerC,4;case 106:return p.registerL=p.registerD,4;
case 107:return p.registerL=p.registerE,4;case 108:return p.registerL=p.registerH,4;case 109:return p.registerL=p.registerL,4;case 110:return p.registerL=V(h(p.registerH,p.registerL)),4;case 111:return p.registerL=p.registerA,4}return-1}
function Jb(a){switch(a){case 112:return Ub(h(p.registerH,p.registerL),p.registerB),4;case 113:return Ub(h(p.registerH,p.registerL),p.registerC),4;case 114:return Ub(h(p.registerH,p.registerL),p.registerD),4;case 115:return Ub(h(p.registerH,p.registerL),p.registerE),4;case 116:return Ub(h(p.registerH,p.registerL),p.registerH),4;case 117:return Ub(h(p.registerH,p.registerL),p.registerL),4;case 118:return T.isHblankHdmaActive||p.enableHalt(),4;case 119:return Ub(h(p.registerH,p.registerL),p.registerA),
4;case 120:return p.registerA=p.registerB,4;case 121:return p.registerA=p.registerC,4;case 122:return p.registerA=p.registerD,4;case 123:return p.registerA=p.registerE,4;case 124:return p.registerA=p.registerH,4;case 125:return p.registerA=p.registerL,4;case 126:return p.registerA=V(h(p.registerH,p.registerL)),4;case 127:return 4}return-1}
function Kb(a){switch(a){case 128:return qb(p.registerB),4;case 129:return qb(p.registerC),4;case 130:return qb(p.registerD),4;case 131:return qb(p.registerE),4;case 132:return qb(p.registerH),4;case 133:return qb(p.registerL),4;case 134:return a=V(h(p.registerH,p.registerL)),qb(a),4;case 135:return qb(p.registerA),4;case 136:return rb(p.registerB),4;case 137:return rb(p.registerC),4;case 138:return rb(p.registerD),4;case 139:return rb(p.registerE),4;case 140:return rb(p.registerH),4;case 141:return rb(p.registerL),
4;case 142:return a=V(h(p.registerH,p.registerL)),rb(a),4;case 143:return rb(p.registerA),4}return-1}
function Lb(a){switch(a){case 144:return sb(p.registerB),4;case 145:return sb(p.registerC),4;case 146:return sb(p.registerD),4;case 147:return sb(p.registerE),4;case 148:return sb(p.registerH),4;case 149:return sb(p.registerL),4;case 150:return a=V(h(p.registerH,p.registerL)),sb(a),4;case 151:return sb(p.registerA),4;case 152:return tb(p.registerB),4;case 153:return tb(p.registerC),4;case 154:return tb(p.registerD),4;case 155:return tb(p.registerE),4;case 156:return tb(p.registerH),4;case 157:return tb(p.registerL),
4;case 158:return a=V(h(p.registerH,p.registerL)),tb(a),4;case 159:return tb(p.registerA),4}return-1}
function Nb(a){switch(a){case 160:return ub(p.registerB),4;case 161:return ub(p.registerC),4;case 162:return ub(p.registerD),4;case 163:return ub(p.registerE),4;case 164:return ub(p.registerH),4;case 165:return ub(p.registerL),4;case 166:return a=V(h(p.registerH,p.registerL)),ub(a),4;case 167:return ub(p.registerA),4;case 168:return vb(p.registerB),4;case 169:return vb(p.registerC),4;case 170:return vb(p.registerD),4;case 171:return vb(p.registerE),4;case 172:return vb(p.registerH),4;case 173:return vb(p.registerL),
4;case 174:return a=V(h(p.registerH,p.registerL)),vb(a),4;case 175:return vb(p.registerA),4}return-1}
function Ob(a){switch(a){case 176:return wb(p.registerB),4;case 177:return wb(p.registerC),4;case 178:return wb(p.registerD),4;case 179:return wb(p.registerE),4;case 180:return wb(p.registerH),4;case 181:return wb(p.registerL),4;case 182:return a=V(h(p.registerH,p.registerL)),wb(a),4;case 183:return wb(p.registerA),4;case 184:return xb(p.registerB),4;case 185:return xb(p.registerC),4;case 186:return xb(p.registerD),4;case 187:return xb(p.registerE),4;case 188:return xb(p.registerH),4;case 189:return xb(p.registerL),
4;case 190:return a=V(h(p.registerH,p.registerL)),xb(a),4;case 191:return xb(p.registerA),4}return-1}
function Pb(a){switch(a){case 192:return 0===ta()?(p.programCounter=Vb(p.stackPointer),p.stackPointer=p.stackPointer+2&65535,12):8;case 193:return a=Vb(p.stackPointer),p.stackPointer=p.stackPointer+2&65535,p.registerB=k(a),p.registerC=a&255,4;case 194:if(0===ta())return p.programCounter=Xb(),8;p.programCounter=p.programCounter+2&65535;return 12;case 195:return p.programCounter=Xb(),8;case 196:if(0===ta())return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter+2&65535),p.programCounter=
Xb(),8;p.programCounter=p.programCounter+2&65535;return 12;case 197:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,h(p.registerB,p.registerC)),8;case 198:return qb(Y()),p.programCounter=p.programCounter+1&65535,4;case 199:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter),p.programCounter=0,8;case 200:return 1===ta()?(p.programCounter=Vb(p.stackPointer),p.stackPointer=p.stackPointer+2&65535,12):8;case 201:return p.programCounter=Vb(p.stackPointer),p.stackPointer=
p.stackPointer+2&65535,8;case 202:if(1===ta())return p.programCounter=Xb(),8;p.programCounter=p.programCounter+2&65535;return 12;case 203:var c=Y();a=-1;var d=!1,e=0,f=0,m=c%8;switch(m){case 0:e=p.registerB;break;case 1:e=p.registerC;break;case 2:e=p.registerD;break;case 3:e=p.registerE;break;case 4:e=p.registerH;break;case 5:e=p.registerL;break;case 6:e=V(h(p.registerH,p.registerL));break;case 7:e=p.registerA}var z=(c&240)>>4;switch(z){case 0:7>=c?(c=e,128===(c&128)?u(1):u(0),c=(c<<1|c>>7)&255,0===
c?q(1):q(0),r(0),t(0),f=c,d=!0):15>=c&&(c=e,0<(c&1)?u(1):u(0),c=(c>>1|c<<7)&255,0===c?q(1):q(0),r(0),t(0),f=c,d=!0);break;case 1:23>=c?(c=e,d=!1,128===(c&128)&&(d=!0),c=(c<<1|ua())&255,d?u(1):u(0),0===c?q(1):q(0),r(0),t(0),f=c,d=!0):31>=c&&(c=e,d=!1,1===(c&1)&&(d=!0),c=(c>>1|ua()<<7)&255,d?u(1):u(0),0===c?q(1):q(0),r(0),t(0),f=c,d=!0);break;case 2:39>=c?(c=e,d=!1,128===(c&128)&&(d=!0),c=c<<1&255,d?u(1):u(0),0===c?q(1):q(0),r(0),t(0),f=c,d=!0):47>=c&&(c=e,d=!1,128===(c&128)&&(d=!0),e=!1,1===(c&1)&&
(e=!0),c=c>>1&255,d&&(c|=128),0===c?q(1):q(0),r(0),t(0),e?u(1):u(0),f=c,d=!0);break;case 3:55>=c?(c=e,c=((c&15)<<4|(c&240)>>4)&255,0===c?q(1):q(0),r(0),t(0),u(0),f=c,d=!0):63>=c&&(c=e,d=!1,1===(c&1)&&(d=!0),c=c>>1&255,0===c?q(1):q(0),r(0),t(0),d?u(1):u(0),f=c,d=!0);break;case 4:71>=c?(f=yb(0,e),d=!0):79>=c&&(f=yb(1,e),d=!0);break;case 5:87>=c?(f=yb(2,e),d=!0):95>=c&&(f=yb(3,e),d=!0);break;case 6:103>=c?(f=yb(4,e),d=!0):111>=c&&(f=yb(5,e),d=!0);break;case 7:119>=c?(f=yb(6,e),d=!0):127>=c&&(f=yb(7,
e),d=!0);break;case 8:135>=c?(f=zb(0,0,e),d=!0):143>=c&&(f=zb(1,0,e),d=!0);break;case 9:151>=c?(f=zb(2,0,e),d=!0):159>=c&&(f=zb(3,0,e),d=!0);break;case 10:167>=c?(f=zb(4,0,e),d=!0):175>=c&&(f=zb(5,0,e),d=!0);break;case 11:183>=c?(f=zb(6,0,e),d=!0):191>=c&&(f=zb(7,0,e),d=!0);break;case 12:199>=c?(f=zb(0,1,e),d=!0):207>=c&&(f=zb(1,1,e),d=!0);break;case 13:215>=c?(f=zb(2,1,e),d=!0):223>=c&&(f=zb(3,1,e),d=!0);break;case 14:231>=c?(f=zb(4,1,e),d=!0):239>=c&&(f=zb(5,1,e),d=!0);break;case 15:247>=c?(f=zb(6,
1,e),d=!0):255>=c&&(f=zb(7,1,e),d=!0)}switch(m){case 0:p.registerB=f;break;case 1:p.registerC=f;break;case 2:p.registerD=f;break;case 3:p.registerE=f;break;case 4:p.registerH=f;break;case 5:p.registerL=f;break;case 6:(4>z||7<z)&&Ub(h(p.registerH,p.registerL),f);break;case 7:p.registerA=f}d&&(a=4);p.programCounter=p.programCounter+1&65535;return a;case 204:if(1===ta())return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter+2),p.programCounter=Xb(),8;p.programCounter=p.programCounter+
2&65535;return 12;case 205:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter+2&65535),p.programCounter=Xb(),8;case 206:return rb(Y()),p.programCounter=p.programCounter+1&65535,4;case 207:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter),p.programCounter=8}return-1}
function Qb(a){switch(a){case 208:return 0===ua()?(p.programCounter=Vb(p.stackPointer),p.stackPointer=p.stackPointer+2&65535,12):8;case 209:return a=Vb(p.stackPointer),p.stackPointer=p.stackPointer+2&65535,p.registerD=k(a),p.registerE=a&255,4;case 210:if(0===ua())return p.programCounter=Xb(),8;p.programCounter=p.programCounter+2&65535;return 12;case 212:if(0===ua())return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter+2),p.programCounter=Xb(),8;p.programCounter=p.programCounter+
2&65535;return 12;case 213:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,h(p.registerD,p.registerE)),8;case 214:return sb(Y()),p.programCounter=p.programCounter+1&65535,4;case 215:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter),p.programCounter=16,8;case 216:return 1===ua()?(p.programCounter=Vb(p.stackPointer),p.stackPointer=p.stackPointer+2&65535,12):8;case 217:return p.programCounter=Vb(p.stackPointer),Wa(!0),p.stackPointer=p.stackPointer+2&65535,
8;case 218:if(1===ua())return p.programCounter=Xb(),8;p.programCounter=p.programCounter+2&65535;return 12;case 220:if(1===ua())return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter+2&65535),p.programCounter=Xb(),8;p.programCounter=p.programCounter+2&65535;return 12;case 222:return tb(Y()),p.programCounter=p.programCounter+1&65535,4;case 223:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter),p.programCounter=24,8}return-1}
function Rb(a){switch(a){case 224:return a=Y(),Ub(65280+a,p.registerA),p.programCounter=p.programCounter+1&65535,4;case 225:return a=Vb(p.stackPointer),p.stackPointer=p.stackPointer+2&65535,p.registerH=k(a),p.registerL=a&255,4;case 226:return Ub(65280+p.registerC,p.registerA),4;case 229:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,h(p.registerH,p.registerL)),8;case 230:return ub(Y()),p.programCounter=p.programCounter+1&65535,4;case 231:return p.stackPointer=p.stackPointer-2&65535,
Wb(p.stackPointer,p.programCounter),p.programCounter=32,8;case 232:return a=ra(Y()),xa(p.stackPointer,a,!0),p.stackPointer=p.stackPointer+a&65535,q(0),r(0),p.programCounter=p.programCounter+1&65535,12;case 233:return p.programCounter=h(p.registerH,p.registerL),4;case 234:return Ub(Xb(),p.registerA),p.programCounter=p.programCounter+2&65535,4;case 238:return vb(Y()),p.programCounter=p.programCounter+1&65535,4;case 239:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter),
p.programCounter=40,8}return-1}
function Sb(a){switch(a){case 240:return a=Y(),p.registerA=V(65280+a)&255,p.programCounter=p.programCounter+1&65535,4;case 241:return a=Vb(p.stackPointer),p.stackPointer=p.stackPointer+2&65535,p.registerA=k(a),p.registerF=a&255,4;case 242:return p.registerA=V(65280+p.registerC)&255,4;case 243:return Wa(!1),4;case 245:return p.stackPointer=p.stackPointer-2&65535,Wb(p.stackPointer,h(p.registerA,p.registerF)),8;case 246:return wb(Y()),p.programCounter=p.programCounter+1&65535,4;case 247:return p.stackPointer=
p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter),p.programCounter=48,8;case 248:return a=ra(Y()),q(0),r(0),xa(p.stackPointer,a,!0),a=p.stackPointer+a&65535,p.registerH=k(a),p.registerL=a&255,p.programCounter=p.programCounter+1&65535,8;case 249:return p.stackPointer=h(p.registerH,p.registerL),8;case 250:return p.registerA=V(Xb()),p.programCounter=p.programCounter+2&65535,4;case 251:return Wa(!0),4;case 254:return xb(Y()),p.programCounter=p.programCounter+1&65535,4;case 255:return p.stackPointer=
p.stackPointer-2&65535,Wb(p.stackPointer,p.programCounter),p.programCounter=56,8}return-1}var Yb=function(){function a(){}a.cyclesPerCycleSet=2E9;a.cycleSets=0;a.cycles=0;return a}();
function Tb(a){0<T.DMACycles&&(a+=T.DMACycles,T.DMACycles=0);p.currentCycles+=a;if(!p.isStopped){if(g.graphicsBatchProcessing){if(y.currentCycles+=a,!(y.currentCycles<y.batchProcessCycles()))for(;y.currentCycles>=y.batchProcessCycles();)nb(y.batchProcessCycles()),y.currentCycles-=y.batchProcessCycles()}else nb(a);g.audioBatchProcessing?M.currentCycles+=a:Qa(a);var c=a;if(R.transferStartFlag)for(var d=0;d<c;){var e=R.currentCycles;d+=4;R.currentCycles+=4;65535<R.currentCycles&&(R.currentCycles-=65536);
var f=R.currentCycles;var m=R.isClockSpeedFast?2:7;n(m,e)&&!n(m,f)&&(e=v(R.memoryLocationSerialTransferData),e=(e<<1)+1,e&=255,E(R.memoryLocationSerialTransferData,e),R.numberOfBitsTransferred+=1,8===R.numberOfBitsTransferred&&(R.numberOfBitsTransferred=0,P.isSerialInterruptRequested=!0,Xa(P.bitPositionSerialInterrupt),e=v(R.memoryLocationSerialTransferControl),E(R.memoryLocationSerialTransferControl,l(7,e)),R.transferStartFlag=!1))}}g.timersBatchProcessing?(Q.currentCycles+=a,ab(Q.currentCycles),
Q.currentCycles=0):ab(a);Yb.cycles+=a;Yb.cycles>=Yb.cyclesPerCycleSet&&(Yb.cycleSets+=1,Yb.cycles-=Yb.cyclesPerCycleSet)}var Z=function(){function a(){}a.stepsPerStepSet=2E9;a.stepSets=0;a.steps=0;a.RESPONSE_CONDITION_ERROR=-1;a.RESPONSE_CONDITION_FRAME=0;a.RESPONSE_CONDITION_AUDIO=1;a.RESPONSE_CONDITION_BREAKPOINT=2;return a}();function Zb(){return $b(!0,-1,-1)}
function $b(a,c,d){void 0===c&&(c=-1);void 0===d&&(d=-1);a=1024;0<c?a=c:0>c&&(a=-1);for(var e=!1,f=!1,m=!1,z=!1;!(e||f||m||z);)c=ac(),0>c?e=!0:p.currentCycles>=p.MAX_CYCLES_PER_FRAME()?f=!0:-1<a&&Ta()>=a?m=!0:-1<d&&p.programCounter===d&&(z=!0);if(f)return p.currentCycles-=p.MAX_CYCLES_PER_FRAME(),Z.RESPONSE_CONDITION_FRAME;if(m)return Z.RESPONSE_CONDITION_AUDIO;if(z)return Z.RESPONSE_CONDITION_BREAKPOINT;p.programCounter=p.programCounter-1&65535;return-1}
function ac(){bc=!0;if(p.isHaltBug){var a=v(p.programCounter);a=Bb(a);Tb(a);p.exitHaltAndStop()}P.masterInterruptSwitchDelay&&(P.masterInterruptSwitch=!0,P.masterInterruptSwitchDelay=!1);if(0<(P.interruptsEnabledValue&P.interruptsRequestedValue&31)){a=!1;P.masterInterruptSwitch&&!p.isHaltNoJump&&(P.isVBlankInterruptEnabled&&P.isVBlankInterruptRequested?(Va(P.bitPositionVBlankInterrupt),a=!0):P.isLcdInterruptEnabled&&P.isLcdInterruptRequested?(Va(P.bitPositionLcdInterrupt),a=!0):P.isTimerInterruptEnabled&&
P.isTimerInterruptRequested?(Va(P.bitPositionTimerInterrupt),a=!0):P.isSerialInterruptEnabled&&P.isSerialInterruptRequested?(Va(P.bitPositionSerialInterrupt),a=!0):P.isJoypadInterruptEnabled&&P.isJoypadInterruptRequested&&(Va(P.bitPositionJoypadInterrupt),a=!0));var c=0;a&&(c=20,p.isHalted()&&(p.exitHaltAndStop(),c+=4));p.isHalted()&&p.exitHaltAndStop();a=c}else a=0;0<a&&Tb(a);a=4;p.isHalted()||p.isStopped||(a=v(p.programCounter),a=Bb(a));p.registerF&=240;if(0>=a)return a;Tb(a);Z.steps+=1;Z.steps>=
Z.stepsPerStepSet&&(Z.stepSets+=1,Z.steps-=Z.stepsPerStepSet);return a}aa.size()<qa&&aa.grow(qa-aa.size());
var bc=!1,cc=Object.freeze({memory:aa,config:function(a,c,d,e,f,m,z,w,I,x){g.enableBootRom=0<a?!0:!1;g.useGbcWhenAvailable=0<c?!0:!1;g.audioBatchProcessing=0<d?!0:!1;g.graphicsBatchProcessing=0<e?!0:!1;g.timersBatchProcessing=0<f?!0:!1;g.graphicsDisableScanlineRendering=0<m?!0:!1;g.audioAccumulateSamples=0<z?!0:!1;g.tileRendering=0<w?!0:!1;g.tileCaching=0<I?!0:!1;g.enableAudioDebugging=0<x?!0:!1;a=v(323);p.GBCEnabled=192===a||g.useGbcWhenAvailable&&128===a?!0:!1;p.GBCDoubleSpeed=!1;p.registerA=0;
p.registerB=0;p.registerC=0;p.registerD=0;p.registerE=0;p.registerH=0;p.registerL=0;p.registerF=0;p.stackPointer=0;p.programCounter=0;p.currentCycles=0;p.isHaltNormal=!1;p.isHaltNoJump=!1;p.isHaltBug=!1;p.isStopped=!1;p.GBCEnabled?(p.registerA=17,p.registerF=128,p.registerB=0,p.registerC=0,p.registerD=255,p.registerE=86,p.registerH=0,p.registerL=13):(p.registerA=1,p.registerF=176,p.registerB=0,p.registerC=19,p.registerD=0,p.registerE=216,p.registerH=1,p.registerL=77);p.programCounter=256;p.stackPointer=
65534;T.isRamBankingEnabled=!1;T.isMBC1RomModeEnabled=!0;a=v(327);T.isRomOnly=!1;T.isMBC1=!1;T.isMBC2=!1;T.isMBC3=!1;T.isMBC5=!1;0===a?T.isRomOnly=!0:1<=a&&3>=a?T.isMBC1=!0:5<=a&&6>=a?T.isMBC2=!0:15<=a&&19>=a?T.isMBC3=!0:25<=a&&30>=a&&(T.isMBC5=!0);T.currentRomBank=1;T.currentRamBank=0;E(65361,255);E(65362,255);E(65363,255);E(65364,255);E(65365,255);y.currentCycles=0;y.scanlineCycleCounter=0;y.scanlineRegister=0;y.scrollX=0;y.scrollY=0;y.windowX=0;y.windowY=0;p.GBCEnabled?(y.scanlineRegister=144,
E(65344,145),E(65345,129),E(65348,144),E(65351,252)):(y.scanlineRegister=144,E(65344,145),E(65345,133),E(65350,255),E(65351,252),E(65352,255),E(65353,255));E(65359,0);E(65392,1);p.GBCEnabled?(E(65384,192),E(65385,255),E(65386,193),E(65387,13)):(E(65384,255),E(65385,255),E(65386,255),E(65387,255));M.currentCycles=0;M.NR50LeftMixerVolume=0;M.NR50RightMixerVolume=0;M.NR51IsChannel1EnabledOnLeftOutput=!0;M.NR51IsChannel2EnabledOnLeftOutput=!0;M.NR51IsChannel3EnabledOnLeftOutput=!0;M.NR51IsChannel4EnabledOnLeftOutput=
!0;M.NR51IsChannel1EnabledOnRightOutput=!0;M.NR51IsChannel2EnabledOnRightOutput=!0;M.NR51IsChannel3EnabledOnRightOutput=!0;M.NR51IsChannel4EnabledOnRightOutput=!0;M.NR52IsSoundEnabled=!0;M.frameSequenceCycleCounter=0;M.downSampleCycleCounter=0;M.frameSequencer=0;M.audioQueueIndex=0;F.initialize();G.initialize();H.initialize();J.initialize();E(M.memoryLocationNR50,119);E(M.memoryLocationNR51,243);E(M.memoryLocationNR52,241);L.channel1Sample=15;L.channel2Sample=15;L.channel3Sample=15;L.channel4Sample=
15;L.channel1DacEnabled=!1;L.channel2DacEnabled=!1;L.channel3DacEnabled=!1;L.channel4DacEnabled=!1;L.leftChannelSampleUnsignedByte=127;L.rightChannelSampleUnsignedByte=127;L.mixerVolumeChanged=!0;L.mixerEnabledChanged=!0;L.needToRemixSamples=!1;P.updateInterruptEnabled(0);E(P.memoryLocationInterruptEnabled,P.interruptsEnabledValue);P.updateInterruptRequested(225);E(P.memoryLocationInterruptRequest,P.interruptsRequestedValue);Q.currentCycles=0;Q.dividerRegister=0;Q.timerCounter=0;Q.timerModulo=0;Q.timerEnabled=
!1;Q.timerInputClock=0;Q.timerCounterOverflowDelay=!1;Q.timerCounterWasReset=!1;p.GBCEnabled?(E(65284,30),Q.dividerRegister=7840):(E(65284,171),Q.dividerRegister=43980);E(65287,248);Q.timerInputClock=248;R.currentCycles=0;R.numberOfBitsTransferred=0;p.GBCEnabled?(E(65282,124),R.updateTransferControl(124)):(E(65282,126),R.updateTransferControl(126));p.GBCEnabled?(E(65392,248),E(65359,254),E(65357,126),E(65280,207),E(65295,225),E(65388,254),E(65397,143)):(E(65392,255),E(65359,255),E(65357,255),E(65280,
207),E(65295,225));bc=!1;Yb.cyclesPerCycleSet=2E9;Yb.cycleSets=0;Yb.cycles=0;Z.stepsPerStepSet=2E9;Z.stepSets=0;Z.steps=0},hasCoreStarted:function(){return bc?1:0},saveState:function(){p.saveState();y.saveState();P.saveState();S.saveState();T.saveState();Q.saveState();M.saveState();F.saveState();G.saveState();H.saveState();J.saveState();bc=!1},loadState:function(){p.loadState();y.loadState();P.loadState();S.loadState();T.loadState();Q.loadState();M.loadState();F.loadState();G.loadState();H.loadState();
J.loadState();bc=!1;Yb.cyclesPerCycleSet=2E9;Yb.cycleSets=0;Yb.cycles=0;Z.stepsPerStepSet=2E9;Z.stepSets=0;Z.steps=0},isGBC:function(){return p.GBCEnabled?1:0},getStepsPerStepSet:function(){return Z.stepsPerStepSet},getStepSets:function(){return Z.stepSets},getSteps:function(){return Z.steps},executeMultipleFrames:function(a){for(var c=0,d=0;d<a&&0<=c;)c=Zb(),d+=1;return 0>c?c:0},executeFrame:Zb,executeFrameAndCheckAudio:function(a){void 0===a&&(a=0);return $b(!0,a,-1)},executeFrameUntilBreakpoint:function(a){return $b(!0,
-1,a)},executeFrameAndCheckAudioUntilBreakpoint:function(a,c){return $b(!0,a,c)},executeUntilCondition:$b,executeStep:ac,getCyclesPerCycleSet:function(){return Yb.cyclesPerCycleSet},getCycleSets:function(){return Yb.cycleSets},getCycles:function(){return Yb.cycles},setJoypadState:function(a,c,d,e,f,m,z,w){0<a?cb(0):eb(0,!1);0<c?cb(1):eb(1,!1);0<d?cb(2):eb(2,!1);0<e?cb(3):eb(3,!1);0<f?cb(4):eb(4,!1);0<m?cb(5):eb(5,!1);0<z?cb(6):eb(6,!1);0<w?cb(7):eb(7,!1)},getNumberOfSamplesInAudioBuffer:Ta,clearAudioBuffer:Oa,
WASMBOY_MEMORY_LOCATION:0,WASMBOY_MEMORY_SIZE:pa,WASMBOY_WASM_PAGES:qa,ASSEMBLYSCRIPT_MEMORY_LOCATION:0,ASSEMBLYSCRIPT_MEMORY_SIZE:1024,WASMBOY_STATE_LOCATION:1024,WASMBOY_STATE_SIZE:1024,GAMEBOY_INTERNAL_MEMORY_LOCATION:2048,GAMEBOY_INTERNAL_MEMORY_SIZE:65536,VIDEO_RAM_LOCATION:2048,VIDEO_RAM_SIZE:16384,WORK_RAM_LOCATION:18432,WORK_RAM_SIZE:32768,OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION:51200,OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE:16384,GRAPHICS_OUTPUT_LOCATION:67584,GRAPHICS_OUTPUT_SIZE:fa,GBC_PALETTE_LOCATION:67584,
GBC_PALETTE_SIZE:128,BG_PRIORITY_MAP_LOCATION:67712,BG_PRIORITY_MAP_SIZE:23552,FRAME_LOCATION:ba,FRAME_SIZE:93184,BACKGROUND_MAP_LOCATION:ca,BACKGROUND_MAP_SIZE:196608,TILE_DATA_LOCATION:da,TILE_DATA_SIZE:147456,OAM_TILES_LOCATION:ea,OAM_TILES_SIZE:15360,AUDIO_BUFFER_LOCATION:la,AUDIO_BUFFER_SIZE:131072,CHANNEL_1_BUFFER_LOCATION:ha,CHANNEL_1_BUFFER_SIZE:131072,CHANNEL_2_BUFFER_LOCATION:ia,CHANNEL_2_BUFFER_SIZE:131072,CHANNEL_3_BUFFER_LOCATION:ja,CHANNEL_3_BUFFER_SIZE:131072,CHANNEL_4_BUFFER_LOCATION:ka,
CHANNEL_4_BUFFER_SIZE:131072,CARTRIDGE_RAM_LOCATION:ma,CARTRIDGE_RAM_SIZE:131072,CARTRIDGE_ROM_LOCATION:na,CARTRIDGE_ROM_SIZE:8258560,DEBUG_GAMEBOY_MEMORY_LOCATION:oa,DEBUG_GAMEBOY_MEMORY_SIZE:65535,getWasmBoyOffsetFromGameBoyOffset:ib,getRegisterA:function(){return p.registerA},getRegisterB:function(){return p.registerB},getRegisterC:function(){return p.registerC},getRegisterD:function(){return p.registerD},getRegisterE:function(){return p.registerE},getRegisterH:function(){return p.registerH},getRegisterL:function(){return p.registerL},
getRegisterF:function(){return p.registerF},getProgramCounter:function(){return p.programCounter},getStackPointer:function(){return p.stackPointer},getOpcodeAtProgramCounter:function(){return v(p.programCounter)},getLY:function(){return y.scanlineRegister},drawBackgroundMapToWasmMemory:function(a){var c=y.memoryLocationTileDataSelectZeroStart;U.bgWindowTileDataSelect&&(c=y.memoryLocationTileDataSelectOneStart);var d=y.memoryLocationTileMapSelectZeroStart;U.bgTileMapDisplaySelect&&(d=y.memoryLocationTileMapSelectOneStart);
for(var e=0;256>e;e++)for(var f=0;256>f;f++){var m=e,z=f,w=d+32*(m>>3)+(z>>3),I=Ja(w,0);I=Ia(c,I);var x=m%8;m=z%8;m=7-m;z=0;p.GBCEnabled&&0<a&&(z=Ja(w,1));n(6,z)&&(x=7-x);var N=0;n(3,z)&&(N=1);w=Ja(I+2*x,N);I=Ja(I+2*x+1,N);x=0;n(m,I)&&(x+=1,x<<=1);n(m,w)&&(x+=1);I=3*(256*e+f);if(p.GBCEnabled&&0<a)z=Ca(z&7,x,!1),m=Ea(0,z),w=Ea(1,z),x=Ea(2,z),z=ca+I,b[z]=m,b[z+1]=w,b[z+2]=x;else for(m=Ba(x,y.memoryLocationBackgroundPalette),w=0;3>w;w++)z=ca+I+w,b[z]=m}},drawTileDataToWasmMemory:function(){for(var a=
0;23>a;a++)for(var c=0;31>c;c++){var d=0;15<c&&(d=1);var e=a;15<a&&(e-=15);e<<=4;e=15<c?e+(c-15):e+c;var f=y.memoryLocationTileDataSelectOneStart;15<a&&(f=y.memoryLocationTileDataSelectZeroStart);for(var m=0;8>m;m++)Ha(e,f,d,0,7,m,8*c,8*a+m,248,da,!0,0,-1,-1)}},drawOamToWasmMemory:function(){for(var a=0;8>a;a++)for(var c=0;5>c;c++){var d=4*(8*c+a);v(y.memoryLocationSpriteAttributesTable+d);v(y.memoryLocationSpriteAttributesTable+d+1);var e=v(y.memoryLocationSpriteAttributesTable+d+2),f=1;U.tallSpriteSize&&
(1===e%2&&--e,f+=1);var m=v(y.memoryLocationSpriteAttributesTable+d+3);d=0;p.GBCEnabled&&n(3,m)&&(d=1);for(m=0;m<f;m++)for(var z=0;8>z;z++)Ha(e+m,y.memoryLocationTileDataSelectOneStart,d,0,7,z,8*a,16*c+z+8*m,64,ea,!0,0,-1,-1)}},getDIV:function(){return Q.dividerRegister},getTIMA:function(){return Q.timerCounter},getTMA:function(){return Q.timerModulo},getTAC:function(){var a=Q.timerInputClock;Q.timerEnabled&&(a|=4);return a},updateDebugGBMemory:function(){for(var a=0;65535>a;a++){var c=gb(a);b[oa+
a]=c}},update:Zb,emulationStep:ac,getAudioQueueIndex:Ta,resetAudioQueue:Oa,wasmMemorySize:pa,wasmBoyInternalStateLocation:1024,wasmBoyInternalStateSize:1024,gameBoyInternalMemoryLocation:2048,gameBoyInternalMemorySize:65536,videoOutputLocation:67584,frameInProgressVideoOutputLocation:ba,gameboyColorPaletteLocation:67584,gameboyColorPaletteSize:128,backgroundMapLocation:ca,tileDataMap:da,soundOutputLocation:la,gameBytesLocation:na,gameRamBanksLocation:ma});
export default async()=>({instance:{exports:cc},byteMemory:aa.wasmByteMemory,type:"TypeScript"});
