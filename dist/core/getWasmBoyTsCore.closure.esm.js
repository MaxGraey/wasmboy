const b=new Uint8ClampedArray(9109504),aa={size:()=>9109504,grow:()=>{},wasmByteMemory:b};
var ba=91264,da=ba+93184,ea=da+196608,fa=ea+147456,ha=fa-67584+15360,ia=fa+15360,ja=ia+131072,ka=ja+131072,la=ka+131072,oa=la+131072,pa=oa+131072,qa=pa+131072,ra=qa+8258560,sa=ra+65535+1,ta=Math.ceil(sa/1024/64)+1,f=function(){function a(){}a.enableBootRom=!1;a.useGbcWhenAvailable=!0;a.audioBatchProcessing=!1;a.graphicsBatchProcessing=!1;a.timersBatchProcessing=!1;a.graphicsDisableScanlineRendering=!1;a.audioAccumulateSamples=!1;a.tileRendering=!1;a.tileCaching=!1;a.enableAudioDebugging=!1;return a}();
function h(a,c){return(a&255)<<8|c&255}function k(a){return(a&65280)>>8}function l(a,c){return c&~(1<<a)}function m(a,c){return 0!=(c&1<<a)}function ua(a){var c=a;m(7,c)&&(c=-1*(256-a));return c}function va(a,c){a=1<<a&255;n.registerF=0<c?n.registerF|a:n.registerF&(255^a);return n.registerF}function q(a){va(7,a)}function r(a){va(6,a)}function t(a){va(5,a)}function v(a){va(4,a)}function wa(){return n.registerF>>7&1}function xa(){return n.registerF>>4&1}
function x(a,c){0<=c?0!==((a&15)+(c&15)&16)?t(1):t(0):(Math.abs(c)&15)>(a&15)?t(1):t(0)}function ya(a,c){0<=c?a>(a+c&255)?v(1):v(0):Math.abs(c)>a?v(1):v(0)}function za(a,c,d){d?(a=a^c^a+c,0!==(a&16)?t(1):t(0),0!==(a&256)?v(1):v(0)):(d=a+c&65535,d<a?v(1):v(0),0!==((a^c^d)&4096)?t(1):t(0))}var Aa=function(){function a(){}a.memoryLocationBackgroundPaletteIndex=65384;a.memoryLocationBackgroundPaletteData=65385;a.memoryLocationSpritePaletteIndex=65386;a.memoryLocationSpritePaletteData=65387;return a}();
function Ba(a,c,d){void 0===d&&(d=!1);var e=a;d||(e=B(c)>>2*a&3);a=242;switch(e){case 1:a=160;break;case 2:a=88;break;case 3:a=8}return a}function Ca(a,c,d){c=8*a+2*c;a=Da(c+1,d);d=Da(c,d);return h(a,d)}function Ea(a,c){return 8*((c&31<<5*a)>>5*a)}function Da(a,c){a&=63;c&&(a+=64);return b[67584+a]}function Fa(a,c,d,e){void 0===d&&(d=0);void 0===e&&(e=!1);d&=3;e&&(d|=4);b[67712+(160*c+a)]=d}var Ga=function(){function a(){}a.tileId=-1;a.horizontalFlip=!1;a.nextXIndexToPerformCacheCheck=-1;return a}();
function Ha(a,c,d,e,g,p,E,u,z,w,F,y,A,U){var ca=0;c=Ia(c,a);a=Ja(c+2*p,d);d=Ja(c+2*p+1,d);for(p=e;p<=g;p++)if(c=E+(p-e),c<z){var M=p;if(0>A||!m(5,A))M=7-M;var L=0;m(M,d)&&(L+=1,L<<=1);m(M,a)&&(L+=1);if(n.GBCEnabled&&(0<=A||0<=U)){M=0<=U;var ma=A&7;M&&(ma=U&7);var na=Ca(ma,L,M);M=Ea(0,na);ma=Ea(1,na);na=Ea(2,na)}else 0>=y&&(y=C.memoryLocationBackgroundPalette),ma=M=na=Ba(L,y,F);var Oa=3*(u*z+c);b[w+Oa]=M;b[w+Oa+1]=ma;b[w+Oa+2]=na;M=!1;0<=A&&(M=m(7,A));Fa(c,u,L,M);ca++}return ca}
function Ia(a,c){if(a===C.memoryLocationTileDataSelectZeroStart){var d=c+128;m(7,c)&&(d=c-128);return a+16*d}return a+16*c}function Ka(a,c){switch(a){case 1:return m(c,129);case 2:return m(c,135);case 3:return m(c,126);default:return m(c,1)}}
var I=function(){function a(){}a.updateNRx0=function(c){a.NRx0SweepPeriod=(c&112)>>4;a.NRx0Negate=m(3,c);a.NRx0SweepShift=c&7};a.updateNRx1=function(c){a.NRx1Duty=c>>6&3;a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=m(3,c);a.NRx2EnvelopePeriod=c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=function(c){a.NRx4LengthEnabled=
m(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=function(){D(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.dutyCycle;b[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty;D(1049+50*a.saveStateSlot,a.isSweepEnabled);b[1050+50*a.saveStateSlot]=a.sweepCounter;b[1055+50*
a.saveStateSlot]=a.sweepShadowFrequency};a.loadState=function(){a.isEnabled=G(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];a.volume=b[1038+50*a.saveStateSlot];a.dutyCycle=b[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=b[1044+50*a.saveStateSlot];a.isSweepEnabled=G(1049+50*a.saveStateSlot);a.sweepCounter=b[1050+50*a.saveStateSlot];a.sweepShadowFrequency=b[1055+50*a.saveStateSlot]};a.initialize=
function(){H(a.memoryLocationNRx0,128);H(a.memoryLocationNRx1,191);H(a.memoryLocationNRx2,243);H(a.memoryLocationNRx3,193);H(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=4*(2048-a.frequency);n.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=c,a.waveFormPositionOnDuty+=
1,8<=a.waveFormPositionOnDuty&&(a.waveFormPositionOnDuty=0));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=1;Ka(a.NRx1Duty,a.waveFormPositionOnDuty)||(d*=-1);return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.sweepShadowFrequency=a.frequency;a.sweepCounter=a.NRx0SweepPeriod;a.isSweepEnabled=0<a.NRx0SweepPeriod&&0<a.NRx0SweepShift?!0:!1;0<a.NRx0SweepShift&&
La();a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.updateSweep=function(){--a.sweepCounter;0>=a.sweepCounter&&(a.sweepCounter=a.NRx0SweepPeriod,a.isSweepEnabled&&0<a.NRx0SweepPeriod&&La())};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,
0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&0<a.volume&&--a.volume))};a.setFrequency=function(c){var d=c>>8;c&=255;var e=B(a.memoryLocationNRx4)&248|d;H(a.memoryLocationNRx3,c);H(a.memoryLocationNRx4,e);a.NRx3FrequencyLSB=c;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.memoryLocationNRx0=65296;a.NRx0SweepPeriod=0;a.NRx0Negate=!1;a.NRx0SweepShift=0;a.memoryLocationNRx1=65297;a.NRx1Duty=0;a.NRx1LengthLoad=
0;a.memoryLocationNRx2=65298;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65299;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65300;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=1;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.isSweepEnabled=!1;a.sweepCounter=0;a.sweepShadowFrequency=0;a.saveStateSlot=7;return a}();
function La(){var a=Ma();2047>=a&&0<I.NRx0SweepShift&&(I.sweepShadowFrequency=a,I.setFrequency(a),a=Ma());2047<a&&(I.isEnabled=!1)}function Ma(){var a=I.sweepShadowFrequency;a>>=I.NRx0SweepShift;return a=I.NRx0Negate?I.sweepShadowFrequency-a:I.sweepShadowFrequency+a}
var J=function(){function a(){}a.updateNRx1=function(c){a.NRx1Duty=c>>6&3;a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=m(3,c);a.NRx2EnvelopePeriod=c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=function(c){a.NRx4LengthEnabled=m(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=
function(){D(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.dutyCycle;b[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty};a.loadState=function(){a.isEnabled=G(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];
a.volume=b[1038+50*a.saveStateSlot];a.dutyCycle=b[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=b[1044+50*a.saveStateSlot]};a.initialize=function(){H(a.memoryLocationNRx1-1,255);H(a.memoryLocationNRx1,63);H(a.memoryLocationNRx2,0);H(a.memoryLocationNRx3,0);H(a.memoryLocationNRx4,184)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=4*(2048-a.frequency);n.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=
function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=c,a.waveFormPositionOnDuty+=1,8<=a.waveFormPositionOnDuty&&(a.waveFormPositionOnDuty=0));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=1;Ka(a.NRx1Duty,a.waveFormPositionOnDuty)||(d*=-1);return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.isDacEnabled||
(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&0<a.volume&&--a.volume))};a.setFrequency=function(c){var d=
c>>8;c&=255;var e=B(a.memoryLocationNRx4)&248|d;H(a.memoryLocationNRx3,c);H(a.memoryLocationNRx4,e);a.NRx3FrequencyLSB=c;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.memoryLocationNRx1=65302;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65303;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65304;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65305;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=
2;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.saveStateSlot=8;return a}(),K=function(){function a(){}a.updateNRx0=function(c){a.isDacEnabled=m(7,c)};a.updateNRx1=function(c){a.NRx1LengthLoad=c;a.lengthCounter=256-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2VolumeCode=c>>5&15};a.updateNRx3=function(c){a.NRx3FrequencyLSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.updateNRx4=
function(c){a.NRx4LengthEnabled=m(6,c);a.NRx4FrequencyMSB=c&7;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.saveState=function(){D(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;b[1029+50*a.saveStateSlot]=a.lengthCounter;b[1033+50*a.saveStateSlot]=a.waveTablePosition};a.loadState=function(){a.isEnabled=G(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.lengthCounter=b[1029+50*a.saveStateSlot];a.waveTablePosition=b[1033+50*a.saveStateSlot]};
a.initialize=function(){H(a.memoryLocationNRx0,127);H(a.memoryLocationNRx1,255);H(a.memoryLocationNRx2,159);H(a.memoryLocationNRx3,0);H(a.memoryLocationNRx4,184);a.volumeCodeChanged=!0};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.resetTimer=function(){a.frequencyTimer=2*(2048-a.frequency);n.GBCDoubleSpeed&&(a.frequencyTimer*=2)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.resetTimer(),a.frequencyTimer-=
c,a.waveTablePosition+=1,32<=a.waveTablePosition&&(a.waveTablePosition=0));c=0;var d=a.volumeCode;if(a.isEnabled&&a.isDacEnabled)a.volumeCodeChanged&&(d=B(a.memoryLocationNRx2),d=d>>5&15,a.volumeCode=d,a.volumeCodeChanged=!1);else return 15;var e=B(a.memoryLocationWaveTable+(a.waveTablePosition/2|0));e=0===a.waveTablePosition%2?e>>4&15:e&15;switch(d){case 0:e>>=4;break;case 1:c=1;break;case 2:e>>=1;c=2;break;default:e>>=2,c=4}return(0<c?e/c:0)+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&
(a.lengthCounter=256);a.resetTimer();a.waveTablePosition=0;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter&&!a.volumeCodeChanged?!1:!0};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.cycleCounter=0;a.memoryLocationNRx0=65306;a.memoryLocationNRx1=65307;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65308;a.NRx2VolumeCode=0;a.memoryLocationNRx3=65309;a.NRx3FrequencyLSB=
0;a.memoryLocationNRx4=65310;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.memoryLocationWaveTable=65328;a.channelNumber=3;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.lengthCounter=0;a.waveTablePosition=0;a.volumeCode=0;a.volumeCodeChanged=!1;a.saveStateSlot=9;return a}(),N=function(){function a(){}a.updateNRx1=function(c){a.NRx1LengthLoad=c&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(c){a.NRx2StartingVolume=c>>4&15;a.NRx2EnvelopeAddMode=m(3,c);a.NRx2EnvelopePeriod=
c&7;a.isDacEnabled=0<(c&248)};a.updateNRx3=function(c){a.NRx3ClockShift=c>>4;a.NRx3WidthMode=m(3,c);a.NRx3DivisorCode=c&7;switch(a.NRx3DivisorCode){case 0:a.divisor=8;break;case 1:a.divisor=16;break;case 2:a.divisor=32;break;case 3:a.divisor=48;break;case 4:a.divisor=64;break;case 5:a.divisor=80;break;case 6:a.divisor=96;break;case 7:a.divisor=112}};a.updateNRx4=function(c){a.NRx4LengthEnabled=m(6,c)};a.saveState=function(){D(1024+50*a.saveStateSlot,a.isEnabled);b[1025+50*a.saveStateSlot]=a.frequencyTimer;
b[1029+50*a.saveStateSlot]=a.envelopeCounter;b[1033+50*a.saveStateSlot]=a.lengthCounter;b[1038+50*a.saveStateSlot]=a.volume;b[1043+50*a.saveStateSlot]=a.linearFeedbackShiftRegister};a.loadState=function(){a.isEnabled=G(1024+50*a.saveStateSlot);a.frequencyTimer=b[1025+50*a.saveStateSlot];a.envelopeCounter=b[1029+50*a.saveStateSlot];a.lengthCounter=b[1033+50*a.saveStateSlot];a.volume=b[1038+50*a.saveStateSlot];a.linearFeedbackShiftRegister=b[1043+50*a.saveStateSlot]};a.initialize=function(){H(a.memoryLocationNRx1-
1,255);H(a.memoryLocationNRx1,255);H(a.memoryLocationNRx2,0);H(a.memoryLocationNRx3,0);H(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var c=a.cycleCounter;a.cycleCounter=0;return a.getSample(c)};a.getSample=function(c){a.frequencyTimer-=c;0>=a.frequencyTimer&&(c=Math.abs(a.frequencyTimer),a.frequencyTimer=a.getNoiseChannelFrequencyPeriod(),a.frequencyTimer-=c,c=a.linearFeedbackShiftRegister&1^a.linearFeedbackShiftRegister>>1&1,a.linearFeedbackShiftRegister>>=1,a.linearFeedbackShiftRegister|=
c<<14,a.NRx3WidthMode&&(a.linearFeedbackShiftRegister&=-65,a.linearFeedbackShiftRegister|=c<<6));if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;var d=m(0,a.linearFeedbackShiftRegister)?-1:1;return d*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.frequencyTimer=a.getNoiseChannelFrequencyPeriod();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.linearFeedbackShiftRegister=32767;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=
function(c){a.cycleCounter+=c;return 0<a.frequencyTimer-a.cycleCounter?!1:!0};a.getNoiseChannelFrequencyPeriod=function(){var c=a.divisor<<a.NRx3ClockShift;n.GBCDoubleSpeed&&(c*=2);return c};a.updateLength=function(){0<a.lengthCounter&&a.NRx4LengthEnabled&&--a.lengthCounter;0===a.lengthCounter&&(a.isEnabled=!1)};a.updateEnvelope=function(){--a.envelopeCounter;0>=a.envelopeCounter&&(a.envelopeCounter=a.NRx2EnvelopePeriod,0!==a.envelopeCounter&&(a.NRx2EnvelopeAddMode&&15>a.volume?a.volume+=1:!a.NRx2EnvelopeAddMode&&
0<a.volume&&--a.volume))};a.cycleCounter=0;a.memoryLocationNRx1=65312;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65313;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65314;a.NRx3ClockShift=0;a.NRx3WidthMode=!1;a.NRx3DivisorCode=0;a.memoryLocationNRx4=65315;a.NRx4LengthEnabled=!1;a.channelNumber=4;a.isEnabled=!1;a.isDacEnabled=!1;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.divisor=0;a.linearFeedbackShiftRegister=0;a.saveStateSlot=
10;return a}(),O=function(){function a(){}a.channel1Sample=15;a.channel2Sample=15;a.channel3Sample=15;a.channel4Sample=15;a.channel1DacEnabled=!1;a.channel2DacEnabled=!1;a.channel3DacEnabled=!1;a.channel4DacEnabled=!1;a.leftChannelSampleUnsignedByte=127;a.rightChannelSampleUnsignedByte=127;a.mixerVolumeChanged=!1;a.mixerEnabledChanged=!1;a.needToRemixSamples=!1;return a}();
function Na(a){switch(a){case I.channelNumber:if(O.channel1DacEnabled!==I.isDacEnabled)return O.channel1DacEnabled=I.isDacEnabled,!0;break;case J.channelNumber:if(O.channel2DacEnabled!==J.isDacEnabled)return O.channel2DacEnabled=J.isDacEnabled,!0;break;case K.channelNumber:if(O.channel3DacEnabled!==K.isDacEnabled)return O.channel3DacEnabled=K.isDacEnabled,!0;break;case N.channelNumber:if(O.channel4DacEnabled!==N.isDacEnabled)return O.channel4DacEnabled=N.isDacEnabled,!0}return!1}
var P=function(){function a(){}a.batchProcessCycles=function(){return n.GBCDoubleSpeed?174:87};a.updateNR50=function(c){a.NR50LeftMixerVolume=c>>4&7;a.NR50RightMixerVolume=c&7};a.updateNR51=function(c){a.NR51IsChannel4EnabledOnLeftOutput=m(7,c);a.NR51IsChannel3EnabledOnLeftOutput=m(6,c);a.NR51IsChannel2EnabledOnLeftOutput=m(5,c);a.NR51IsChannel1EnabledOnLeftOutput=m(4,c);a.NR51IsChannel4EnabledOnRightOutput=m(3,c);a.NR51IsChannel3EnabledOnRightOutput=m(2,c);a.NR51IsChannel2EnabledOnRightOutput=m(1,
c);a.NR51IsChannel1EnabledOnRightOutput=m(0,c)};a.updateNR52=function(c){a.NR52IsSoundEnabled=m(7,c)};a.maxFrameSequenceCycles=function(){return n.GBCDoubleSpeed?16384:8192};a.maxDownSampleCycles=function(){return n.CLOCK_SPEED()};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.frameSequenceCycleCounter;b[1028+50*a.saveStateSlot]=a.downSampleCycleCounter;b[1029+50*a.saveStateSlot]=a.frameSequencer};a.loadState=function(){a.frameSequenceCycleCounter=b[1024+50*a.saveStateSlot];a.downSampleCycleCounter=
b[1028+50*a.saveStateSlot];a.frameSequencer=b[1029+50*a.saveStateSlot];Pa()};a.currentCycles=0;a.memoryLocationNR50=65316;a.NR50LeftMixerVolume=0;a.NR50RightMixerVolume=0;a.memoryLocationNR51=65317;a.NR51IsChannel1EnabledOnLeftOutput=!0;a.NR51IsChannel2EnabledOnLeftOutput=!0;a.NR51IsChannel3EnabledOnLeftOutput=!0;a.NR51IsChannel4EnabledOnLeftOutput=!0;a.NR51IsChannel1EnabledOnRightOutput=!0;a.NR51IsChannel2EnabledOnRightOutput=!0;a.NR51IsChannel3EnabledOnRightOutput=!0;a.NR51IsChannel4EnabledOnRightOutput=
!0;a.memoryLocationNR52=65318;a.NR52IsSoundEnabled=!0;a.memoryLocationChannel3LoadRegisterStart=65328;a.frameSequenceCycleCounter=0;a.downSampleCycleCounter=0;a.downSampleCycleMultiplier=48E3;a.frameSequencer=0;a.audioQueueIndex=0;a.wasmBoyMemoryMaxBufferSize=131072;a.saveStateSlot=6;return a}();function Qa(){if(!(P.currentCycles<P.batchProcessCycles()))for(;P.currentCycles>=P.batchProcessCycles();)Ra(P.batchProcessCycles()),P.currentCycles-=P.batchProcessCycles()}
function Ra(a){P.frameSequenceCycleCounter+=a;if(P.frameSequenceCycleCounter>=P.maxFrameSequenceCycles()){P.frameSequenceCycleCounter-=P.maxFrameSequenceCycles();switch(P.frameSequencer){case 0:I.updateLength();J.updateLength();K.updateLength();N.updateLength();break;case 2:I.updateLength();J.updateLength();K.updateLength();N.updateLength();I.updateSweep();break;case 4:I.updateLength();J.updateLength();K.updateLength();N.updateLength();break;case 6:I.updateLength();J.updateLength();K.updateLength();
N.updateLength();I.updateSweep();break;case 7:I.updateEnvelope(),J.updateEnvelope(),N.updateEnvelope()}P.frameSequencer+=1;8<=P.frameSequencer&&(P.frameSequencer=0);var c=!0}else c=!1;if(f.audioAccumulateSamples&&!c){c=I.willChannelUpdate(a)||Na(I.channelNumber);var d=J.willChannelUpdate(a)||Na(J.channelNumber),e=K.willChannelUpdate(a)||Na(K.channelNumber),g=N.willChannelUpdate(a)||Na(N.channelNumber);c&&(O.channel1Sample=I.getSampleFromCycleCounter());d&&(O.channel2Sample=J.getSampleFromCycleCounter());
e&&(O.channel3Sample=K.getSampleFromCycleCounter());g&&(O.channel4Sample=N.getSampleFromCycleCounter());if(c||d||e||g)O.needToRemixSamples=!0;P.downSampleCycleCounter+=a*P.downSampleCycleMultiplier;P.downSampleCycleCounter>=P.maxDownSampleCycles()&&(P.downSampleCycleCounter-=P.maxDownSampleCycles(),(O.needToRemixSamples||O.mixerVolumeChanged||O.mixerEnabledChanged)&&Sa(O.channel1Sample,O.channel2Sample,O.channel3Sample,O.channel4Sample),Ta(O.leftChannelSampleUnsignedByte+1,O.rightChannelSampleUnsignedByte+
1,oa),P.audioQueueIndex+=1,P.audioQueueIndex>=(P.wasmBoyMemoryMaxBufferSize/2|0)-1&&--P.audioQueueIndex)}else if(c=I.getSample(a)|0,d=J.getSample(a)|0,e=K.getSample(a)|0,g=N.getSample(a)|0,O.channel1Sample=c,O.channel2Sample=d,O.channel3Sample=e,O.channel4Sample=g,P.downSampleCycleCounter+=a*P.downSampleCycleMultiplier,P.downSampleCycleCounter>=P.maxDownSampleCycles()){P.downSampleCycleCounter-=P.maxDownSampleCycles();a=Sa(c,d,e,g);var p=k(a);Ta(p+1,(a&255)+1,oa);f.enableAudioDebugging&&(a=Sa(c,15,
15,15),p=k(a),Ta(p+1,(a&255)+1,ia),a=Sa(15,d,15,15),p=k(a),Ta(p+1,(a&255)+1,ja),a=Sa(15,15,e,15),p=k(a),Ta(p+1,(a&255)+1,ka),a=Sa(15,15,15,g),p=k(a),Ta(p+1,(a&255)+1,la));P.audioQueueIndex+=1;P.audioQueueIndex>=(P.wasmBoyMemoryMaxBufferSize/2|0)-1&&--P.audioQueueIndex}}function Ua(){return P.audioQueueIndex}function Pa(){P.audioQueueIndex=0}
function Sa(a,c,d,e){void 0===a&&(a=15);void 0===c&&(c=15);void 0===d&&(d=15);void 0===e&&(e=15);O.mixerVolumeChanged=!1;var g=0,p=0;g=P.NR51IsChannel1EnabledOnLeftOutput?g+a:g+15;g=P.NR51IsChannel2EnabledOnLeftOutput?g+c:g+15;g=P.NR51IsChannel3EnabledOnLeftOutput?g+d:g+15;g=P.NR51IsChannel4EnabledOnLeftOutput?g+e:g+15;p=P.NR51IsChannel1EnabledOnRightOutput?p+a:p+15;p=P.NR51IsChannel2EnabledOnRightOutput?p+c:p+15;p=P.NR51IsChannel3EnabledOnRightOutput?p+d:p+15;p=P.NR51IsChannel4EnabledOnRightOutput?
p+e:p+15;O.mixerEnabledChanged=!1;O.needToRemixSamples=!1;a=Va(g,P.NR50LeftMixerVolume+1);p=Va(p,P.NR50RightMixerVolume+1);O.leftChannelSampleUnsignedByte=a;O.rightChannelSampleUnsignedByte=p;return h(a,p)}function Va(a,c){if(60===a)return 127;a=1E5*(a-60)*c/8|0;a=a/1E5|0;a+=60;a=1E5*a/(12E6/254|0)|0;return a|=0}function Ta(a,c,d){d+=2*P.audioQueueIndex;b[d]=a+1;b[d+1]=c+1}
var Q=function(){function a(){}a.updateInterruptEnabled=function(c){a.isVBlankInterruptEnabled=m(a.bitPositionVBlankInterrupt,c);a.isLcdInterruptEnabled=m(a.bitPositionLcdInterrupt,c);a.isTimerInterruptEnabled=m(a.bitPositionTimerInterrupt,c);a.isSerialInterruptEnabled=m(a.bitPositionSerialInterrupt,c);a.isJoypadInterruptEnabled=m(a.bitPositionJoypadInterrupt,c);a.interruptsEnabledValue=c};a.updateInterruptRequested=function(c){a.isVBlankInterruptRequested=m(a.bitPositionVBlankInterrupt,c);a.isLcdInterruptRequested=
m(a.bitPositionLcdInterrupt,c);a.isTimerInterruptRequested=m(a.bitPositionTimerInterrupt,c);a.isSerialInterruptRequested=m(a.bitPositionSerialInterrupt,c);a.isJoypadInterruptRequested=m(a.bitPositionJoypadInterrupt,c);a.interruptsRequestedValue=c};a.areInterruptsPending=function(){return 0<(a.interruptsRequestedValue&a.interruptsEnabledValue&31)};a.saveState=function(){D(1024+50*a.saveStateSlot,a.masterInterruptSwitch);D(1025+50*a.saveStateSlot,a.masterInterruptSwitchDelay)};a.loadState=function(){a.masterInterruptSwitch=
G(1024+50*a.saveStateSlot);a.masterInterruptSwitchDelay=G(1025+50*a.saveStateSlot);a.updateInterruptEnabled(B(a.memoryLocationInterruptEnabled));a.updateInterruptRequested(B(a.memoryLocationInterruptRequest))};a.masterInterruptSwitch=!1;a.masterInterruptSwitchDelay=!1;a.bitPositionVBlankInterrupt=0;a.bitPositionLcdInterrupt=1;a.bitPositionTimerInterrupt=2;a.bitPositionSerialInterrupt=3;a.bitPositionJoypadInterrupt=4;a.memoryLocationInterruptEnabled=65535;a.interruptsEnabledValue=0;a.isVBlankInterruptEnabled=
!1;a.isLcdInterruptEnabled=!1;a.isTimerInterruptEnabled=!1;a.isSerialInterruptEnabled=!1;a.isJoypadInterruptEnabled=!1;a.memoryLocationInterruptRequest=65295;a.interruptsRequestedValue=0;a.isVBlankInterruptRequested=!1;a.isLcdInterruptRequested=!1;a.isTimerInterruptRequested=!1;a.isSerialInterruptRequested=!1;a.isJoypadInterruptRequested=!1;a.saveStateSlot=2;return a}();
function Wa(a){Xa(!1);var c=B(Q.memoryLocationInterruptRequest);c=l(a,c);Q.interruptsRequestedValue=c;H(Q.memoryLocationInterruptRequest,c);n.stackPointer-=2;n.isHalted();c=n.stackPointer;var d=n.programCounter,e=k(d),g=c+1;H(c,d&255);H(g,e);switch(a){case Q.bitPositionVBlankInterrupt:Q.isVBlankInterruptRequested=!1;n.programCounter=64;break;case Q.bitPositionLcdInterrupt:Q.isLcdInterruptRequested=!1;n.programCounter=72;break;case Q.bitPositionTimerInterrupt:Q.isTimerInterruptRequested=!1;n.programCounter=
80;break;case Q.bitPositionSerialInterrupt:Q.isSerialInterruptRequested=!1;n.programCounter=88;break;case Q.bitPositionJoypadInterrupt:Q.isJoypadInterruptRequested=!1,n.programCounter=96}}function Ya(a){var c=B(Q.memoryLocationInterruptRequest);c|=1<<a;Q.interruptsRequestedValue=c;H(Q.memoryLocationInterruptRequest,c)}function Xa(a){a?Q.masterInterruptSwitchDelay=!0:Q.masterInterruptSwitch=!1}
var R=function(){function a(){}a.batchProcessCycles=function(){return 256};a.updateDividerRegister=function(){var c=a.dividerRegister;a.dividerRegister=0;H(a.memoryLocationDividerRegister,0);a.timerEnabled&&Za(c,a.dividerRegister)&&$a()};a.updateTimerCounter=function(c){if(a.timerEnabled){if(a.timerCounterWasReset)return;a.timerCounterOverflowDelay&&(a.timerCounterOverflowDelay=!1)}a.timerCounter=c};a.updateTimerModulo=function(c){a.timerModulo=c;a.timerEnabled&&a.timerCounterWasReset&&(a.timerCounter=
a.timerModulo,a.timerCounterWasReset=!1)};a.updateTimerControl=function(c){var d=a.timerEnabled;a.timerEnabled=m(2,c);c&=3;if(!d){d=ab(a.timerInputClock);var e=ab(c);(a.timerEnabled?m(d,a.dividerRegister):m(d,a.dividerRegister)&&m(e,a.dividerRegister))&&$a()}a.timerInputClock=c};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.currentCycles;b[1028+50*a.saveStateSlot]=a.dividerRegister;D(1032+50*a.saveStateSlot,a.timerCounterOverflowDelay);D(1035+50*a.saveStateSlot,a.timerCounterWasReset);H(a.memoryLocationTimerCounter,
a.timerCounter)};a.loadState=function(){a.currentCycles=b[1024+50*a.saveStateSlot];a.dividerRegister=b[1028+50*a.saveStateSlot];a.timerCounterOverflowDelay=G(1032+50*a.saveStateSlot);a.timerCounterWasReset=G(1035+50*a.saveStateSlot);a.timerCounter=B(a.memoryLocationTimerCounter);a.timerModulo=B(a.memoryLocationTimerModulo);a.timerInputClock=B(a.memoryLocationTimerControl)};a.currentCycles=0;a.memoryLocationDividerRegister=65284;a.dividerRegister=0;a.memoryLocationTimerCounter=65285;a.timerCounter=
0;a.timerCounterOverflowDelay=!1;a.timerCounterWasReset=!1;a.timerCounterMask=0;a.memoryLocationTimerModulo=65286;a.timerModulo=0;a.memoryLocationTimerControl=65287;a.timerEnabled=!1;a.timerInputClock=0;a.saveStateSlot=5;return a}();
function cb(a){for(var c=0;c<a;){var d=R.dividerRegister;c+=4;R.dividerRegister+=4;65535<R.dividerRegister&&(R.dividerRegister-=65536);R.timerEnabled&&(R.timerCounterOverflowDelay?(R.timerCounter=R.timerModulo,Q.isTimerInterruptRequested=!0,Ya(Q.bitPositionTimerInterrupt),R.timerCounterOverflowDelay=!1,R.timerCounterWasReset=!0):R.timerCounterWasReset&&(R.timerCounterWasReset=!1),Za(d,R.dividerRegister)&&$a())}}
function $a(){R.timerCounter+=1;255<R.timerCounter&&(R.timerCounterOverflowDelay=!0,R.timerCounter=0)}function Za(a,c){var d=ab(R.timerInputClock);return m(d,a)&&!m(d,c)?!0:!1}function ab(a){switch(a){case 0:return 9;case 1:return 3;case 2:return 5;case 3:return 7}return 0}
var S=function(){function a(){}a.updateTransferControl=function(c){a.isShiftClockInternal=m(0,c);a.isClockSpeedFast=m(1,c);a.transferStartFlag=m(7,c);return!0};a.currentCycles=0;a.memoryLocationSerialTransferData=65281;a.memoryLocationSerialTransferControl=65282;a.numberOfBitsTransferred=0;a.isShiftClockInternal=!1;a.isClockSpeedFast=!1;a.transferStartFlag=!1;return a}(),T=function(){function a(){}a.updateJoypad=function(c){a.joypadRegisterFlipped=c^255;a.isDpadType=m(4,a.joypadRegisterFlipped);a.isButtonType=
m(5,a.joypadRegisterFlipped)};a.saveState=function(){};a.loadState=function(){a.updateJoypad(B(a.memoryLocationJoypadRegister))};a.up=!1;a.down=!1;a.left=!1;a.right=!1;a.a=!1;a.b=!1;a.select=!1;a.start=!1;a.memoryLocationJoypadRegister=65280;a.joypadRegisterFlipped=0;a.isDpadType=!1;a.isButtonType=!1;a.saveStateSlot=3;return a}();
function db(a){var c=n.isStopped=!1;eb(a)||(c=!0);fb(a,!0);c&&(c=!1,3>=a&&(c=!0),a=!1,T.isDpadType&&c&&(a=!0),T.isButtonType&&!c&&(a=!0),a&&(Q.isJoypadInterruptRequested=!0,Ya(Q.bitPositionJoypadInterrupt)))}function eb(a){switch(a){case 0:return T.up;case 1:return T.right;case 2:return T.down;case 3:return T.left;case 4:return T.a;case 5:return T.b;case 6:return T.select;case 7:return T.start;default:return!1}}
function fb(a,c){switch(a){case 0:T.up=c;break;case 1:T.right=c;break;case 2:T.down=c;break;case 3:T.left=c;break;case 4:T.a=c;break;case 5:T.b=c;break;case 6:T.select=c;break;case 7:T.start=c}}function gb(a,c,d){for(var e=0;e<d;e++){for(var g=hb(a+e),p=c+e;40959<p;)p-=8192;ib(p,g)}a=32;n.GBCDoubleSpeed&&(a=64);V.DMACycles+=d/16*a}
function jb(a,c){if(a===n.memoryLocationSpeedSwitch)return H(n.memoryLocationSpeedSwitch,c&1),!1;var d=V.videoRamLocation,e=V.spriteInformationTableLocation;if(a<d){if(!V.isRomOnly)if(8191>=a){if(!V.isMBC2||m(4,c))c&=15,0===c?V.isRamBankingEnabled=!1:10===c&&(V.isRamBankingEnabled=!0)}else 16383>=a?!V.isMBC5||12287>=a?(V.isMBC2&&(V.currentRomBank=c&15),V.isMBC1?(c&=31,V.currentRomBank&=224):V.isMBC3?(c&=127,V.currentRomBank&=128):V.isMBC5&&(V.currentRomBank&=0),V.currentRomBank|=c):(a=0,d=V.currentRomBank&
255,0<c&&(a=1),V.currentRomBank=h(a,d)):!V.isMBC2&&24575>=a?V.isMBC1&&V.isMBC1RomModeEnabled?(V.currentRomBank&=31,V.currentRomBank|=c&224):(c=V.isMBC5?c&15:c&3,V.currentRamBank=c):!V.isMBC2&&32767>=a&&V.isMBC1&&(m(0,c)?V.isMBC1RomModeEnabled=!0:V.isMBC1RomModeEnabled=!1);return!1}if(a>=d&&a<V.cartridgeRamLocation)return!0;if(a>=V.echoRamLocation&&a<e)return H(a-8192,c),!0;if(a>=e&&a<=V.spriteInformationTableLocationEnd)return 2>W.currentLcdMode?!1:!0;if(a>=V.unusableMemoryLocation&&a<=V.unusableMemoryEndLocation)return!1;
if(a===S.memoryLocationSerialTransferControl)return S.updateTransferControl(c);if(65296<=a&&65318>=a){Qa();if(a===P.memoryLocationNR52||P.NR52IsSoundEnabled){switch(a){case I.memoryLocationNRx0:I.updateNRx0(c);break;case K.memoryLocationNRx0:K.updateNRx0(c);break;case I.memoryLocationNRx1:I.updateNRx1(c);break;case J.memoryLocationNRx1:J.updateNRx1(c);break;case K.memoryLocationNRx1:K.updateNRx1(c);break;case N.memoryLocationNRx1:N.updateNRx1(c);break;case I.memoryLocationNRx2:I.updateNRx2(c);break;
case J.memoryLocationNRx2:J.updateNRx2(c);break;case K.memoryLocationNRx2:K.volumeCodeChanged=!0;K.updateNRx2(c);break;case N.memoryLocationNRx2:N.updateNRx2(c);break;case I.memoryLocationNRx3:I.updateNRx3(c);break;case J.memoryLocationNRx3:J.updateNRx3(c);break;case K.memoryLocationNRx3:K.updateNRx3(c);break;case N.memoryLocationNRx3:N.updateNRx3(c);break;case I.memoryLocationNRx4:m(7,c)&&(I.updateNRx4(c),I.trigger());break;case J.memoryLocationNRx4:m(7,c)&&(J.updateNRx4(c),J.trigger());break;case K.memoryLocationNRx4:m(7,
c)&&(K.updateNRx4(c),K.trigger());break;case N.memoryLocationNRx4:m(7,c)&&(N.updateNRx4(c),N.trigger());break;case P.memoryLocationNR50:P.updateNR50(c);O.mixerVolumeChanged=!0;break;case P.memoryLocationNR51:P.updateNR51(c);O.mixerEnabledChanged=!0;break;case P.memoryLocationNR52:if(P.updateNR52(c),!m(7,c))for(c=65296;65318>c;c++)H(c,0)}c=!0}else c=!1;return c}65328<=a&&65343>=a&&Qa();if(a>=W.memoryLocationLcdControl&&a<=C.memoryLocationWindowX){if(a===W.memoryLocationLcdControl)return W.updateLcdControl(c),
!0;if(a===W.memoryLocationLcdStatus)return W.updateLcdStatus(c),!1;if(a===C.memoryLocationScanlineRegister)return C.scanlineRegister=0,H(a,0),!1;if(a===W.memoryLocationCoincidenceCompare)return W.coincidenceCompare=c,!0;if(a===C.memoryLocationDmaTransfer){c<<=8;for(a=0;159>=a;a++)d=B(c+a),H(V.spriteInformationTableLocation+a,d);V.DMACycles=644;return!0}switch(a){case C.memoryLocationScrollX:C.scrollX=c;break;case C.memoryLocationScrollY:C.scrollY=c;break;case C.memoryLocationWindowX:C.windowX=c;break;
case C.memoryLocationWindowY:C.windowY=c}return!0}if(a===V.memoryLocationHdmaTrigger)return n.GBCEnabled&&(V.isHblankHdmaActive&&!m(7,c)?(V.isHblankHdmaActive=!1,c=B(V.memoryLocationHdmaTrigger),H(V.memoryLocationHdmaTrigger,c|128)):(a=B(V.memoryLocationHdmaSourceHigh),d=B(V.memoryLocationHdmaSourceLow),a=h(a,d)&65520,d=B(V.memoryLocationHdmaDestinationHigh),e=B(V.memoryLocationHdmaDestinationLow),d=h(d,e),d=(d&8176)+V.videoRamLocation,e=l(7,c),e=16*(e+1),m(7,c)?(V.isHblankHdmaActive=!0,V.hblankHdmaTransferLengthRemaining=
e,V.hblankHdmaSource=a,V.hblankHdmaDestination=d,H(V.memoryLocationHdmaTrigger,l(7,c))):(gb(a,d,e),H(V.memoryLocationHdmaTrigger,255)))),!1;if((a===V.memoryLocationGBCWRAMBank||a===V.memoryLocationGBCVRAMBank)&&V.isHblankHdmaActive&&(16384<=V.hblankHdmaSource&&32767>=V.hblankHdmaSource||53248<=V.hblankHdmaSource&&57343>=V.hblankHdmaSource))return!1;if(a>=Aa.memoryLocationBackgroundPaletteIndex&&a<=Aa.memoryLocationSpritePaletteData){if(a===Aa.memoryLocationBackgroundPaletteData||a===Aa.memoryLocationSpritePaletteData){d=
B(a-1);d=l(6,d);e=!1;a===Aa.memoryLocationSpritePaletteData&&(e=!0);var g=d&63;e&&(g+=64);b[67584+g]=c;c=d;--a;m(7,c)&&H(a,c+1|128)}return!0}if(a>=R.memoryLocationDividerRegister&&a<=R.memoryLocationTimerControl){cb(R.currentCycles);R.currentCycles=0;switch(a){case R.memoryLocationDividerRegister:return R.updateDividerRegister(c),!1;case R.memoryLocationTimerCounter:R.updateTimerCounter(c);break;case R.memoryLocationTimerModulo:R.updateTimerModulo(c);break;case R.memoryLocationTimerControl:R.updateTimerControl(c)}return!0}a===
T.memoryLocationJoypadRegister&&T.updateJoypad(c);if(a===Q.memoryLocationInterruptRequest)return Q.updateInterruptRequested(c),!0;a===Q.memoryLocationInterruptEnabled&&Q.updateInterruptEnabled(c);return!0}
function kb(a){switch(a>>12){case 0:case 1:case 2:case 3:return a+qa;case 4:case 5:case 6:case 7:var c=V.currentRomBank;V.isMBC5||0!==c||(c=1);return 16384*c+(a-V.switchableCartridgeRomLocation)+qa;case 8:case 9:return c=0,n.GBCEnabled&&(c=B(V.memoryLocationGBCVRAMBank)&1),a-V.videoRamLocation+2048+8192*c;case 10:case 11:return 8192*V.currentRamBank+(a-V.cartridgeRamLocation)+pa;case 12:return a-V.internalRamBankZeroLocation+18432;case 13:return c=0,n.GBCEnabled&&(c=B(V.memoryLocationGBCWRAMBank)&
7),1>c&&(c=1),a-V.internalRamBankZeroLocation+18432+4096*(c-1);default:return a-V.echoRamLocation+51200}}var lb=function(){function a(){}a.programCounter=-1;a.readGbMemory=-1;a.writeGbMemory=-1;a.reachedBreakpoint=!1;return a}();function H(a,c){a=kb(a);b[a]=c}function ib(a,c){a===lb.writeGbMemory&&(lb.reachedBreakpoint=!0);jb(a,c)&&H(a,c)}function D(a,c){b[a]=c?1:0}
var W=function(){function a(){}a.updateLcdStatus=function(c){var d=B(a.memoryLocationLcdStatus);c=c&248|d&7|128;H(a.memoryLocationLcdStatus,c)};a.updateLcdControl=function(c){var d=a.enabled;a.enabled=m(7,c);a.windowTileMapDisplaySelect=m(6,c);a.windowDisplayEnabled=m(5,c);a.bgWindowTileDataSelect=m(4,c);a.bgTileMapDisplaySelect=m(3,c);a.tallSpriteSize=m(2,c);a.spriteDisplayEnable=m(1,c);a.bgDisplayEnabled=m(0,c);d&&!a.enabled&&mb(!0);!d&&a.enabled&&mb(!1)};a.memoryLocationLcdStatus=65345;a.currentLcdMode=
0;a.memoryLocationCoincidenceCompare=65349;a.coincidenceCompare=0;a.memoryLocationLcdControl=65344;a.enabled=!0;a.windowTileMapDisplaySelect=!1;a.windowDisplayEnabled=!1;a.bgWindowTileDataSelect=!1;a.bgTileMapDisplaySelect=!1;a.tallSpriteSize=!1;a.spriteDisplayEnable=!1;a.bgDisplayEnabled=!1;return a}();
function mb(a){C.scanlineCycleCounter=0;C.scanlineRegister=0;H(C.memoryLocationScanlineRegister,0);var c=B(W.memoryLocationLcdStatus);c=l(1,c);c=l(0,c);W.currentLcdMode=0;H(W.memoryLocationLcdStatus,c);if(a)for(a=0;a<ha;a++)b[67584+a]=255}function nb(a,c){var d=W.coincidenceCompare;0!==a&&1!==a||C.scanlineRegister!==d?c=l(2,c):(c|=4,m(6,c)&&(Q.isLcdInterruptRequested=!0,Ya(Q.bitPositionLcdInterrupt)));return c}
function ob(a,c,d,e,g,p){for(var E=e>>3;160>g;g++){var u=g+p;256<=u&&(u-=256);var z=d+32*E+(u>>3),w=Ja(z,0),F=!1;if(f.tileCaching){var y=g;var A=a,U=u,ca=z,M=w,L=0;if(0<A&&8<y&&M===Ga.tileId&&y===Ga.nextXIndexToPerformCacheCheck){var ma=M=!1;m(5,B(ca-1))&&(M=!0);m(5,B(ca))&&(ma=!0);for(ca=0;8>ca;ca++)if(M!==ma&&(ca=7-ca),160>=y+ca){for(var na=y-(8-ca),Oa=ba+3*(160*A+(y+ca)),bb=0;3>bb;bb++)pb(y+ca,A,bb,b[Oa+bb]);na=b[67712+(160*A+na)];Fa(y+ca,A,l(2,na),m(2,na));L++}}else Ga.tileId=M;y>=Ga.nextXIndexToPerformCacheCheck&&
(Ga.nextXIndexToPerformCacheCheck=y+8,A=U%8,y<A&&(Ga.nextXIndexToPerformCacheCheck+=A));y=L;0<y&&(g+=y-1,F=!0)}f.tileRendering&&!F?(F=g,y=a,L=c,A=e%8,U=0,0==F&&(U=u-u/8*8),u=7,160<F+8&&(u=160-F),M=-1,ma=0,n.GBCEnabled&&(M=Ja(z,1),m(3,M)&&(ma=1),m(6,M)&&(A=7-A)),y=Ha(w,L,ma,U,u,A,F,y,160,ba,!1,0,M,-1),0<y&&(g+=y-1)):F||(n.GBCEnabled?(F=g,y=a,A=e,L=Ia(c,w),z=Ja(z,1),A%=8,m(6,z)&&(A=7-A),U=0,m(3,z)&&(U=1),w=Ja(L+2*A,U),L=Ja(L+2*A+1,U),A=u%8,m(5,z)||(A=7-A),u=0,m(A,L)&&(u=u+1<<1),m(A,w)&&(u+=1),A=Ca(z&
7,u,!1),w=Ea(0,A),L=Ea(1,A),A=Ea(2,A),pb(F,y,0,w),pb(F,y,1,L),pb(F,y,2,A),Fa(F,y,u,m(7,z))):(z=g,F=a,L=e,y=Ia(c,w),L%=8,w=Ja(y+2*L,0),y=Ja(y+2*L+1,0),L=7-u%8,u=0,m(L,y)&&(u=u+1<<1),m(L,w)&&(u+=1),w=Ba(u,C.memoryLocationBackgroundPalette),pb(z,F,0,w),pb(z,F,1,w),pb(z,F,2,w),Fa(z,F,u)))}}
var C=function(){function a(){}a.batchProcessCycles=function(){return a.MAX_CYCLES_PER_SCANLINE()};a.MAX_CYCLES_PER_SCANLINE=function(){return n.GBCDoubleSpeed?153===a.scanlineRegister?8:912:153===a.scanlineRegister?4:456};a.MIN_CYCLES_SPRITES_LCD_MODE=function(){return n.GBCDoubleSpeed?752:376};a.MIN_CYCLES_TRANSFER_DATA_LCD_MODE=function(){return n.GBCDoubleSpeed?498:249};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.scanlineCycleCounter;b[1028+50*a.saveStateSlot]=W.currentLcdMode;H(a.memoryLocationScanlineRegister,
a.scanlineRegister)};a.loadState=function(){a.scanlineCycleCounter=b[1024+50*a.saveStateSlot];W.currentLcdMode=b[1028+50*a.saveStateSlot];a.scanlineRegister=B(a.memoryLocationScanlineRegister);W.updateLcdControl(B(W.memoryLocationLcdControl))};a.currentCycles=0;a.scanlineCycleCounter=0;a.memoryLocationScanlineRegister=65348;a.scanlineRegister=0;a.memoryLocationDmaTransfer=65350;a.memoryLocationScrollX=65347;a.scrollX=0;a.memoryLocationScrollY=65346;a.scrollY=0;a.memoryLocationWindowX=65355;a.windowX=
0;a.memoryLocationWindowY=65354;a.windowY=0;a.memoryLocationTileMapSelectZeroStart=38912;a.memoryLocationTileMapSelectOneStart=39936;a.memoryLocationTileDataSelectZeroStart=34816;a.memoryLocationTileDataSelectOneStart=32768;a.memoryLocationSpriteAttributesTable=65024;a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;a.saveStateSlot=1;return a}();
function qb(a){if(W.enabled)for(C.scanlineCycleCounter+=a;C.scanlineCycleCounter>=C.MAX_CYCLES_PER_SCANLINE();){C.scanlineCycleCounter-=C.MAX_CYCLES_PER_SCANLINE();a=C.scanlineRegister;if(144===a){if(f.graphicsDisableScanlineRendering)for(var c=0;144>=c;c++)rb(c);else rb(a);for(c=0;144>c;c++)for(var d=0;160>d;d++)b[67712+(160*c+d)]=0;Ga.tileId=-1;Ga.nextXIndexToPerformCacheCheck=-1}else 144>a&&(f.graphicsDisableScanlineRendering||rb(a));a=153<a?0:a+1;C.scanlineRegister=a}if(W.enabled)if(c=C.scanlineRegister,
d=W.currentLcdMode,a=0,144<=c?a=1:C.scanlineCycleCounter>=C.MIN_CYCLES_SPRITES_LCD_MODE()?a=2:C.scanlineCycleCounter>=C.MIN_CYCLES_TRANSFER_DATA_LCD_MODE()&&(a=3),d!==a){c=B(W.memoryLocationLcdStatus);W.currentLcdMode=a;d=!1;switch(a){case 0:c=l(0,c);c=l(1,c);d=m(3,c);break;case 1:c=l(1,c);c|=1;d=m(4,c);break;case 2:c=l(0,c);c|=2;d=m(5,c);break;case 3:c|=3}d&&(Q.isLcdInterruptRequested=!0,Ya(Q.bitPositionLcdInterrupt));0===a&&V.isHblankHdmaActive&&(d=16,V.hblankHdmaTransferLengthRemaining<d&&(d=V.hblankHdmaTransferLengthRemaining),
gb(V.hblankHdmaSource,V.hblankHdmaDestination,d),V.hblankHdmaSource+=d,V.hblankHdmaDestination+=d,V.hblankHdmaTransferLengthRemaining-=d,0>=V.hblankHdmaTransferLengthRemaining?(V.isHblankHdmaActive=!1,H(V.memoryLocationHdmaTrigger,255)):H(V.memoryLocationHdmaTrigger,l(7,V.hblankHdmaTransferLengthRemaining/16-1)));1===a&&(Q.isVBlankInterruptRequested=!0,Ya(Q.bitPositionVBlankInterrupt));c=nb(a,c);H(W.memoryLocationLcdStatus,c)}else 153===c&&(c=B(W.memoryLocationLcdStatus),c=nb(a,c),H(W.memoryLocationLcdStatus,
c))}
function rb(a){var c=C.memoryLocationTileDataSelectZeroStart;W.bgWindowTileDataSelect&&(c=C.memoryLocationTileDataSelectOneStart);if(n.GBCEnabled||W.bgDisplayEnabled){var d=C.memoryLocationTileMapSelectZeroStart;W.bgTileMapDisplaySelect&&(d=C.memoryLocationTileMapSelectOneStart);var e=C.scrollX,g=a+C.scrollY;256<=g&&(g-=256);ob(a,c,d,g,0,e)}W.windowDisplayEnabled&&(d=C.memoryLocationTileMapSelectZeroStart,W.windowTileMapDisplaySelect&&(d=C.memoryLocationTileMapSelectOneStart),e=C.windowX,g=C.windowY,a<
g||(e-=7,ob(a,c,d,a-g,e,-1*e)));if(W.spriteDisplayEnable)for(c=W.tallSpriteSize,d=39;0<=d;d--){g=4*d;var p=B(C.memoryLocationSpriteAttributesTable+g);e=B(C.memoryLocationSpriteAttributesTable+g+1);var E=B(C.memoryLocationSpriteAttributesTable+g+2);p-=16;e-=8;var u=8;c&&(u=16,1===E%2&&--E);if(a>=p&&a<p+u){g=B(C.memoryLocationSpriteAttributesTable+g+3);var z=m(7,g),w=m(6,g),F=m(5,g);p=a-p;w&&(p-=u,p*=-1,--p);p*=2;E=Ia(C.memoryLocationTileDataSelectOneStart,E);u=E+=p;p=0;n.GBCEnabled&&m(3,g)&&(p=1);
E=Ja(u,p);u=Ja(u+1,p);for(p=7;0<=p;p--){w=p;F&&(w-=7,w*=-1);var y=0;m(w,u)&&(y+=1,y<<=1);m(w,E)&&(y+=1);if(0!==y&&(w=e+(7-p),0<=w&&160>=w)){var A=!1,U=!1,ca=!1;n.GBCEnabled&&!W.bgDisplayEnabled&&(A=!0);if(!A){var M=b[67712+(160*a+w)],L=M&3;z&&0<L?U=!0:n.GBCEnabled&&m(2,M)&&0<L&&(ca=!0)}if(A||!U&&!ca)n.GBCEnabled?(U=Ca(g&7,y,!0),y=Ea(0,U),A=Ea(1,U),U=Ea(2,U),pb(w,a,0,y),pb(w,a,1,A),pb(w,a,2,U)):(A=C.memoryLocationSpritePaletteOne,m(4,g)&&(A=C.memoryLocationSpritePaletteTwo),y=Ba(y,A),pb(w,a,0,y),pb(w,
a,1,y),pb(w,a,2,y))}}}}}function pb(a,c,d,e){b[ba+3*(160*c+a)+d]=e}function Ja(a,c){return b[a-V.videoRamLocation+2048+8192*(c&1)]}
function sb(a){var c=V.videoRamLocation;return a<c||a>=c&&a<V.cartridgeRamLocation?-1:a>=V.echoRamLocation&&a<V.spriteInformationTableLocation?B(a-8192):a>=V.spriteInformationTableLocation&&a<=V.spriteInformationTableLocationEnd?2>W.currentLcdMode?255:-1:a===n.memoryLocationSpeedSwitch?(a=255,c=B(n.memoryLocationSpeedSwitch),m(0,c)||(a=l(0,a)),n.GBCDoubleSpeed||(a=l(7,a)),a):a===C.memoryLocationScanlineRegister?(H(a,C.scanlineRegister),C.scanlineRegister):65296<=a&&65318>=a?(Qa(),a=a===P.memoryLocationNR52?
B(P.memoryLocationNR52)&128|112:-1,a):65328<=a&&65343>=a?(Qa(),-1):a===R.memoryLocationDividerRegister?(c=k(R.dividerRegister),H(a,c),c):a===R.memoryLocationTimerCounter?(H(a,R.timerCounter),R.timerCounter):a===Q.memoryLocationInterruptRequest?224|Q.interruptsRequestedValue:a===T.memoryLocationJoypadRegister?(a=T.joypadRegisterFlipped,T.isDpadType?(a=T.up?l(2,a):a|4,a=T.right?l(0,a):a|1,a=T.down?l(3,a):a|8,a=T.left?l(1,a):a|2):T.isButtonType&&(a=T.a?l(0,a):a|1,a=T.b?l(1,a):a|2,a=T.select?l(2,a):a|
4,a=T.start?l(3,a):a|8),a|240):-1}function B(a){return b[kb(a)]}function hb(a){a===lb.readGbMemory&&(lb.reachedBreakpoint=!0);var c=sb(a);switch(c){case -1:return B(a);default:return c}}function G(a){return 0<b[a]?!0:!1}
var V=function(){function a(){}a.saveState=function(){b[1024+50*a.saveStateSlot]=a.currentRomBank;b[1026+50*a.saveStateSlot]=a.currentRamBank;D(1028+50*a.saveStateSlot,a.isRamBankingEnabled);D(1029+50*a.saveStateSlot,a.isMBC1RomModeEnabled);D(1030+50*a.saveStateSlot,a.isRomOnly);D(1031+50*a.saveStateSlot,a.isMBC1);D(1032+50*a.saveStateSlot,a.isMBC2);D(1033+50*a.saveStateSlot,a.isMBC3);D(1034+50*a.saveStateSlot,a.isMBC5)};a.loadState=function(){a.currentRomBank=b[1024+50*a.saveStateSlot];a.currentRamBank=
b[1026+50*a.saveStateSlot];a.isRamBankingEnabled=G(1028+50*a.saveStateSlot);a.isMBC1RomModeEnabled=G(1029+50*a.saveStateSlot);a.isRomOnly=G(1030+50*a.saveStateSlot);a.isMBC1=G(1031+50*a.saveStateSlot);a.isMBC2=G(1032+50*a.saveStateSlot);a.isMBC3=G(1033+50*a.saveStateSlot);a.isMBC5=G(1034+50*a.saveStateSlot)};a.cartridgeRomLocation=0;a.switchableCartridgeRomLocation=16384;a.videoRamLocation=32768;a.cartridgeRamLocation=40960;a.internalRamBankZeroLocation=49152;a.internalRamBankOneLocation=53248;a.echoRamLocation=
57344;a.spriteInformationTableLocation=65024;a.spriteInformationTableLocationEnd=65183;a.unusableMemoryLocation=65184;a.unusableMemoryEndLocation=65279;a.currentRomBank=0;a.currentRamBank=0;a.isRamBankingEnabled=!1;a.isMBC1RomModeEnabled=!0;a.isRomOnly=!0;a.isMBC1=!1;a.isMBC2=!1;a.isMBC3=!1;a.isMBC5=!1;a.memoryLocationHdmaSourceHigh=65361;a.memoryLocationHdmaSourceLow=65362;a.memoryLocationHdmaDestinationHigh=65363;a.memoryLocationHdmaDestinationLow=65364;a.memoryLocationHdmaTrigger=65365;a.DMACycles=
0;a.isHblankHdmaActive=!1;a.hblankHdmaTransferLengthRemaining=0;a.hblankHdmaSource=0;a.hblankHdmaDestination=0;a.memoryLocationGBCVRAMBank=65359;a.memoryLocationGBCWRAMBank=65392;a.saveStateSlot=4;return a}(),n=function(){function a(){}a.CLOCK_SPEED=function(){return a.GBCDoubleSpeed?8388608:4194304};a.MAX_CYCLES_PER_FRAME=function(){return a.GBCDoubleSpeed?140448:70224};a.enableHalt=function(){Q.masterInterruptSwitch?a.isHaltNormal=!0:0===(Q.interruptsEnabledValue&Q.interruptsRequestedValue&31)?
a.isHaltNoJump=!0:a.isHaltBug=!0};a.exitHaltAndStop=function(){a.isHaltNoJump=!1;a.isHaltNormal=!1;a.isHaltBug=!1;a.isStopped=!1};a.isHalted=function(){return a.isHaltNormal||a.isHaltNoJump?!0:!1};a.saveState=function(){b[1024+50*a.saveStateSlot]=a.registerA;b[1025+50*a.saveStateSlot]=a.registerB;b[1026+50*a.saveStateSlot]=a.registerC;b[1027+50*a.saveStateSlot]=a.registerD;b[1028+50*a.saveStateSlot]=a.registerE;b[1029+50*a.saveStateSlot]=a.registerH;b[1030+50*a.saveStateSlot]=a.registerL;b[1031+50*
a.saveStateSlot]=a.registerF;b[1032+50*a.saveStateSlot]=a.stackPointer;b[1034+50*a.saveStateSlot]=a.programCounter;b[1036+50*a.saveStateSlot]=a.currentCycles;D(1041+50*a.saveStateSlot,a.isHaltNormal);D(1042+50*a.saveStateSlot,a.isHaltNoJump);D(1043+50*a.saveStateSlot,a.isHaltBug);D(1044+50*a.saveStateSlot,a.isStopped)};a.loadState=function(){a.registerA=b[1024+50*a.saveStateSlot];a.registerB=b[1025+50*a.saveStateSlot];a.registerC=b[1026+50*a.saveStateSlot];a.registerD=b[1027+50*a.saveStateSlot];a.registerE=
b[1028+50*a.saveStateSlot];a.registerH=b[1029+50*a.saveStateSlot];a.registerL=b[1030+50*a.saveStateSlot];a.registerF=b[1031+50*a.saveStateSlot];a.stackPointer=b[1032+50*a.saveStateSlot];a.programCounter=b[1034+50*a.saveStateSlot];a.currentCycles=b[1036+50*a.saveStateSlot];a.isHaltNormal=G(1041+50*a.saveStateSlot);a.isHaltNoJump=G(1042+50*a.saveStateSlot);a.isHaltBug=G(1043+50*a.saveStateSlot);a.isStopped=G(1044+50*a.saveStateSlot)};a.GBCEnabled=!1;a.memoryLocationSpeedSwitch=65357;a.GBCDoubleSpeed=
!1;a.registerA=0;a.registerB=0;a.registerC=0;a.registerD=0;a.registerE=0;a.registerH=0;a.registerL=0;a.registerF=0;a.stackPointer=0;a.programCounter=0;a.currentCycles=0;a.isHaltNormal=!1;a.isHaltNoJump=!1;a.isHaltBug=!1;a.isStopped=!1;a.saveStateSlot=0;return a}();function tb(a){x(n.registerA,a);ya(n.registerA,a);n.registerA=n.registerA+a&255;0===n.registerA?q(1):q(0);r(0)}
function ub(a){var c=n.registerA+a+xa()&255;0!=((n.registerA^a^c)&16)?t(1):t(0);0<(n.registerA+a+xa()&256)?v(1):v(0);n.registerA=c;0===n.registerA?q(1):q(0);r(0)}function vb(a){var c=-1*a;x(n.registerA,c);ya(n.registerA,c);n.registerA=n.registerA-a&255;0===n.registerA?q(1):q(0);r(1)}function wb(a){var c=n.registerA-a-xa()&255;0!=((n.registerA^a^c)&16)?t(1):t(0);0<(n.registerA-a-xa()&256)?v(1):v(0);n.registerA=c;0===n.registerA?q(1):q(0);r(1)}
function xb(a){n.registerA&=a;0===n.registerA?q(1):q(0);r(0);t(1);v(0)}function yb(a){n.registerA=(n.registerA^a)&255;0===n.registerA?q(1):q(0);r(0);t(0);v(0)}function zb(a){n.registerA|=a;0===n.registerA?q(1):q(0);r(0);t(0);v(0)}function Ab(a){a*=-1;x(n.registerA,a);ya(n.registerA,a);0===n.registerA+a?q(1):q(0);r(1)}function Bb(a,c){0===(c&1<<a)?q(1):q(0);r(0);t(1);return c}function Cb(a,c,d){return 0<c?d|1<<a:d&~(1<<a)}
function Db(a){a=ua(a);n.programCounter=n.programCounter+a&65535;n.programCounter=n.programCounter+1&65535}
function Eb(a){n.programCounter=n.programCounter+1&65535;n.isHaltBug&&(n.programCounter=n.programCounter-1&65535);switch((a&240)>>4){case 0:return Fb(a);case 1:return Gb(a);case 2:return Hb(a);case 3:return Ib(a);case 4:return Jb(a);case 5:return Kb(a);case 6:return Lb(a);case 7:return Mb(a);case 8:return Nb(a);case 9:return Ob(a);case 10:return Pb(a);case 11:return Qb(a);case 12:return Rb(a);case 13:return Sb(a);case 14:return Tb(a);default:return Ub(a)}}function X(a){Vb(4);return hb(a)}
function Wb(a,c){Vb(4);ib(a,c)}function Xb(a){Vb(8);var c=sb(a);switch(c){case -1:c=B(a)}a+=1;var d=sb(a);switch(d){case -1:a=B(a);break;default:a=d}return h(a,c)}function Yb(a,c){Vb(8);var d=k(c);c&=255;var e=a+1;jb(a,c)&&H(a,c);jb(e,d)&&H(e,d)}function Y(){Vb(4);return B(n.programCounter)}function Zb(){Vb(4);var a=B(n.programCounter+1&65535);return h(a,Y())}
function Fb(a){switch(a){case 0:return 4;case 1:return a=Zb(),n.registerB=k(a),n.registerC=a&255,n.programCounter=n.programCounter+2&65535,4;case 2:return Wb(h(n.registerB,n.registerC),n.registerA),4;case 3:return a=h(n.registerB,n.registerC),a++,n.registerB=k(a),n.registerC=a&255,8;case 4:return x(n.registerB,1),n.registerB=n.registerB+1&255,0===n.registerB?q(1):q(0),r(0),4;case 5:return x(n.registerB,-1),n.registerB=n.registerB-1&255,0===n.registerB?q(1):q(0),r(1),4;case 6:return n.registerB=Y(),
n.programCounter=n.programCounter+1&65535,4;case 7:return 128===(n.registerA&128)?v(1):v(0),a=n.registerA,n.registerA=(a<<1|a>>7)&255,q(0),r(0),t(0),4;case 8:return Yb(Zb(),n.stackPointer),n.programCounter=n.programCounter+2&65535,4;case 9:a=h(n.registerH,n.registerL);var c=h(n.registerB,n.registerC);za(a,c,!1);a=a+c&65535;n.registerH=k(a);n.registerL=a&255;r(0);return 8;case 10:return n.registerA=X(h(n.registerB,n.registerC)),4;case 11:return a=h(n.registerB,n.registerC),a=a-1&65535,n.registerB=
k(a),n.registerC=a&255,8;case 12:return x(n.registerC,1),n.registerC=n.registerC+1&255,0===n.registerC?q(1):q(0),r(0),4;case 13:return x(n.registerC,-1),n.registerC=n.registerC-1&255,0===n.registerC?q(1):q(0),r(1),4;case 14:return n.registerC=Y(),n.programCounter=n.programCounter+1&65535,4;case 15:return 0<(n.registerA&1)?v(1):v(0),a=n.registerA,n.registerA=(a>>1|a<<7)&255,q(0),r(0),t(0),4}return-1}
function Gb(a){switch(a){case 16:if(n.GBCEnabled&&(a=X(n.memoryLocationSpeedSwitch),m(0,a)))return a=l(0,a),m(7,a)?(n.GBCDoubleSpeed=!1,a=l(7,a)):(n.GBCDoubleSpeed=!0,a|=128),Wb(n.memoryLocationSpeedSwitch,a),68;n.isStopped=!0;n.programCounter=n.programCounter+1&65535;return 4;case 17:return a=Zb(),n.registerD=k(a),n.registerE=a&255,n.programCounter=n.programCounter+2&65535,4;case 18:return Wb(h(n.registerD,n.registerE),n.registerA),4;case 19:return a=h(n.registerD,n.registerE),a=a+1&65535,n.registerD=
k(a),n.registerE=a&255,8;case 20:return x(n.registerD,1),n.registerD=n.registerD+1&255,0===n.registerD?q(1):q(0),r(0),4;case 21:return x(n.registerD,-1),n.registerD=n.registerD-1&255,0===n.registerD?q(1):q(0),r(1),4;case 22:return n.registerD=Y(),n.programCounter=n.programCounter+1&65535,4;case 23:return a=!1,128===(n.registerA&128)&&(a=!0),n.registerA=(n.registerA<<1|xa())&255,a?v(1):v(0),q(0),r(0),t(0),4;case 24:return Db(Y()),8;case 25:a=h(n.registerH,n.registerL);var c=h(n.registerD,n.registerE);
za(a,c,!1);a=a+c&65535;n.registerH=k(a);n.registerL=a&255;r(0);return 8;case 26:return a=h(n.registerD,n.registerE),n.registerA=X(a),4;case 27:return a=h(n.registerD,n.registerE),a=a-1&65535,n.registerD=k(a),n.registerE=a&255,8;case 28:return x(n.registerE,1),n.registerE=n.registerE+1&255,0===n.registerE?q(1):q(0),r(0),4;case 29:return x(n.registerE,-1),n.registerE=n.registerE-1&255,0===n.registerE?q(1):q(0),r(1),4;case 30:return n.registerE=Y(),n.programCounter=n.programCounter+1&65535,4;case 31:return a=
!1,1===(n.registerA&1)&&(a=!0),n.registerA=(n.registerA>>1|xa()<<7)&255,a?v(1):v(0),q(0),r(0),t(0),4}return-1}
function Hb(a){switch(a){case 32:return 0===wa()?Db(Y()):n.programCounter=n.programCounter+1&65535,8;case 33:return a=Zb(),n.registerH=k(a),n.registerL=a&255,n.programCounter=n.programCounter+2&65535,4;case 34:return a=h(n.registerH,n.registerL),Wb(a,n.registerA),a=a+1&65535,n.registerH=k(a),n.registerL=a&255,4;case 35:return a=h(n.registerH,n.registerL),a=a+1&65535,n.registerH=k(a),n.registerL=a&255,8;case 36:return x(n.registerH,1),n.registerH=n.registerH+1&255,0===n.registerH?q(1):q(0),r(0),4;
case 37:return x(n.registerH,-1),n.registerH=n.registerH-1&255,0===n.registerH?q(1):q(0),r(1),4;case 38:return n.registerH=Y(),n.programCounter=n.programCounter+1&65535,4;case 39:var c=0;0<(n.registerF>>5&1)&&(c|=6);0<xa()&&(c|=96);0<(n.registerF>>6&1)?a=n.registerA-c&255:(9<(n.registerA&15)&&(c|=6),153<n.registerA&&(c|=96),a=n.registerA+c&255);0===a?q(1):q(0);0!==(c&96)?v(1):v(0);t(0);n.registerA=a;return 4;case 40:return 0<wa()?Db(Y()):n.programCounter=n.programCounter+1&65535,8;case 41:return a=
h(n.registerH,n.registerL),za(a,a,!1),a=2*a&65535,n.registerH=k(a),n.registerL=a&255,r(0),8;case 42:return a=h(n.registerH,n.registerL),n.registerA=X(a),a=a+1&65535,n.registerH=k(a),n.registerL=a&255,4;case 43:return a=h(n.registerH,n.registerL),a=a-1&65535,n.registerH=k(a),n.registerL=a&255,8;case 44:return x(n.registerL,1),n.registerL=n.registerL+1&255,0===n.registerL?q(1):q(0),r(0),4;case 45:return x(n.registerL,-1),n.registerL=n.registerL-1&255,0===n.registerL?q(1):q(0),r(1),4;case 46:return n.registerL=
Y(),n.programCounter=n.programCounter+1&65535,4;case 47:return n.registerA=~n.registerA,r(1),t(1),4}return-1}
function Ib(a){switch(a){case 48:return 0===xa()?Db(Y()):n.programCounter=n.programCounter+1&65535,8;case 49:return n.stackPointer=Zb(),n.programCounter=n.programCounter+2&65535,4;case 50:return a=h(n.registerH,n.registerL),Wb(a,n.registerA),a=a-1&65535,n.registerH=k(a),n.registerL=a&255,4;case 51:return n.stackPointer=n.stackPointer+1&65535,8;case 52:a=h(n.registerH,n.registerL);var c=X(a);x(c,1);c=c+1&255;0===c?q(1):q(0);r(0);Wb(a,c);return 4;case 53:return a=h(n.registerH,n.registerL),c=X(a),x(c,
-1),c=c-1&255,0===c?q(1):q(0),r(1),Wb(a,c),4;case 54:return Wb(h(n.registerH,n.registerL),Y()),n.programCounter=n.programCounter+1&65535,4;case 55:return r(0),t(0),v(1),4;case 56:return 1===xa()?Db(Y()):n.programCounter=n.programCounter+1&65535,8;case 57:return a=h(n.registerH,n.registerL),za(a,n.stackPointer,!1),a=a+n.stackPointer&65535,n.registerH=k(a),n.registerL=a&255,r(0),8;case 58:return a=h(n.registerH,n.registerL),n.registerA=X(a),a=a-1&65535,n.registerH=k(a),n.registerL=a&255,4;case 59:return n.stackPointer=
n.stackPointer-1&65535,8;case 60:return x(n.registerA,1),n.registerA=n.registerA+1&255,0===n.registerA?q(1):q(0),r(0),4;case 61:return x(n.registerA,-1),n.registerA=n.registerA-1&255,0===n.registerA?q(1):q(0),r(1),4;case 62:return n.registerA=Y(),n.programCounter=n.programCounter+1&65535,4;case 63:return r(0),t(0),0<xa()?v(0):v(1),4}return-1}
function Jb(a){switch(a){case 64:return 4;case 65:return n.registerB=n.registerC,4;case 66:return n.registerB=n.registerD,4;case 67:return n.registerB=n.registerE,4;case 68:return n.registerB=n.registerH,4;case 69:return n.registerB=n.registerL,4;case 70:return n.registerB=X(h(n.registerH,n.registerL)),4;case 71:return n.registerB=n.registerA,4;case 72:return n.registerC=n.registerB,4;case 73:return 4;case 74:return n.registerC=n.registerD,4;case 75:return n.registerC=n.registerE,4;case 76:return n.registerC=
n.registerH,4;case 77:return n.registerC=n.registerL,4;case 78:return n.registerC=X(h(n.registerH,n.registerL)),4;case 79:return n.registerC=n.registerA,4}return-1}
function Kb(a){switch(a){case 80:return n.registerD=n.registerB,4;case 81:return n.registerD=n.registerC,4;case 82:return 4;case 83:return n.registerD=n.registerE,4;case 84:return n.registerD=n.registerH,4;case 85:return n.registerD=n.registerL,4;case 86:return n.registerD=X(h(n.registerH,n.registerL)),4;case 87:return n.registerD=n.registerA,4;case 88:return n.registerE=n.registerB,4;case 89:return n.registerE=n.registerC,4;case 90:return n.registerE=n.registerD,4;case 91:return 4;case 92:return n.registerE=
n.registerH,4;case 93:return n.registerE=n.registerL,4;case 94:return n.registerE=X(h(n.registerH,n.registerL)),4;case 95:return n.registerE=n.registerA,4}return-1}
function Lb(a){switch(a){case 96:return n.registerH=n.registerB,4;case 97:return n.registerH=n.registerC,4;case 98:return n.registerH=n.registerD,4;case 99:return n.registerH=n.registerE,4;case 100:return n.registerH=n.registerH,4;case 101:return n.registerH=n.registerL,4;case 102:return n.registerH=X(h(n.registerH,n.registerL)),4;case 103:return n.registerH=n.registerA,4;case 104:return n.registerL=n.registerB,4;case 105:return n.registerL=n.registerC,4;case 106:return n.registerL=n.registerD,4;
case 107:return n.registerL=n.registerE,4;case 108:return n.registerL=n.registerH,4;case 109:return n.registerL=n.registerL,4;case 110:return n.registerL=X(h(n.registerH,n.registerL)),4;case 111:return n.registerL=n.registerA,4}return-1}
function Mb(a){switch(a){case 112:return Wb(h(n.registerH,n.registerL),n.registerB),4;case 113:return Wb(h(n.registerH,n.registerL),n.registerC),4;case 114:return Wb(h(n.registerH,n.registerL),n.registerD),4;case 115:return Wb(h(n.registerH,n.registerL),n.registerE),4;case 116:return Wb(h(n.registerH,n.registerL),n.registerH),4;case 117:return Wb(h(n.registerH,n.registerL),n.registerL),4;case 118:return V.isHblankHdmaActive||n.enableHalt(),4;case 119:return Wb(h(n.registerH,n.registerL),n.registerA),
4;case 120:return n.registerA=n.registerB,4;case 121:return n.registerA=n.registerC,4;case 122:return n.registerA=n.registerD,4;case 123:return n.registerA=n.registerE,4;case 124:return n.registerA=n.registerH,4;case 125:return n.registerA=n.registerL,4;case 126:return n.registerA=X(h(n.registerH,n.registerL)),4;case 127:return 4}return-1}
function Nb(a){switch(a){case 128:return tb(n.registerB),4;case 129:return tb(n.registerC),4;case 130:return tb(n.registerD),4;case 131:return tb(n.registerE),4;case 132:return tb(n.registerH),4;case 133:return tb(n.registerL),4;case 134:return a=X(h(n.registerH,n.registerL)),tb(a),4;case 135:return tb(n.registerA),4;case 136:return ub(n.registerB),4;case 137:return ub(n.registerC),4;case 138:return ub(n.registerD),4;case 139:return ub(n.registerE),4;case 140:return ub(n.registerH),4;case 141:return ub(n.registerL),
4;case 142:return a=X(h(n.registerH,n.registerL)),ub(a),4;case 143:return ub(n.registerA),4}return-1}
function Ob(a){switch(a){case 144:return vb(n.registerB),4;case 145:return vb(n.registerC),4;case 146:return vb(n.registerD),4;case 147:return vb(n.registerE),4;case 148:return vb(n.registerH),4;case 149:return vb(n.registerL),4;case 150:return a=X(h(n.registerH,n.registerL)),vb(a),4;case 151:return vb(n.registerA),4;case 152:return wb(n.registerB),4;case 153:return wb(n.registerC),4;case 154:return wb(n.registerD),4;case 155:return wb(n.registerE),4;case 156:return wb(n.registerH),4;case 157:return wb(n.registerL),
4;case 158:return a=X(h(n.registerH,n.registerL)),wb(a),4;case 159:return wb(n.registerA),4}return-1}
function Pb(a){switch(a){case 160:return xb(n.registerB),4;case 161:return xb(n.registerC),4;case 162:return xb(n.registerD),4;case 163:return xb(n.registerE),4;case 164:return xb(n.registerH),4;case 165:return xb(n.registerL),4;case 166:return a=X(h(n.registerH,n.registerL)),xb(a),4;case 167:return xb(n.registerA),4;case 168:return yb(n.registerB),4;case 169:return yb(n.registerC),4;case 170:return yb(n.registerD),4;case 171:return yb(n.registerE),4;case 172:return yb(n.registerH),4;case 173:return yb(n.registerL),
4;case 174:return a=X(h(n.registerH,n.registerL)),yb(a),4;case 175:return yb(n.registerA),4}return-1}
function Qb(a){switch(a){case 176:return zb(n.registerB),4;case 177:return zb(n.registerC),4;case 178:return zb(n.registerD),4;case 179:return zb(n.registerE),4;case 180:return zb(n.registerH),4;case 181:return zb(n.registerL),4;case 182:return a=X(h(n.registerH,n.registerL)),zb(a),4;case 183:return zb(n.registerA),4;case 184:return Ab(n.registerB),4;case 185:return Ab(n.registerC),4;case 186:return Ab(n.registerD),4;case 187:return Ab(n.registerE),4;case 188:return Ab(n.registerH),4;case 189:return Ab(n.registerL),
4;case 190:return a=X(h(n.registerH,n.registerL)),Ab(a),4;case 191:return Ab(n.registerA),4}return-1}
function Rb(a){switch(a){case 192:return 0===wa()?(n.programCounter=Xb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,12):8;case 193:return a=Xb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,n.registerB=k(a),n.registerC=a&255,4;case 194:if(0===wa())return n.programCounter=Zb(),8;n.programCounter=n.programCounter+2&65535;return 12;case 195:return n.programCounter=Zb(),8;case 196:if(0===wa())return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter+2&65535),n.programCounter=
Zb(),8;n.programCounter=n.programCounter+2&65535;return 12;case 197:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,h(n.registerB,n.registerC)),8;case 198:return tb(Y()),n.programCounter=n.programCounter+1&65535,4;case 199:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter),n.programCounter=0,8;case 200:return 1===wa()?(n.programCounter=Xb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,12):8;case 201:return n.programCounter=Xb(n.stackPointer),n.stackPointer=
n.stackPointer+2&65535,8;case 202:if(1===wa())return n.programCounter=Zb(),8;n.programCounter=n.programCounter+2&65535;return 12;case 203:var c=Y();a=-1;var d=!1,e=0,g=0,p=c%8;switch(p){case 0:e=n.registerB;break;case 1:e=n.registerC;break;case 2:e=n.registerD;break;case 3:e=n.registerE;break;case 4:e=n.registerH;break;case 5:e=n.registerL;break;case 6:e=X(h(n.registerH,n.registerL));break;case 7:e=n.registerA}var E=(c&240)>>4;switch(E){case 0:7>=c?(c=e,128===(c&128)?v(1):v(0),c=(c<<1|c>>7)&255,0===
c?q(1):q(0),r(0),t(0),g=c,d=!0):15>=c&&(c=e,0<(c&1)?v(1):v(0),c=(c>>1|c<<7)&255,0===c?q(1):q(0),r(0),t(0),g=c,d=!0);break;case 1:23>=c?(c=e,d=!1,128===(c&128)&&(d=!0),c=(c<<1|xa())&255,d?v(1):v(0),0===c?q(1):q(0),r(0),t(0),g=c,d=!0):31>=c&&(c=e,d=!1,1===(c&1)&&(d=!0),c=(c>>1|xa()<<7)&255,d?v(1):v(0),0===c?q(1):q(0),r(0),t(0),g=c,d=!0);break;case 2:39>=c?(c=e,d=!1,128===(c&128)&&(d=!0),c=c<<1&255,d?v(1):v(0),0===c?q(1):q(0),r(0),t(0),g=c,d=!0):47>=c&&(c=e,d=!1,128===(c&128)&&(d=!0),e=!1,1===(c&1)&&
(e=!0),c=c>>1&255,d&&(c|=128),0===c?q(1):q(0),r(0),t(0),e?v(1):v(0),g=c,d=!0);break;case 3:55>=c?(c=e,c=((c&15)<<4|(c&240)>>4)&255,0===c?q(1):q(0),r(0),t(0),v(0),g=c,d=!0):63>=c&&(c=e,d=!1,1===(c&1)&&(d=!0),c=c>>1&255,0===c?q(1):q(0),r(0),t(0),d?v(1):v(0),g=c,d=!0);break;case 4:71>=c?(g=Bb(0,e),d=!0):79>=c&&(g=Bb(1,e),d=!0);break;case 5:87>=c?(g=Bb(2,e),d=!0):95>=c&&(g=Bb(3,e),d=!0);break;case 6:103>=c?(g=Bb(4,e),d=!0):111>=c&&(g=Bb(5,e),d=!0);break;case 7:119>=c?(g=Bb(6,e),d=!0):127>=c&&(g=Bb(7,
e),d=!0);break;case 8:135>=c?(g=Cb(0,0,e),d=!0):143>=c&&(g=Cb(1,0,e),d=!0);break;case 9:151>=c?(g=Cb(2,0,e),d=!0):159>=c&&(g=Cb(3,0,e),d=!0);break;case 10:167>=c?(g=Cb(4,0,e),d=!0):175>=c&&(g=Cb(5,0,e),d=!0);break;case 11:183>=c?(g=Cb(6,0,e),d=!0):191>=c&&(g=Cb(7,0,e),d=!0);break;case 12:199>=c?(g=Cb(0,1,e),d=!0):207>=c&&(g=Cb(1,1,e),d=!0);break;case 13:215>=c?(g=Cb(2,1,e),d=!0):223>=c&&(g=Cb(3,1,e),d=!0);break;case 14:231>=c?(g=Cb(4,1,e),d=!0):239>=c&&(g=Cb(5,1,e),d=!0);break;case 15:247>=c?(g=Cb(6,
1,e),d=!0):255>=c&&(g=Cb(7,1,e),d=!0)}switch(p){case 0:n.registerB=g;break;case 1:n.registerC=g;break;case 2:n.registerD=g;break;case 3:n.registerE=g;break;case 4:n.registerH=g;break;case 5:n.registerL=g;break;case 6:(4>E||7<E)&&Wb(h(n.registerH,n.registerL),g);break;case 7:n.registerA=g}d&&(a=4);n.programCounter=n.programCounter+1&65535;return a;case 204:if(1===wa())return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter+2),n.programCounter=Zb(),8;n.programCounter=n.programCounter+
2&65535;return 12;case 205:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter+2&65535),n.programCounter=Zb(),8;case 206:return ub(Y()),n.programCounter=n.programCounter+1&65535,4;case 207:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter),n.programCounter=8}return-1}
function Sb(a){switch(a){case 208:return 0===xa()?(n.programCounter=Xb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,12):8;case 209:return a=Xb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,n.registerD=k(a),n.registerE=a&255,4;case 210:if(0===xa())return n.programCounter=Zb(),8;n.programCounter=n.programCounter+2&65535;return 12;case 212:if(0===xa())return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter+2),n.programCounter=Zb(),8;n.programCounter=n.programCounter+
2&65535;return 12;case 213:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,h(n.registerD,n.registerE)),8;case 214:return vb(Y()),n.programCounter=n.programCounter+1&65535,4;case 215:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter),n.programCounter=16,8;case 216:return 1===xa()?(n.programCounter=Xb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,12):8;case 217:return n.programCounter=Xb(n.stackPointer),Xa(!0),n.stackPointer=n.stackPointer+2&65535,
8;case 218:if(1===xa())return n.programCounter=Zb(),8;n.programCounter=n.programCounter+2&65535;return 12;case 220:if(1===xa())return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter+2&65535),n.programCounter=Zb(),8;n.programCounter=n.programCounter+2&65535;return 12;case 222:return wb(Y()),n.programCounter=n.programCounter+1&65535,4;case 223:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter),n.programCounter=24,8}return-1}
function Tb(a){switch(a){case 224:return a=Y(),Wb(65280+a,n.registerA),n.programCounter=n.programCounter+1&65535,4;case 225:return a=Xb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,n.registerH=k(a),n.registerL=a&255,4;case 226:return Wb(65280+n.registerC,n.registerA),4;case 229:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,h(n.registerH,n.registerL)),8;case 230:return xb(Y()),n.programCounter=n.programCounter+1&65535,4;case 231:return n.stackPointer=n.stackPointer-2&65535,
Yb(n.stackPointer,n.programCounter),n.programCounter=32,8;case 232:return a=ua(Y()),za(n.stackPointer,a,!0),n.stackPointer=n.stackPointer+a&65535,q(0),r(0),n.programCounter=n.programCounter+1&65535,12;case 233:return n.programCounter=h(n.registerH,n.registerL),4;case 234:return Wb(Zb(),n.registerA),n.programCounter=n.programCounter+2&65535,4;case 238:return yb(Y()),n.programCounter=n.programCounter+1&65535,4;case 239:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter),
n.programCounter=40,8}return-1}
function Ub(a){switch(a){case 240:return a=Y(),n.registerA=X(65280+a)&255,n.programCounter=n.programCounter+1&65535,4;case 241:return a=Xb(n.stackPointer),n.stackPointer=n.stackPointer+2&65535,n.registerA=k(a),n.registerF=a&255,4;case 242:return n.registerA=X(65280+n.registerC)&255,4;case 243:return Xa(!1),4;case 245:return n.stackPointer=n.stackPointer-2&65535,Yb(n.stackPointer,h(n.registerA,n.registerF)),8;case 246:return zb(Y()),n.programCounter=n.programCounter+1&65535,4;case 247:return n.stackPointer=
n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter),n.programCounter=48,8;case 248:return a=ua(Y()),q(0),r(0),za(n.stackPointer,a,!0),a=n.stackPointer+a&65535,n.registerH=k(a),n.registerL=a&255,n.programCounter=n.programCounter+1&65535,8;case 249:return n.stackPointer=h(n.registerH,n.registerL),8;case 250:return n.registerA=X(Zb()),n.programCounter=n.programCounter+2&65535,4;case 251:return Xa(!0),4;case 254:return Ab(Y()),n.programCounter=n.programCounter+1&65535,4;case 255:return n.stackPointer=
n.stackPointer-2&65535,Yb(n.stackPointer,n.programCounter),n.programCounter=56,8}return-1}var $b=function(){function a(){}a.cyclesPerCycleSet=2E9;a.cycleSets=0;a.cycles=0;return a}();
function Vb(a){0<V.DMACycles&&(a+=V.DMACycles,V.DMACycles=0);n.currentCycles+=a;if(!n.isStopped){if(f.graphicsBatchProcessing){if(C.currentCycles+=a,!(C.currentCycles<C.batchProcessCycles()))for(;C.currentCycles>=C.batchProcessCycles();)qb(C.batchProcessCycles()),C.currentCycles-=C.batchProcessCycles()}else qb(a);f.audioBatchProcessing?P.currentCycles+=a:Ra(a);var c=a;if(S.transferStartFlag)for(var d=0;d<c;){var e=S.currentCycles;d+=4;S.currentCycles+=4;65535<S.currentCycles&&(S.currentCycles-=65536);
var g=S.currentCycles;var p=S.isClockSpeedFast?2:7;m(p,e)&&!m(p,g)&&(e=B(S.memoryLocationSerialTransferData),e=(e<<1)+1,e&=255,H(S.memoryLocationSerialTransferData,e),S.numberOfBitsTransferred+=1,8===S.numberOfBitsTransferred&&(S.numberOfBitsTransferred=0,Q.isSerialInterruptRequested=!0,Ya(Q.bitPositionSerialInterrupt),e=B(S.memoryLocationSerialTransferControl),H(S.memoryLocationSerialTransferControl,l(7,e)),S.transferStartFlag=!1))}}f.timersBatchProcessing?(R.currentCycles+=a,cb(R.currentCycles),
R.currentCycles=0):cb(a);$b.cycles+=a;$b.cycles>=$b.cyclesPerCycleSet&&($b.cycleSets+=1,$b.cycles-=$b.cyclesPerCycleSet)}var Z=function(){function a(){}a.stepsPerStepSet=2E9;a.stepSets=0;a.steps=0;a.RESPONSE_CONDITION_ERROR=-1;a.RESPONSE_CONDITION_FRAME=0;a.RESPONSE_CONDITION_AUDIO=1;a.RESPONSE_CONDITION_BREAKPOINT=2;return a}();function ac(){return bc(!0,-1)}
function bc(a,c){void 0===c&&(c=-1);a=1024;0<c?a=c:0>c&&(a=-1);for(var d=!1,e=!1,g=!1;!(d||e||g||lb.reachedBreakpoint);)c=cc(),0>c?d=!0:n.currentCycles>=n.MAX_CYCLES_PER_FRAME()?e=!0:-1<a&&Ua()>=a&&(g=!0);if(e)return n.currentCycles-=n.MAX_CYCLES_PER_FRAME(),Z.RESPONSE_CONDITION_FRAME;if(g)return Z.RESPONSE_CONDITION_AUDIO;if(lb.reachedBreakpoint)return lb.reachedBreakpoint=!1,Z.RESPONSE_CONDITION_BREAKPOINT;n.programCounter=n.programCounter-1&65535;return-1}
function cc(){dc=!0;if(n.isHaltBug){var a=B(n.programCounter);a=Eb(a);Vb(a);n.exitHaltAndStop()}Q.masterInterruptSwitchDelay&&(Q.masterInterruptSwitch=!0,Q.masterInterruptSwitchDelay=!1);if(0<(Q.interruptsEnabledValue&Q.interruptsRequestedValue&31)){a=!1;Q.masterInterruptSwitch&&!n.isHaltNoJump&&(Q.isVBlankInterruptEnabled&&Q.isVBlankInterruptRequested?(Wa(Q.bitPositionVBlankInterrupt),a=!0):Q.isLcdInterruptEnabled&&Q.isLcdInterruptRequested?(Wa(Q.bitPositionLcdInterrupt),a=!0):Q.isTimerInterruptEnabled&&
Q.isTimerInterruptRequested?(Wa(Q.bitPositionTimerInterrupt),a=!0):Q.isSerialInterruptEnabled&&Q.isSerialInterruptRequested?(Wa(Q.bitPositionSerialInterrupt),a=!0):Q.isJoypadInterruptEnabled&&Q.isJoypadInterruptRequested&&(Wa(Q.bitPositionJoypadInterrupt),a=!0));var c=0;a&&(c=20,n.isHalted()&&(n.exitHaltAndStop(),c+=4));n.isHalted()&&n.exitHaltAndStop();a=c}else a=0;0<a&&Vb(a);a=4;n.isHalted()||n.isStopped||(a=B(n.programCounter),a=Eb(a));n.registerF&=240;if(0>=a)return a;Vb(a);Z.steps+=1;Z.steps>=
Z.stepsPerStepSet&&(Z.stepSets+=1,Z.steps-=Z.stepsPerStepSet);n.programCounter===lb.programCounter&&(lb.reachedBreakpoint=!0);return a}aa.size()<ta&&aa.grow(ta-aa.size());
var dc=!1,ec=Object.freeze({memory:aa,config:function(a,c,d,e,g,p,E,u,z,w){f.enableBootRom=0<a?!0:!1;f.useGbcWhenAvailable=0<c?!0:!1;f.audioBatchProcessing=0<d?!0:!1;f.graphicsBatchProcessing=0<e?!0:!1;f.timersBatchProcessing=0<g?!0:!1;f.graphicsDisableScanlineRendering=0<p?!0:!1;f.audioAccumulateSamples=0<E?!0:!1;f.tileRendering=0<u?!0:!1;f.tileCaching=0<z?!0:!1;f.enableAudioDebugging=0<w?!0:!1;a=B(323);n.GBCEnabled=192===a||f.useGbcWhenAvailable&&128===a?!0:!1;n.GBCDoubleSpeed=!1;n.registerA=0;
n.registerB=0;n.registerC=0;n.registerD=0;n.registerE=0;n.registerH=0;n.registerL=0;n.registerF=0;n.stackPointer=0;n.programCounter=0;n.currentCycles=0;n.isHaltNormal=!1;n.isHaltNoJump=!1;n.isHaltBug=!1;n.isStopped=!1;n.GBCEnabled?(n.registerA=17,n.registerF=128,n.registerB=0,n.registerC=0,n.registerD=255,n.registerE=86,n.registerH=0,n.registerL=13):(n.registerA=1,n.registerF=176,n.registerB=0,n.registerC=19,n.registerD=0,n.registerE=216,n.registerH=1,n.registerL=77);n.programCounter=256;n.stackPointer=
65534;V.isRamBankingEnabled=!1;V.isMBC1RomModeEnabled=!0;a=B(327);V.isRomOnly=!1;V.isMBC1=!1;V.isMBC2=!1;V.isMBC3=!1;V.isMBC5=!1;0===a?V.isRomOnly=!0:1<=a&&3>=a?V.isMBC1=!0:5<=a&&6>=a?V.isMBC2=!0:15<=a&&19>=a?V.isMBC3=!0:25<=a&&30>=a&&(V.isMBC5=!0);V.currentRomBank=1;V.currentRamBank=0;H(65361,255);H(65362,255);H(65363,255);H(65364,255);H(65365,255);C.currentCycles=0;C.scanlineCycleCounter=0;C.scanlineRegister=0;C.scrollX=0;C.scrollY=0;C.windowX=0;C.windowY=0;n.GBCEnabled?(C.scanlineRegister=144,
H(65344,145),H(65345,129),H(65348,144),H(65351,252)):(C.scanlineRegister=144,H(65344,145),H(65345,133),H(65350,255),H(65351,252),H(65352,255),H(65353,255));H(65359,0);H(65392,1);n.GBCEnabled?(H(65384,192),H(65385,255),H(65386,193),H(65387,13)):(H(65384,255),H(65385,255),H(65386,255),H(65387,255));P.currentCycles=0;P.NR50LeftMixerVolume=0;P.NR50RightMixerVolume=0;P.NR51IsChannel1EnabledOnLeftOutput=!0;P.NR51IsChannel2EnabledOnLeftOutput=!0;P.NR51IsChannel3EnabledOnLeftOutput=!0;P.NR51IsChannel4EnabledOnLeftOutput=
!0;P.NR51IsChannel1EnabledOnRightOutput=!0;P.NR51IsChannel2EnabledOnRightOutput=!0;P.NR51IsChannel3EnabledOnRightOutput=!0;P.NR51IsChannel4EnabledOnRightOutput=!0;P.NR52IsSoundEnabled=!0;P.frameSequenceCycleCounter=0;P.downSampleCycleCounter=0;P.frameSequencer=0;P.audioQueueIndex=0;I.initialize();J.initialize();K.initialize();N.initialize();H(P.memoryLocationNR50,119);H(P.memoryLocationNR51,243);H(P.memoryLocationNR52,241);O.channel1Sample=15;O.channel2Sample=15;O.channel3Sample=15;O.channel4Sample=
15;O.channel1DacEnabled=!1;O.channel2DacEnabled=!1;O.channel3DacEnabled=!1;O.channel4DacEnabled=!1;O.leftChannelSampleUnsignedByte=127;O.rightChannelSampleUnsignedByte=127;O.mixerVolumeChanged=!0;O.mixerEnabledChanged=!0;O.needToRemixSamples=!1;Q.updateInterruptEnabled(0);H(Q.memoryLocationInterruptEnabled,Q.interruptsEnabledValue);Q.updateInterruptRequested(225);H(Q.memoryLocationInterruptRequest,Q.interruptsRequestedValue);R.currentCycles=0;R.dividerRegister=0;R.timerCounter=0;R.timerModulo=0;R.timerEnabled=
!1;R.timerInputClock=0;R.timerCounterOverflowDelay=!1;R.timerCounterWasReset=!1;n.GBCEnabled?(H(65284,30),R.dividerRegister=7840):(H(65284,171),R.dividerRegister=43980);H(65287,248);R.timerInputClock=248;S.currentCycles=0;S.numberOfBitsTransferred=0;n.GBCEnabled?(H(65282,124),S.updateTransferControl(124)):(H(65282,126),S.updateTransferControl(126));n.GBCEnabled?(H(65392,248),H(65359,254),H(65357,126),H(65280,207),H(65295,225),H(65388,254),H(65397,143)):(H(65392,255),H(65359,255),H(65357,255),H(65280,
207),H(65295,225));dc=!1;$b.cyclesPerCycleSet=2E9;$b.cycleSets=0;$b.cycles=0;Z.stepsPerStepSet=2E9;Z.stepSets=0;Z.steps=0},hasCoreStarted:function(){return dc?1:0},saveState:function(){n.saveState();C.saveState();Q.saveState();T.saveState();V.saveState();R.saveState();P.saveState();I.saveState();J.saveState();K.saveState();N.saveState();dc=!1},loadState:function(){n.loadState();C.loadState();Q.loadState();T.loadState();V.loadState();R.loadState();P.loadState();I.loadState();J.loadState();K.loadState();
N.loadState();dc=!1;$b.cyclesPerCycleSet=2E9;$b.cycleSets=0;$b.cycles=0;Z.stepsPerStepSet=2E9;Z.stepSets=0;Z.steps=0},isGBC:function(){return n.GBCEnabled?1:0},getStepsPerStepSet:function(){return Z.stepsPerStepSet},getStepSets:function(){return Z.stepSets},getSteps:function(){return Z.steps},executeMultipleFrames:function(a){for(var c=0,d=0;d<a&&0<=c;)c=ac(),d+=1;return 0>c?c:0},executeFrame:ac,executeFrameAndCheckAudio:function(a){void 0===a&&(a=0);return bc(!0,a)},executeUntilCondition:bc,executeStep:cc,
getCyclesPerCycleSet:function(){return $b.cyclesPerCycleSet},getCycleSets:function(){return $b.cycleSets},getCycles:function(){return $b.cycles},setJoypadState:function(a,c,d,e,g,p,E,u){0<a?db(0):fb(0,!1);0<c?db(1):fb(1,!1);0<d?db(2):fb(2,!1);0<e?db(3):fb(3,!1);0<g?db(4):fb(4,!1);0<p?db(5):fb(5,!1);0<E?db(6):fb(6,!1);0<u?db(7):fb(7,!1)},getNumberOfSamplesInAudioBuffer:Ua,clearAudioBuffer:Pa,WASMBOY_MEMORY_LOCATION:0,WASMBOY_MEMORY_SIZE:sa,WASMBOY_WASM_PAGES:ta,ASSEMBLYSCRIPT_MEMORY_LOCATION:0,ASSEMBLYSCRIPT_MEMORY_SIZE:1024,
WASMBOY_STATE_LOCATION:1024,WASMBOY_STATE_SIZE:1024,GAMEBOY_INTERNAL_MEMORY_LOCATION:2048,GAMEBOY_INTERNAL_MEMORY_SIZE:65536,VIDEO_RAM_LOCATION:2048,VIDEO_RAM_SIZE:16384,WORK_RAM_LOCATION:18432,WORK_RAM_SIZE:32768,OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION:51200,OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE:16384,GRAPHICS_OUTPUT_LOCATION:67584,GRAPHICS_OUTPUT_SIZE:ha,GBC_PALETTE_LOCATION:67584,GBC_PALETTE_SIZE:128,BG_PRIORITY_MAP_LOCATION:67712,BG_PRIORITY_MAP_SIZE:23552,FRAME_LOCATION:ba,FRAME_SIZE:93184,BACKGROUND_MAP_LOCATION:da,
BACKGROUND_MAP_SIZE:196608,TILE_DATA_LOCATION:ea,TILE_DATA_SIZE:147456,OAM_TILES_LOCATION:fa,OAM_TILES_SIZE:15360,AUDIO_BUFFER_LOCATION:oa,AUDIO_BUFFER_SIZE:131072,CHANNEL_1_BUFFER_LOCATION:ia,CHANNEL_1_BUFFER_SIZE:131072,CHANNEL_2_BUFFER_LOCATION:ja,CHANNEL_2_BUFFER_SIZE:131072,CHANNEL_3_BUFFER_LOCATION:ka,CHANNEL_3_BUFFER_SIZE:131072,CHANNEL_4_BUFFER_LOCATION:la,CHANNEL_4_BUFFER_SIZE:131072,CARTRIDGE_RAM_LOCATION:pa,CARTRIDGE_RAM_SIZE:131072,CARTRIDGE_ROM_LOCATION:qa,CARTRIDGE_ROM_SIZE:8258560,
DEBUG_GAMEBOY_MEMORY_LOCATION:ra,DEBUG_GAMEBOY_MEMORY_SIZE:65535,getWasmBoyOffsetFromGameBoyOffset:kb,setProgramCounterBreakpoint:function(a){lb.programCounter=a},resetProgramCounterBreakpoint:function(){lb.programCounter=-1},setReadGbMemoryBreakpoint:function(a){lb.readGbMemory=a},resetReadGbMemoryBreakpoint:function(){lb.readGbMemory=-1},setWriteGbMemoryBreakpoint:function(a){lb.writeGbMemory=a},resetWriteGbMemoryBreakpoint:function(){lb.writeGbMemory=-1},getRegisterA:function(){return n.registerA},
getRegisterB:function(){return n.registerB},getRegisterC:function(){return n.registerC},getRegisterD:function(){return n.registerD},getRegisterE:function(){return n.registerE},getRegisterH:function(){return n.registerH},getRegisterL:function(){return n.registerL},getRegisterF:function(){return n.registerF},getProgramCounter:function(){return n.programCounter},getStackPointer:function(){return n.stackPointer},getOpcodeAtProgramCounter:function(){return B(n.programCounter)},getLY:function(){return C.scanlineRegister},
drawBackgroundMapToWasmMemory:function(a){var c=C.memoryLocationTileDataSelectZeroStart;W.bgWindowTileDataSelect&&(c=C.memoryLocationTileDataSelectOneStart);var d=C.memoryLocationTileMapSelectZeroStart;W.bgTileMapDisplaySelect&&(d=C.memoryLocationTileMapSelectOneStart);for(var e=0;256>e;e++)for(var g=0;256>g;g++){var p=e,E=g,u=d+32*(p>>3)+(E>>3),z=Ja(u,0);z=Ia(c,z);var w=p%8;p=E%8;p=7-p;E=0;n.GBCEnabled&&0<a&&(E=Ja(u,1));m(6,E)&&(w=7-w);var F=0;m(3,E)&&(F=1);u=Ja(z+2*w,F);z=Ja(z+2*w+1,F);w=0;m(p,
z)&&(w+=1,w<<=1);m(p,u)&&(w+=1);z=3*(256*e+g);if(n.GBCEnabled&&0<a)E=Ca(E&7,w,!1),p=Ea(0,E),u=Ea(1,E),w=Ea(2,E),E=da+z,b[E]=p,b[E+1]=u,b[E+2]=w;else for(p=Ba(w,C.memoryLocationBackgroundPalette),u=0;3>u;u++)E=da+z+u,b[E]=p}},drawTileDataToWasmMemory:function(){for(var a=0;23>a;a++)for(var c=0;31>c;c++){var d=0;15<c&&(d=1);var e=a;15<a&&(e-=15);e<<=4;e=15<c?e+(c-15):e+c;var g=C.memoryLocationTileDataSelectOneStart;15<a&&(g=C.memoryLocationTileDataSelectZeroStart);for(var p=C.memoryLocationBackgroundPalette,
E=-1,u=-1,z=0;8>z;z++)for(var w=0;5>w;w++){var F=4*(8*w+z),y=B(C.memoryLocationSpriteAttributesTable+F+2);e===y&&(F=B(C.memoryLocationSpriteAttributesTable+F+3),y=0,n.GBCEnabled&&m(3,F)&&(y=1),y===d&&(u=F,z=8,w=5,p=C.memoryLocationSpritePaletteOne,m(4,u)&&(p=C.memoryLocationSpritePaletteTwo)))}if(n.GBCEnabled&&0>u){z=C.memoryLocationTileMapSelectZeroStart;W.bgTileMapDisplaySelect&&(z=C.memoryLocationTileMapSelectOneStart);w=-1;for(F=0;32>F;F++)for(y=0;32>y;y++){var A=z+32*y+F,U=Ja(A,0);e===U&&(w=
A,y=F=32)}0<=w&&(E=Ja(w,1))}for(z=0;8>z;z++)Ha(e,g,d,0,7,z,8*c,8*a+z,248,ea,!1,p,E,u)}},drawOamToWasmMemory:function(){for(var a=0;8>a;a++)for(var c=0;5>c;c++){var d=4*(8*c+a);B(C.memoryLocationSpriteAttributesTable+d);B(C.memoryLocationSpriteAttributesTable+d+1);var e=B(C.memoryLocationSpriteAttributesTable+d+2),g=1;W.tallSpriteSize&&(1===e%2&&--e,g+=1);d=B(C.memoryLocationSpriteAttributesTable+d+3);var p=0;n.GBCEnabled&&m(3,d)&&(p=1);var E=C.memoryLocationSpritePaletteOne;m(4,d)&&(E=C.memoryLocationSpritePaletteTwo);
for(var u=0;u<g;u++)for(var z=0;8>z;z++)Ha(e+u,C.memoryLocationTileDataSelectOneStart,p,0,7,z,8*a,16*c+z+8*u,64,fa,!1,E,-1,d)}},getDIV:function(){return R.dividerRegister},getTIMA:function(){return R.timerCounter},getTMA:function(){return R.timerModulo},getTAC:function(){var a=R.timerInputClock;R.timerEnabled&&(a|=4);return a},updateDebugGBMemory:function(){for(var a=0;65535>a;a++){var c=hb(a);b[ra+a]=c}lb.reachedBreakpoint=!1},update:ac,emulationStep:cc,getAudioQueueIndex:Ua,resetAudioQueue:Pa,wasmMemorySize:sa,
wasmBoyInternalStateLocation:1024,wasmBoyInternalStateSize:1024,gameBoyInternalMemoryLocation:2048,gameBoyInternalMemorySize:65536,videoOutputLocation:67584,frameInProgressVideoOutputLocation:ba,gameboyColorPaletteLocation:67584,gameboyColorPaletteSize:128,backgroundMapLocation:da,tileDataMap:ea,soundOutputLocation:oa,gameBytesLocation:qa,gameRamBanksLocation:pa});export default async()=>({instance:{exports:ec},byteMemory:aa.wasmByteMemory,type:"TypeScript"});
